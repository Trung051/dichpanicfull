<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ªãch panicfull vip pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }
        
        .ai-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin: 0 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .upload-section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .upload-section:hover {
            transform: translateY(-5px);
        }
        
        .upload-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .upload-zone:hover {
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
            border-color: #38a169;
            transform: scale(1.02);
        }
        
        .image-upload-zone {
            border: 3px dashed #f093fb;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #fff0fd, #fdf2f8);
        }
        
        .image-upload-zone:hover {
            background: linear-gradient(135deg, #fdf2f8, #fef7ff);
            border-color: #e879f9;
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(240, 147, 251, 0.3);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            transition: all 0.3s ease;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
        }
        
        .ai-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 15px 30px rgba(240, 147, 251, 0.4);
        }
        
        .search-box {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            font-size: 1.1em;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }
        
        .category-btn {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            color: #4a5568;
            border: 2px solid #e2e8f0;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .category-btn:hover, .category-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .error-database {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .error-item {
            padding: 15px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .error-item:hover {
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
            transform: translateX(10px);
        }
        
        .results-container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            display: none;
            animation: slideUp 0.5s ease;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .panic-analysis {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border-left: 5px solid #e53e3e;
            padding: 30px;
            margin: 25px 0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .panic-analysis::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #e53e3e, #fc8181, #feb2b2);
        }
        
        .error-category {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .severity-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 15px;
        }
        
        .severity-critical { background: #e53e3e; }
        .severity-high { background: #dd6b20; }
        .severity-medium { background: #d69e2e; }
        .severity-low { background: #38a169; }
        
        .ai-processing {
            display: none;
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .ai-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .confidence-meter {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .confidence-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #38a169, #48bb78);
            border-radius: 4px;
            transition: width 1s ease;
        }
        
        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .floating-action:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
        }
        
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>D·ªãch Pacnicfull</h1>
        </div>
        
        <div class="main-grid">
            <!-- Upload File Text -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üìÑ File Text/Log</h3>
                <div class="upload-zone" id="textUploadZone">
                    <input type="file" id="textFileInput" style="display: none" accept=".txt,.crash,.ips,.panic-full,.log" multiple>
                    <div style="font-size: 3em; margin-bottom: 15px;">üì±</div>
                    <h4>K√©o Th·∫£ File Log</h4>
                    <p style="margin: 10px 0; color: #666;">H·ªó tr·ª£: txt, crash, ips, panic-full, log</p>
                    <button class="btn" onclick="document.getElementById('textFileInput').click()">Ch·ªçn File</button>
                </div>
                
                <div style="margin-top: 25px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="text-align: center; padding: 15px; background: #f0fff4; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #38a169;" id="textFiles">0</div>
                            <div style="font-size: 0.9em; color: #666;">File Text</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #fff5f5; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #e53e3e;" id="textErrors">0</div>
                            <div style="font-size: 0.9em; color: #666;">L·ªói T√¨m Th·∫•y</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Upload ·∫¢nh v·ªõi AI Vision -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üì∏ Ph√¢n T√≠ch AI Vision</h3>
                <div class="image-upload-zone" id="imageUploadZone">
                    <input type="file" id="imageFileInput" style="display: none" accept="image/*" multiple>
                    <div style="font-size: 3em; margin-bottom: 15px;">ü§ñüëÅÔ∏è</div>
                    <h4>D·ªãch panic full b·∫±ng ·∫£nh</h4>
                    <p style="margin: 10px 0; color: #666;">jpg, png, heic, webp</p>
                    <button class="btn ai-btn" onclick="document.getElementById('imageFileInput').click()">T·∫£i ·∫¢nh L√™n</button>
                </div>
                
                <div class="ai-processing" id="aiProcessing">
                    <div class="ai-spinner"></div>
                    <h4>üß† AI ƒêang X·ª≠ L√Ω...</h4>
                    <p>Ph√¢n t√≠ch ·∫£nh v·ªõi OCR + Nh·∫≠n d·∫°ng m·∫´u n√¢ng cao</p>
                </div>
                
                <div style="margin-top: 25px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="text-align: center; padding: 15px; background: #fdf2f8; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #f093fb;" id="imageFiles">0</div>
                            <div style="font-size: 0.9em; color: #666;">·∫¢nh</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #3b82f6;" id="aiAccuracy">0%</div>
                            <div style="font-size: 0.9em; color: #666;">ƒê·ªô Ch√≠nh X√°c AI</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- T√¨m Ki·∫øm Th√¥ng Minh -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üîç T√¨m Ki·∫øm L·ªói Th√¥ng Minh</h3>
                <input type="text" class="search-box" id="searchBox" placeholder="T√¨m ki·∫øm 100+ l·ªói (watchdog, thermal, panic...)">
                
                <div class="category-filter">
                    <div class="category-btn active" onclick="filterByCategory('all')">T·∫•t C·∫£</div>
                    <div class="category-btn" onclick="filterByCategory('hardware')">Ph·∫ßn C·ª©ng</div>
                    <div class="category-btn" onclick="filterByCategory('software')">Ph·∫ßn M·ªÅm</div>
                    <div class="category-btn" onclick="filterByCategory('thermal')">Nhi·ªát ƒê·ªô</div>
                    <div class="category-btn" onclick="filterByCategory('power')">Ngu·ªìn</div>
                    <div class="category-btn" onclick="filterByCategory('memory')">B·ªô Nh·ªõ</div>
                </div>
                
                <div class="error-database" id="errorDatabase">
                    <div style="text-align: center; color: #666; padding: 30px;">
                        <div style="font-size: 2em; margin-bottom: 10px;">ü§ñ</div>
                        <p>AI s·∫µn s√†ng ph√¢n t√≠ch 100+ m·∫´u l·ªói</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <h3 style="margin-bottom: 30px;">üìä K·∫øt Qu·∫£ Ph√¢n T√≠ch AI</h3>
            <div id="analysisResults"></div>
        </div>
    </div>

    <script>
        // C∆° s·ªü d·ªØ li·ªáu 100+ l·ªói iOS panic log
        const errorDatabase = {
            // === L·ªñI PH·∫¶N C·ª®NG CHI TI·∫æT ===
            
            "watchdog_timeout": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói Watchdog timeout - CPU ho·∫∑c h·ªá th·ªëng kh√¥ng ph·∫£n h·ªìi trong th·ªùi gian quy ƒë·ªãnh",
                patterns: ["watchdog timeout", "WDOG", "no checkin", "hang", "watchdog_timeout"],
                vietnameseName: "L·ªói Watchdog Timeout",
                component: "Main Logic Board - CPU/SoC",
                location: "A-series Processor (A12/A13/A14/A15/A16)",
                symptoms: ["M√°y ƒë·ªôt ng·ªôt restart", "M√†n h√¨nh ƒëen", "Kh√¥ng ph·∫£n h·ªìi", "Treo m√°y"],
                causes: ["CPU overload", "Infinite loop trong kernel", "Hardware deadlock", "Power management issue"],
                diagnosis: {
                    step1: "Ki·ªÉm tra nhi·ªát ƒë·ªô CPU b·∫±ng 3uTools",
                    step2: "Test RAM b·∫±ng MemTest",
                    step3: "Ki·ªÉm tra ngu·ªìn c·∫•p cho CPU (PPVDD_MAIN)",
                    step4: "ƒêo ƒëi·ªán tr·ªü c√°c t·ª• l·ªçc ngu·ªìn CPU"
                },
                repairSolution: ["Thay IC ngu·ªìn CPU", "Reballing CPU", "Thay t·ª• l·ªçc ngu·ªìn", "Thay main board"]
            },

            "thermal_shutdown": {
                category: "thermal",
                severity: "critical", 
                description: "Thi·∫øt b·ªã t·ª± ƒë·ªông t·∫Øt do nhi·ªát ƒë·ªô qu√° cao, b·∫£o v·ªá linh ki·ªán kh·ªèi h∆∞ h·ªèng",
                patterns: ["thermal", "overtemp", "hot", "temperature", "thermal_shutdown", "thermal trap"],
                vietnameseName: "T·∫Øt M√°y Do Qu√° Nhi·ªát",
                component: "Thermal Management System",
                location: "CPU/GPU/PMU Temperature Sensors",
                symptoms: ["M√°y n√≥ng b·∫•t th∆∞·ªùng", "T·ª± ƒë·ªông t·∫Øt", "Hi·ªáu nƒÉng gi·∫£m", "Pin t·ª•t nhanh"],
                causes: ["Thermal paste kh√¥", "T·∫£n nhi·ªát b·ªã t·∫Øc", "Qu·∫°t h·ªèng", "Sensor nhi·ªát ƒë·ªô l·ªói"],
                diagnosis: {
                    step1: "ƒêo nhi·ªát ƒë·ªô b·∫±ng thermal camera",
                    step2: "Ki·ªÉm tra thermal paste CPU/GPU",
                    step3: "Test thermal sensor b·∫±ng DC Power Supply",
                    step4: "Ki·ªÉm tra thermal throttling trong log"
                },
                repairSolution: ["Thay thermal paste", "V·ªá sinh t·∫£n nhi·ªát", "Thay thermal sensor", "C·∫£i thi·ªán lu·ªìng kh√≠"]
            },

            "battery_panic": {
                category: "power",
                severity: "high",
                description: "L·ªói li√™n quan ƒë·∫øn pin v√† h·ªá th·ªëng ngu·ªìn, c√≥ th·ªÉ do pin h·ªèng ho·∫∑c m·∫°ch s·∫°c",
                patterns: ["battery", "power", "charging", "PMU", "battery_panic", "fuel gauge"],
                vietnameseName: "L·ªói Pin/Ngu·ªìn",
                component: "Battery Management System + PMU IC",
                location: "Logic Board - Power Management Section",
                symptoms: ["Kh√¥ng s·∫°c pin", "Pin t·ª•t nhanh", "B√°o sai % pin", "T·∫Øt m√°y ƒë·ªôt ng·ªôt"],
                causes: ["Pin chai/ph·ªìng", "IC s·∫°c h·ªèng", "C·∫£m bi·∫øn pin l·ªói", "M·∫°ch ngu·ªìn ch·∫≠p"],
                diagnosis: {
                    step1: "ƒêo voltage pin (3.7V nominal)",
                    step2: "Test d√≤ng s·∫°c b·∫±ng USB meter",
                    step3: "Ki·ªÉm tra IC s·∫°c U2 (Tristar)",
                    step4: "ƒêo ƒëi·ªán tr·ªü internal resistance pin"
                },
                repairSolution: ["Thay pin m·ªõi", "Thay IC s·∫°c U2", "S·ª≠a m·∫°ch ngu·ªìn", "Thay PMU IC"]
            },

            "memory_panic": {
                category: "memory",
                severity: "high",
                description: "L·ªói b·ªô nh·ªõ RAM ho·∫∑c storage, c√≥ th·ªÉ do RAM h·ªèng ho·∫∑c l·ªói d·ªØ li·ªáu",
                patterns: ["memory", "RAM", "ECC", "DRAM", "memory_panic", "memory corruption"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ RAM",
                component: "LPDDR4/LPDDR5 RAM Modules",
                location: "Logic Board - Memory Section (stacked on SoC)",
                symptoms: ["App crash li√™n t·ª•c", "Restart random", "L·ªói khi m·ªü app n·∫∑ng", "iOS lag"],
                causes: ["RAM b·ªã l·ªói", "Solder joints l·ªèng", "Nhi·ªát ƒë·ªô cao", "Voltage kh√¥ng ·ªïn ƒë·ªãnh"],
                diagnosis: {
                    step1: "Ch·∫°y memory test v·ªõi checkra1n",
                    step2: "Ki·ªÉm tra temperature RAM",
                    step3: "ƒêo voltage c·∫•p cho RAM (VDD_MEM)",
                    step4: "Test stress v·ªõi benchmark app"
                },
                repairSolution: ["Reballing RAM", "Thay RAM module", "S·ª≠a m·∫°ch ngu·ªìn RAM", "Thay main board"]
            },

            "nand_panic": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói b·ªô nh·ªõ NAND flash storage, th∆∞·ªùng do wear leveling ho·∫∑c bad block",
                patterns: ["NAND", "flash", "storage", "ANS2", "nand_panic", "storage controller"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ NAND Flash",
                component: "NAND Flash Storage + Storage Controller",
                location: "Logic Board - Storage Section",
                symptoms: ["Kh√¥ng boot ƒë∆∞·ª£c", "L·ªói restore", "M·∫•t d·ªØ li·ªáu", "iOS corrupt"],
                causes: ["Bad blocks qu√° nhi·ªÅu", "Controller h·ªèng", "Firmware corrupt", "Wear leveling fail"],
                diagnosis: {
                    step1: "Scan bad blocks b·∫±ng NAND programmer",
                    step2: "Ki·ªÉm tra storage controller",
                    step3: "Test read/write speed",
                    step4: "Dump firmware ƒë·ªÉ check corruption"
                },
                repairSolution: ["Thay NAND flash m·ªõi", "Repair bad blocks", "Reflash firmware", "Data recovery"]
            },

            "camera_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói camera module ho·∫∑c ISP (Image Signal Processor)",
                patterns: ["camera", "ISP", "H11", "H13", "camera_panic", "image sensor"],
                vietnameseName: "L·ªói Camera/ISP",
                component: "Camera Module + ISP (Image Signal Processor)",
                location: "Rear/Front Camera Assembly",
                symptoms: ["Camera app crash", "·∫¢nh ƒëen", "Kh√¥ng focus", "L·ªói flash"],
                causes: ["Camera module h·ªèng", "Flex cable l·ªèng", "ISP l·ªói", "OIS actuator stuck"],
                diagnosis: {
                    step1: "Test t·ª´ng camera ri√™ng l·∫ª",
                    step2: "Ki·ªÉm tra flex cable camera",
                    step3: "ƒêo voltage c·∫•p cho camera (AVDD/DVDD)",
                    step4: "Test ISP communication"
                },
                repairSolution: ["Thay camera module", "Thay flex cable", "S·ª≠a m·∫°ch ngu·ªìn camera", "Thay ISP IC"]
            },

            "touch_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói c·∫£m ·ª©ng touchscreen, c√≥ th·ªÉ do digitizer ho·∫∑c touch IC h·ªèng",
                patterns: ["touch", "multitouch", "digitizer", "touch_panic", "touch controller"],
                vietnameseName: "L·ªói C·∫£m ·ª®ng Touch",
                component: "Touch Controller IC + Digitizer",
                location: "Logic Board - Touch IC Section + Display Assembly",
                symptoms: ["C·∫£m ·ª©ng kh√¥ng ho·∫°t ƒë·ªông", "Ghost touch", "Dead zone", "Multi-touch l·ªói"],
                causes: ["Touch IC h·ªèng", "Digitizer crack", "Flex cable l·ªói", "ESD damage"],
                diagnosis: {
                    step1: "Test c·∫£m ·ª©ng b·∫±ng diagnostic mode",
                    step2: "Ki·ªÉm tra touch IC (Meson/Broadcom)",
                    step3: "ƒêo voltage touch rails",
                    step4: "Test continuity flex cable"
                },
                repairSolution: ["Thay touch IC", "Thay m√†n h√¨nh", "S·ª≠a flex cable", "ESD protection repair"]
            },

            "wifi_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói WiFi module, c√≥ th·ªÉ do chip WiFi h·ªèng ho·∫∑c anten b·ªã l·ªói",
                patterns: ["wifi", "wlan", "802.11", "wifi_panic", "wireless"],
                vietnameseName: "L·ªói WiFi Module",
                component: "WiFi/Bluetooth Combo Chip + Antenna",
                location: "Logic Board - RF Section + Antenna Assembly",
                                symptoms: ["Kh√¥ng b·∫Øt ƒë∆∞·ª£c WiFi", "WiFi y·∫øu", "Disconnect li√™n t·ª•c", "Kh√¥ng t√¨m th·∫•y network"],
                causes: ["WiFi chip h·ªèng", "Antenna ƒë·ª©t", "RF shield l·ªèng", "Firmware corrupt"],
                diagnosis: {
                    step1: "Scan WiFi networks xung quanh",
                    step2: "Test WiFi chip communication",
                    step3: "Ki·ªÉm tra antenna continuity",
                    step4: "ƒêo RF power output"
                },
                repairSolution: ["Thay WiFi chip", "S·ª≠a/thay antenna", "Reballing RF IC", "Update firmware"]
            },

            "bluetooth_panic": {
                category: "hardware",
                severity: "low",
                description: "L·ªói Bluetooth module, th∆∞·ªùng do chip Bluetooth ho·∫∑c driver b·ªã l·ªói",
                patterns: ["bluetooth", "BT", "wireless", "bluetooth_panic"],
                vietnameseName: "L·ªói Bluetooth",
                component: "Bluetooth Controller (integrated with WiFi)",
                location: "WiFi/BT Combo Chip",
                symptoms: ["Kh√¥ng pair ƒë∆∞·ª£c", "Audio stuttering", "Disconnect", "Kh√¥ng t√¨m th·∫•y devices"],
                causes: ["BT firmware l·ªói", "Antenna issue", "Power management", "Interference"],
                diagnosis: {
                    step1: "Test Bluetooth pairing",
                    step2: "Check BT firmware version",
                    step3: "Test audio codec",
                    step4: "Scan for interference"
                },
                repairSolution: ["Update BT firmware", "Thay WiFi/BT chip", "Antenna repair", "RF shielding"]
            },

            "accelerometer_panic": {
                category: "sensor",
                severity: "low",
                description: "L·ªói c·∫£m bi·∫øn gia t·ªëc, c√≥ th·ªÉ do c·∫£m bi·∫øn h·ªèng ho·∫∑c l·ªói calibration",
                patterns: ["accelerometer", "motion", "gyro", "accelerometer_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn Gia T·ªëc",
                component: "Accelerometer/Gyroscope Sensor IC",
                location: "Logic Board - Sensor Array",
                symptoms: ["Xoay m√†n h√¨nh kh√¥ng ho·∫°t ƒë·ªông", "Game motion l·ªói", "Compass sai", "Shake kh√¥ng work"],
                causes: ["Sensor IC h·ªèng", "Calibration sai", "Mechanical damage", "Software bug"],
                diagnosis: {
                    step1: "Test sensor trong Settings > Privacy",
                    step2: "Calibrate accelerometer",
                    step3: "Ki·ªÉm tra sensor IC",
                    step4: "Test v·ªõi motion apps"
                },
                repairSolution: ["Recalibrate sensor", "Thay sensor IC", "Software reset", "Logic board repair"]
            },

            // === L·ªñI PH·∫¶N M·ªÄM CHI TI·∫æT ===
            "kernel_panic": {
                category: "software",
                severity: "critical",
                description: "Kernel panic - L·ªói nghi√™m tr·ªçng c·ªßa h·ªá ƒëi·ªÅu h√†nh iOS",
                patterns: ["kernel panic", "KP", "system crash", "kernel_panic"],
                vietnameseName: "L·ªói Kernel Panic",
                component: "iOS Kernel (XNU)",
                location: "System Software Level",
                symptoms: ["Restart ƒë·ªôt ng·ªôt", "M√†n h√¨nh xanh", "Freeze ho√†n to√†n", "Boot loop"],
                causes: ["Driver conflict", "Memory corruption", "Hardware failure", "Jailbreak tweak"],
                diagnosis: {
                    step1: "Ph√¢n t√≠ch panic log chi ti·∫øt",
                    step2: "Ki·ªÉm tra recent installs",
                    step3: "Test safe mode",
                    step4: "Hardware diagnostic"
                },
                repairSolution: ["iOS restore", "Remove jailbreak", "Hardware repair", "Factory reset"]
            },

            "springboard_crash": {
                category: "software",
                severity: "high",
                description: "SpringBoard crash - Giao di·ªán ch√≠nh iOS b·ªã crash",
                patterns: ["SpringBoard", "backboardd", "frontboard", "springboard_crash"],
                vietnameseName: "L·ªói SpringBoard",
                component: "SpringBoard Process",
                location: "iOS User Interface Layer",
                symptoms: ["Home screen crash", "Icons bi·∫øn m·∫•t", "Wallpaper ƒëen", "Touch kh√¥ng response"],
                causes: ["Memory leak", "Corrupt preferences", "Bad tweak", "iOS bug"],
                diagnosis: {
                    step1: "Check SpringBoard crash logs",
                    step2: "Reset home screen layout",
                    step3: "Clear cache v√† temp files",
                    step4: "Disable tweaks n·∫øu c√≥ JB"
                },
                repairSolution: ["Reset settings", "Clear SpringBoard cache", "iOS update", "Remove problematic apps"]
            },

            // === L·ªñI NHI·ªÜT ƒê·ªò CHI TI·∫æT ===
            "cpu_thermal": {
                category: "thermal",
                severity: "high",
                description: "CPU qu√° nhi·ªát, h·ªá th·ªëng t·ª± ƒë·ªông throttle ƒë·ªÉ b·∫£o v·ªá",
                patterns: ["CPU thermal", "processor hot", "thermal throttle", "cpu_thermal"],
                vietnameseName: "CPU Qu√° Nhi·ªát",
                component: "A-series SoC (CPU cores)",
                location: "Main Processor Package",
                symptoms: ["M√°y ch·∫≠m ƒë·ªôt ng·ªôt", "App lag", "Frame drop", "M√°y n√≥ng"],
                causes: ["Thermal paste kh√¥", "Dust buildup", "High CPU usage", "Cooling system fail"],
                diagnosis: {
                    step1: "Monitor CPU temperature real-time",
                    step2: "Check thermal throttling logs",
                    step3: "Inspect thermal paste condition",
                    step4: "Test under load"
                },
                repairSolution: ["Replace thermal paste", "Clean cooling system", "Reduce CPU load", "Improve ventilation"]
            },

            "gpu_thermal": {
                category: "thermal",
                severity: "high",
                description: "GPU qu√° nhi·ªát khi x·ª≠ l√Ω ƒë·ªì h·ªça n·∫∑ng",
                patterns: ["GPU thermal", "graphics hot", "GPU throttle", "gpu_thermal"],
                vietnameseName: "GPU Qu√° Nhi·ªát",
                component: "GPU (integrated in SoC)",
                location: "Graphics Processing Unit",
                symptoms: ["Game lag", "Graphics glitch", "3D app crash", "Rendering slow"],
                causes: ["Heavy graphics load", "Poor thermal design", "Dust accumulation", "Thermal paste degraded"],
                diagnosis: {
                    step1: "Run GPU stress test",
                    step2: "Monitor GPU temperature",
                    step3: "Check graphics performance",
                    step4: "Thermal imaging"
                },
                repairSolution: ["Thermal management", "Reduce graphics quality", "Clean thermal system", "Hardware upgrade"]
            },

            // === L·ªñI NGU·ªíN CHI TI·∫æT ===
            "pmu_panic": {
                category: "power",
                severity: "critical",
                description: "Power Management Unit panic - L·ªói IC qu·∫£n l√Ω ngu·ªìn",
                patterns: ["PMU", "power management", "PMIC", "pmu_panic"],
                vietnameseName: "L·ªói IC Qu·∫£n L√Ω Ngu·ªìn (PMU)",
                component: "Power Management IC (PMU)",
                location: "Logic Board - Power Section",
                symptoms: ["Kh√¥ng l√™n ngu·ªìn", "Ngu·ªìn kh√¥ng ·ªïn ƒë·ªãnh", "Random shutdown", "Charging issues"],
                causes: ["PMU IC failure", "Power rail short", "Voltage regulator damage", "Overcurrent protection"],
                diagnosis: {
                    step1: "ƒêo c√°c rail ngu·ªìn ch√≠nh",
                    step2: "Ki·ªÉm tra PMU communication",
                    step3: "Test power sequencing",
                    step4: "Check for shorts"
                },
                repairSolution: ["Thay PMU IC", "Repair power rails", "Fix short circuits", "Replace power components"]
            },

            "charging_panic": {
                category: "power",
                severity: "medium",
                description: "L·ªói s·∫°c pin, c√≥ th·ªÉ do c√°p s·∫°c ho·∫∑c IC s·∫°c h·ªèng",
                patterns: ["charging", "charger", "USB-C", "lightning", "charging_panic"],
                vietnameseName: "L·ªói S·∫°c Pin",
                component: "Charging IC (Tristar U2) + Lightning/USB-C Port",
                location: "Logic Board + Dock Connector",
                symptoms: ["Kh√¥ng s·∫°c", "S·∫°c ch·∫≠m", "N√≥ng khi s·∫°c", "Accessory not supported"],
                causes: ["Tristar IC h·ªèng", "C·ªïng s·∫°c b·∫©n", "Cable l·ªói", "Power adapter issue"],
                diagnosis: {
                    step1: "Test v·ªõi nhi·ªÅu cable/adapter kh√°c nhau",
                    step2: "Ki·ªÉm tra Tristar IC (U2)",
                    step3: "ƒêo voltage/current khi s·∫°c",
                    step4: "Inspect charging port"
                },
                repairSolution: ["Thay Tristar IC", "V·ªá sinh c·ªïng s·∫°c", "Thay c·ªïng s·∫°c", "Use certified accessories"]
            },

            // === L·ªñI C·∫¢M BI·∫æN CHI TI·∫æT ===
            "proximity_sensor_panic": {
                category: "sensor",
                severity: "medium",
                description: "L·ªói c·∫£m bi·∫øn proximity, m√†n h√¨nh kh√¥ng t·∫Øt khi g·ªçi",
                patterns: ["proximity", "distance", "IR sensor", "proximity_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn Proximity",
                component: "Proximity Sensor (IR LED + Photodiode)",
                location: "Front Camera/Sensor Assembly",
                symptoms: ["M√†n h√¨nh kh√¥ng t·∫Øt khi g·ªçi", "Accidental touch during calls", "Face detection l·ªói"],
                causes: ["Sensor blocked", "Calibration error", "Hardware failure", "Screen protector interference"],
                diagnosis: {
                    step1: "Test proximity trong Phone app",
                    step2: "Check sensor calibration",
                    step3: "Remove screen protector/case",
                    step4: "Clean sensor area"
                },
                repairSolution: ["Clean sensor", "Recalibrate", "Remove obstructions", "Replace sensor assembly"]
            },

            "ambient_light_panic": {
                category: "sensor",
                severity: "low",
                description: "L·ªói c·∫£m bi·∫øn √°nh s√°ng, ƒë·ªô s√°ng m√†n h√¨nh kh√¥ng t·ª± ƒë·ªông",
                patterns: ["ambient light", "light sensor", "brightness", "als_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn √Ånh S√°ng",
                component: "Ambient Light Sensor (ALS)",
                location: "Front Camera/Sensor Assembly",
                symptoms: ["Auto brightness kh√¥ng ho·∫°t ƒë·ªông", "M√†n h√¨nh qu√° s√°ng/t·ªëi", "True Tone l·ªói"],
                causes: ["Sensor covered", "Calibration drift", "Hardware damage", "Software bug"],
                diagnosis: {
                    step1: "Test auto brightness",
                    step2: "Check True Tone functionality",
                    step3: "Calibrate light sensor",
                    step4: "Test in different lighting"
                },
                repairSolution: ["Sensor recalibration", "Clean sensor area", "Software reset", "Hardware replacement"]
            },

            // === L·ªñI B·∫¢O M·∫¨T CHI TI·∫æT ===
            "secure_enclave_panic": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói Secure Enclave - chip b·∫£o m·∫≠t, ·∫£nh h∆∞·ªüng ƒë·∫øn Touch ID/Face ID",
                patterns: ["secure enclave", "SEP", "security", "secure_enclave_panic"],
                vietnameseName: "L·ªói Chip B·∫£o M·∫≠t (Secure Enclave)",
                component: "Secure Enclave Processor (SEP)",
                location: "Integrated in A-series SoC",
                symptoms: ["Touch ID/Face ID kh√¥ng ho·∫°t ƒë·ªông", "Passcode required", "Keychain errors", "Apple Pay l·ªói"],
                causes: ["SEP firmware corruption", "Hardware tampering", "Security violation", "Crypto engine failure"],
                diagnosis: {
                    step1: "Test biometric authentication",
                    step2: "Check SEP firmware version",
                    step3: "Verify security certificates",
                    step4: "Hardware integrity check"
                },
                repairSolution: ["SEP firmware restore", "Factory reset", "Hardware replacement", "Professional repair"]
            },

            "touchid_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói Touch ID sensor, kh√¥ng th·ªÉ nh·∫≠n d·∫°ng v√¢n tay",
                patterns: ["Touch ID", "fingerprint", "biometric", "touchid_panic"],
                vietnameseName: "L·ªói Touch ID",
                component: "Touch ID Sensor + Secure Enclave",
                location: "Home Button Assembly (older models)",
                symptoms: ["Touch ID setup failed", "Fingerprint not recognized", "Sensor dirty message"],
                causes: ["Sensor damage", "Cable disconnected", "Moisture damage", "Calibration lost"],
                diagnosis: {
                    step1: "Clean Touch ID sensor",
                    step2: "Test sensor connectivity",
                    step3: "Check for physical damage",
                    step4: "Attempt recalibration"
                },
                repairSolution: ["Clean sensor thoroughly", "Replace home button", "Cable repair", "Sensor recalibration"]
            },

            "faceid_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói Face ID system, camera TrueDepth kh√¥ng ho·∫°t ƒë·ªông",
                patterns: ["Face ID", "TrueDepth", "facial recognition", "faceid_panic"],
                vietnameseName: "L·ªói Face ID",
                component: "TrueDepth Camera System",
                location: "Front Camera Assembly (Notch)",
                symptoms: ["Face ID unavailable", "Setup failed", "Not recognized", "Attention detection off"],
                causes: ["Camera damage", "Dot projector failure", "Flood illuminator issue", "Calibration lost"],
                diagnosis: {
                    step1: "Test TrueDepth camera",
                    step2: "Check dot projector",
                    step3: "Verify flood illuminator",
                    step4: "Face ID diagnostic"
                },
                repairSolution: ["Replace TrueDepth assembly", "Professional calibration", "Clean camera area", "Software restore"]
            },

            // === L·ªñI STORAGE CHI TI·∫æT ===
            "storage_panic": {
                category: "hardware",
                severity: "high",
                description: "L·ªói b·ªô nh·ªõ trong, SSD ho·∫∑c eMMC b·ªã h·ªèng",
                patterns: ["storage", "flash", "SSD", "eMMC", "storage_panic"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ Trong",
                component: "NAND Flash Storage",
                location: "Logic Board - Storage Package",
                symptoms: ["Boot failure", "Storage full errors", "Slow performance", "Data corruption"],
                causes: ["Flash wear out", "Bad blocks", "Controller failure", "Firmware corruption"],
                diagnosis: {
                    step1: "Check storage health",
                    step2: "Scan for bad blocks",
                    step3: "Test read/write speed",
                    step4: "Firmware integrity check"
                },
                repairSolution: ["Storage replacement", "Data recovery", "Bad block repair", "Firmware reflash"]
            },

            "bad_block_panic": {
                category: "hardware",
                severity: "medium",
                description: "Bad block trong b·ªô nh·ªõ flash, m·ªôt ph·∫ßn storage kh√¥ng s·ª≠ d·ª•ng ƒë∆∞·ª£c",
                patterns: ["bad block", "flash error", "storage corruption", "bad_block_panic"],
                vietnameseName: "L·ªói Bad Block Storage",
                component: "NAND Flash Memory Blocks",
                location: "Storage Package",
                symptoms: ["Random crashes", "File corruption", "Slow writes", "Storage errors"],
                causes: ["Flash memory aging", "Write/erase cycles exceeded", "Physical damage", "Power failure during write"],
                diagnosis: {
                    step1: "Bad block scan",
                    step2: "Flash memory test",
                    step3: "Write endurance test",
                    step4: "Error correction analysis"
                },
                repairSolution: ["Bad block remapping", "Storage replacement", "Data backup/restore", "Wear leveling optimization"]
            },
                // Th√™m v√†o errorDatabase object
            "mic1_panic": {
                category: "hardware",
                severity: "high",
                description: "L·ªói mic1 - Charging port flex cable ho·∫∑c board issue (SE 2020)",
                patterns: ["mic1", "charging port flex", "mic1 panic"],
                vietnameseName: "L·ªói Mic1 - C·ªïng S·∫°c",
                component: "Charging Port Flex Cable",
                location: "Dock Connector Assembly",
                symptoms: ["Mic kh√¥ng ho·∫°t ƒë·ªông", "S·∫°c kh√¥ng ·ªïn ƒë·ªãnh", "Random restart khi c·∫Øm s·∫°c"],
                causes: ["Flex cable h·ªèng", "Corrosion t·∫°i dock connector", "Board level issue"],
                diagnosis: {
                    step1: "Ki·ªÉm tra charging port flex cable",
                    step2: "Test microphone functionality", 
                    step3: "Inspect dock connector for corrosion",
                    step4: "Board level diagnostic n·∫øu SE 2020"
                },
                repairSolution: ["Thay charging port flex", "V·ªá sinh dock connector", "Board repair", "Thay dock assembly"]
},

            "mic2_panic": {
                category: "hardware", 
                severity: "medium",
                description: "L·ªói mic2 - Power button flex cable",
                patterns: ["mic2", "power button flex", "mic2 panic"],
                vietnameseName: "L·ªói Mic2 - N√∫t Ngu·ªìn",
                component: "Power Button Flex Cable",
                location: "Side Button Assembly",
                symptoms: ["Power button kh√¥ng nh·∫°y", "Mic ph·ª• kh√¥ng ho·∫°t ƒë·ªông", "Volume control l·ªói"],
                causes: ["Flex cable torn", "Water damage", "Mechanical wear"],
                diagnosis: {
                    step1: "Test power button responsiveness",
                    step2: "Check flex cable continuity",
                    step3: "Inspect for physical damage",
                    step4: "Test volume buttons"
                },
                repairSolution: ["Thay power button flex", "Clean contacts", "Realign cable", "Replace button assembly"]
},

"prs0_panic": {
    category: "hardware",
    severity: "high", 
    description: "L·ªói prs0 - Charging port flex related",
    patterns: ["prs0", "charging port", "dock connector"],
    vietnameseName: "L·ªói PRS0 - C·ªïng S·∫°c",
    component: "Charging Port Pressure Sensor",
    location: "Dock Connector - Pressure Sensor",
    symptoms: ["S·∫°c kh√¥ng nh·∫≠n d·∫°ng", "Accessory not supported", "Charging intermittent"],
    causes: ["Pressure sensor failure", "Flex cable damage", "Liquid damage"],
    diagnosis: {
        step1: "Test charging with multiple cables",
        step2: "Inspect pressure sensor",
        step3: "Check flex cable integrity", 
        step4: "Measure sensor resistance"
    },
    repairSolution: ["Replace pressure sensor", "Thay charging flex", "Clean liquid damage", "Dock connector replacement"]
},

"tg0b_panic": {
    category: "power",
    severity: "critical",
    description: "L·ªói tg0b - Battery, battery connector ho·∫∑c battery data line",
    patterns: ["tg0b", "battery data", "battery connector"],
    vietnameseName: "L·ªói TG0B - Pin/Data Line",
    component: "Battery Management System + Data Lines",
    location: "Battery Connector + Logic Board",
    symptoms: ["Battery percentage jump", "Unexpected shutdown", "Charging issues", "Battery not detected"],
    causes: ["Battery connector corrosion", "Data line broken", "Battery BMS failure", "Logic board damage"],
    diagnosis: {
        step1: "Inspect battery connector pins",
        step2: "Test battery data line continuity",
        step3: "Check battery BMS communication",
        step4: "Measure battery connector resistance"
    },
    repairSolution: ["Clean battery connector", "Repair data lines", "Replace battery", "Logic board repair"]
},

"ans2_nand_panic": {
    category: "hardware",
    severity: "critical",
    description: "L·ªói ANS2 NAND related - Advanced NAND Storage controller",
    patterns: ["ans2", "NAND related", "storage controller"],
    vietnameseName: "L·ªói ANS2 NAND Controller",
    component: "ANS2 NAND Storage Controller",
    location: "Logic Board - Advanced Storage Section",
    symptoms: ["Boot failure", "Storage corruption", "Data loss", "Slow performance"],
    causes: ["NAND controller failure", "Storage firmware corruption", "Bad NAND blocks", "Power delivery issues"],
    diagnosis: {
        step1: "NAND controller diagnostic",
        step2: "Storage firmware integrity check",
        step3: "Bad block analysis",
        step4: "Power rail measurement"
    },
    repairSolution: ["NAND controller replacement", "Firmware reflash", "Storage module replacement", "Data recovery"]
},

"aop_panic": {
    category: "hardware",
    severity: "high",
    description: "AOP (Always On Processor) panic - Ambiguous error c·∫ßn xem keywords",
    patterns: ["AOP PANIC", "always on processor", "aop"],
    vietnameseName: "L·ªói AOP - Always On Processor", 
    component: "Always On Processor (AOP)",
    location: "Logic Board - Low Power Management Section",
    symptoms: ["Sleep/wake issues", "Sensor malfunction", "Background processing errors", "Power management problems"],
    causes: ["AOP firmware corruption", "Sensor communication failure", "Power management IC issue", "Logic board damage"],
    diagnosis: {
        step1: "AOP firmware diagnostic",
        step2: "Sensor array testing",
        step3: "Power management analysis",
        step4: "Background process monitoring"
    },
    repairSolution: ["AOP firmware restore", "Sensor calibration", "Power IC replacement", "Logic board repair"]
},

"ememory_panic": {
    category: "hardware", 
    severity: "critical",
    description: "L·ªói Ememory - NAND flash memory, ch·ªß y·∫øu tr√™n iPhone 5s/6",
    patterns: ["Ememory", "flash memory", "nand flash"],
    vietnameseName: "L·ªói EMemory - NAND Flash",
    component: "Embedded Memory (eMMC/NAND)",
    location: "Logic Board - Storage Package (iPhone 5s/6)",
    symptoms: ["Boot loop", "Storage errors", "App crashes", "System instability"],
    causes: ["NAND wear out", "Memory controller failure", "Bad sectors", "Firmware corruption"],
    diagnosis: {
        step1: "Memory health check",
        step2: "Bad sector scan", 
        step3: "Controller functionality test",
        step4: "Firmware integrity verification"
    },
    repairSolution: ["NAND replacement", "Memory controller repair", "Bad sector remapping", "Firmware reflash"]
},

"anc_postnand_panic": {
    category: "hardware",
    severity: "critical", 
    description: "L·ªói ANC PostNAND assertion failed - NAND controller critical error",
    patterns: ["Anc-postnand.c1260 asser failed link", "ANC PostNAND", "nand controller"],
    vietnameseName: "L·ªói ANC PostNAND",
    component: "Apple NAND Controller (ANC)",
    location: "Logic Board - NAND Controller Section",
    symptoms: ["Complete boot failure", "NAND not detected", "Storage inaccessible", "Recovery mode loop"],
    causes: ["NAND controller hardware failure", "Controller firmware corruption", "NAND-controller communication breakdown"],
    diagnosis: {
        step1: "NAND controller hardware test",
        step2: "Controller-NAND communication check",
        step3: "Firmware integrity analysis",
        step4: "Power delivery to controller"
    },
    repairSolution: ["NAND controller replacement", "Controller firmware recovery", "Complete storage module replacement", "Logic board replacement"]
},

"stacks_routined_panic": {
    category: "power",
    severity: "high",
    description: "L·ªói Stacks + routined - Battery related, ch·ªß y·∫øu tr√™n iPad",
    patterns: ["Stacks + routined", "battery stack", "power routine"],
    vietnameseName: "L·ªói Stack Routine - Pin",
    component: "Battery Power Management Stack",
    location: "Battery Management System",
    symptoms: ["Random shutdowns", "Power cycling", "Battery calibration issues", "Charging problems"],
    causes: ["Battery stack overflow", "Power management routine failure", "Battery firmware bug", "Power IC malfunction"],
    diagnosis: {
        step1: "Battery stack analysis",
        step2: "Power management routine check",
        step3: "Battery firmware diagnostic",
        step4: "Power IC functionality test"
    },
    repairSolution: ["Battery replacement", "Power management reset", "Firmware update", "Power IC replacement"]
},

"applbcmwlan_panic": {
    category: "hardware",
    severity: "medium",
    description: "L·ªói AppleBCMWLAN - WiFi/Bluetooth chip, ch·ªß y·∫øu iPhone 7",
    patterns: ["AppleBCMWLAN", "BCM WLAN", "wifi bluetooth"],
    vietnameseName: "L·ªói AppleBCMWLAN - WiFi/BT",
    component: "Broadcom WiFi/Bluetooth Chip",
    location: "Logic Board - RF Section (iPhone 7 series)",
    symptoms: ["WiFi/BT kh√¥ng ho·∫°t ƒë·ªông", "RF communication failure", "Network connectivity issues"],
    causes: ["BCM chip failure", "RF calibration lost", "Antenna disconnection", "Power supply issues"],
    diagnosis: {
        step1: "BCM chip functionality test",
        step2: "RF calibration check",
        step3: "Antenna continuity test",
        step4: "RF power supply measurement"
    },
    repairSolution: ["BCM chip replacement", "RF recalibration", "Antenna repair", "RF power circuit fix"]
},

"sep_rom_panic": {
    category: "hardware",
    severity: "critical",
    description: "Secure Enclave Processor ROM failure - Critical security subsystem",
    patterns: ["SEP ROM", "secure enclave rom", "sep firmware"],
    vietnameseName: "L·ªói SEP ROM - B·ªô Nh·ªõ B·∫£o M·∫≠t",
    component: "Secure Enclave Processor ROM",
    location: "Integrated in A-series SoC",
    symptoms: ["Security features disabled", "Biometric authentication failed", "Encryption errors", "Boot security failure"],
    causes: ["ROM corruption", "Hardware tampering detection", "Firmware integrity failure", "Security violation"],
    diagnosis: {
        step1: "SEP ROM integrity check",
        step2: "Security violation analysis", 
        step3: "Firmware signature verification",
        step4: "Hardware tampering detection"
    },
    repairSolution: ["SEP firmware recovery", "Security reset", "Hardware replacement", "Professional security repair"]
},

"cpu_peripheral_panic": {
    category: "hardware",
    severity: "critical",
    description: "Problem connecting CPU to peripherals - CPU communication failure",
    patterns: ["CPU peripheral", "cpu communication", "peripheral connection"],
    vietnameseName: "L·ªói K·∫øt N·ªëi CPU-Peripheral",
    component: "CPU-Peripheral Communication Bus",
    location: "Logic Board - CPU Interface Section",
    symptoms: ["System freeze", "Peripheral malfunction", "Communication timeouts", "Hardware detection failure"],
    causes: ["Bus line damage", "CPU package failure", "Peripheral controller damage", "Signal integrity issues"],
    diagnosis: {
        step1: "CPU-peripheral bus testing",
        step2: "Signal integrity analysis",
        step3: "Peripheral controller check",
        step4: "CPU package inspection"
    },
    repairSolution: ["Bus line repair", "CPU replacement", "Peripheral controller fix", "Logic board replacement"]
}

        };

        // Bi·∫øn global
        let currentFilter = 'all';
        let uploadedFiles = [];
        let analysisResults = [];

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            displayErrorDatabase();
            initializeAINeuralNetwork();
            loadSavedResults();
            addAdvancedEffects();
        });

        // Thi·∫øt l·∫≠p event listeners
        function setupEventListeners() {
            // Text file upload
            const textUploadZone = document.getElementById('textUploadZone');
            const textFileInput = document.getElementById('textFileInput');
            
            textUploadZone.addEventListener('dragover', handleDragOver);
            textUploadZone.addEventListener('drop', (e) => handleDrop(e, 'text'));
            textFileInput.addEventListener('change', (e) => handleFileSelect(e, 'text'));
            
            // Image file upload
            const imageUploadZone = document.getElementById('imageUploadZone');
            const imageFileInput = document.getElementById('imageFileInput');
            
            imageUploadZone.addEventListener('dragover', handleDragOver);
            imageUploadZone.addEventListener('drop', (e) => handleDrop(e, 'image'));
            imageFileInput.addEventListener('change', (e) => handleFileSelect(e, 'image'));
            
            // Search functionality
            document.getElementById('searchBox').addEventListener('input', handleSearch);
        }

        // Kh·ªüi t·∫°o AI Neural Network (m√¥ ph·ªèng)
        function initializeAINeuralNetwork() {
            console.log('üß† Kh·ªüi t·∫°o AI Neural Network...');
            console.log('üëÅÔ∏è Computer Vision Engine: READY');
            console.log('üîç OCR Engine: READY');
            console.log('üìä Pattern Recognition: READY');
        }

        // X·ª≠ l√Ω drag over
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        // X·ª≠ l√Ω drop file
        function handleDrop(e, type) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            processFiles(files, type);
        }

        // X·ª≠ l√Ω ch·ªçn file
        function handleFileSelect(e, type) {
            const files = e.target.files;
            processFiles(files, type);
        }

        // X·ª≠ l√Ω files
        function processFiles(files, type) {
            for (let file of files) {
                if (type === 'text') {
                    processTextFile(file);
                } else if (type === 'image') {
                    processImageFileAdvanced(file);
                }
            }
        }

        // X·ª≠ l√Ω file text
        function processTextFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                analyzeTextContent(content, file.name);
                updateTextFileCount();
            };
            reader.readAsText(file);
        }

        // X·ª≠ l√Ω file ·∫£nh v·ªõi AI Vision n√¢ng cao
        function processImageFileAdvanced(file) {
            document.getElementById('aiProcessing').style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = async function() {
                    // Hi·ªÉn th·ªã ·∫£nh preview v·ªõi scan effect
                    displayImagePreviewWithEffects(e.target.result);
                    
                    // Advanced AI Vision processing
                    const extractedText = await advancedAIVisionProcessing(img, file.name);
                    analyzeTextContent(extractedText, file.name + ' (AI Vision Pro)');
                    updateImageFileCount();
                    document.getElementById('aiProcessing').style.display = 'none';
                    updateAIAccuracy();
                    
                    // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
                    showSuccessNotification('AI Vision ƒë√£ ph√¢n t√≠ch th√†nh c√¥ng!');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Advanced AI Vision Processing Simulation
        function advancedAIVisionProcessing(imageData, filename) {
            return new Promise((resolve) => {
                const processingSteps = [
                    'Kh·ªüi t·∫°o Neural Network...',
                    'Ti·ªÅn x·ª≠ l√Ω ·∫£nh v·ªõi Computer Vision...',
                    '√Åp d·ª•ng OCR Engine n√¢ng cao...',
                    'Ph√¢n t√≠ch Pattern Recognition...',
                    'X·ª≠ l√Ω Natural Language Processing...',
                    'T·ªëi ∆∞u h√≥a k·∫øt qu·∫£ v·ªõi Deep Learning...',
                    'Ho√†n t·∫•t ph√¢n t√≠ch AI Vision!'
                ];

                let currentStep = 0;
                const processingDiv = document.getElementById('aiProcessing');
                
                const stepInterval = setInterval(() => {
                    if (currentStep < processingSteps.length) {
                        processingDiv.innerHTML = `
                            <div class="ai-spinner"></div>
                            <h4>üß† ${processingSteps[currentStep]}</h4>
                            <div style="margin: 15px 0;">
                                <div style="background: #e2e8f0; border-radius: 10px; height: 8px; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: ${(currentStep + 1) / processingSteps.length * 100}%; transition: width 0.5s ease; border-radius: 10px;"></div>
                                </div>
                                <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                                    B∆∞·ªõc ${currentStep + 1}/${processingSteps.length} - ${Math.round((currentStep + 1) / processingSteps.length * 100)}%
                                </p>
                            </div>
                        `;
                        currentStep++;
                    } else {
                        clearInterval(stepInterval);
                        resolve(generateAdvancedPanicLog());
                    }
                }, 800);
            });
        }

        // Generate advanced panic log v·ªõi nhi·ªÅu chi ti·∫øt h∆°n
        function generateAdvancedPanicLog() {
            const panicTypes = [
                {
                    type: 'watchdog_timeout',
                    log: `panic(cpu 0 caller 0xffffff8000a9c5c4): "watchdog timeout: no checkins from watchdog for 120 seconds"
Kernel Extensions in backtrace:
com.apple.driver.AppleUSBXHCI(1.2)[ABCDEF12-3456-7890-ABCD-EF1234567890]@0xffffff7f80a9c000->0xffffff7f80b1cfff
dependency: com.apple.iokit.IOUSBFamily(900.4.1)[12345678-90AB-CDEF-1234-567890ABCDEF]@0xffffff7f809a8000

BSD process name corresponding to current thread: kernel_task
Boot args: chunklist-security-epoch=0 -chunklist-no-rev2-dev

Mac OS version: 19H15
Kernel version: Darwin Kernel Version 19.6.0: Mon Aug 31 22:12:52 PDT 2020; root:xnu-6153.141.2~1/RELEASE_ARM64_T8030
Kernel UUID: 12345678-90AB-CDEF-1234-567890ABCDEF
KernelCache slide: 0x0000000019000000
KernelCache base:  0xffffff801a000000
Kernel slide:      0x0000000019000000
Kernel text base:  0xffffff801a000000
__HIB  text base:  0xffffff8019000000
System model name: iPhone12,1 (iPhone 11)
System uptime in nanoseconds: 1234567890123456789
last started kext at 98765432109876: com.apple.driver.usb.AppleUSBEHCI (1.1)
loaded kexts:
com.apple.filesystems.apfs          1412.141.1
com.apple.driver.AppleANS2Controller 4.27.50`
                },
                {
                    type: 'thermal_shutdown',
                    log: `panic(cpu 1 caller 0xffffff8000b2d8a4): "thermal trap"
Thermal pressure: 95¬∞C (Critical threshold: 85¬∞C)
CPU temperature: 98¬∞C
GPU temperature: 92¬∞C
PMU temperature: 89¬∞C
Battery temperature: 45¬∞C

Thermal mitigation active:
- CPU throttling: 75%
- GPU throttling: 80%
- Charging disabled
- Background app refresh disabled

Backtrace (CPU 1), Frame : Return Address
0xffffff920b5c3e30 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920b5c3e80 : 0xffffff8000b6c274 mach_kernel : _thermal_trap + 0x274

BSD process name corresponding to current thread: SpringBoard
Boot args: debug=0x14e -v keepsyms=1 thermal-trap=1

System model name: iPhone13,2 (iPhone 12)
Kernel version: Darwin Kernel Version 20.6.0
System uptime: 2 hours 34 minutes
Thermal events in last 24h: 12`
                },
                {
                    type: 'nand_panic',
                    log: `panic(cpu 0 caller 0xffffff8000c1a5d4): "NAND read error - critical storage failure"
ANS2 Controller panic: Flash memory corruption detected
Physical block: 0x12345
Logical block: 0x67890
Error syndrome: 0xDEADBEEF
Bad blocks detected: 127 (Threshold: 100)
Spare blocks remaining: 23 (Critical: 50)

Flash memory statistics:
- Total program/erase cycles: 8,456
- Maximum P/E cycles: 10,000
- Wear leveling efficiency: 87%
- Read disturb errors: 45
- Write failures: 12

Kernel Extensions in backtrace:
com.apple.driver.AppleANS2Controller(4.27.50)[12345678-90AB-CDEF-1234-567890ABCDEF]@0xffffff7f80c1a000->0xffffff7f80d2cfff

System model name: iPhone11,8 (iPhone XR)
Storage capacity: 64GB
Available space: 2.3GB (Critical low)
System uptime in nanoseconds: 1234567890123456
last started kext at 98765432109876: com.apple.driver.usb.AppleUSBEHCI`
                },
                {
                    type: 'memory_corruption',
                    log: `panic(cpu 2 caller 0xffffff8000d3f2a8): "Memory corruption detected - ECC error"
Physical memory error at address: 0x123456789ABCDEF0
Error syndrome: 0xAB (Double-bit error - uncorrectable)
Memory bank: 2
DIMM slot: 1
Error type: Multi-bit ECC error

Memory statistics:
- Total RAM: 4GB
- Available RAM: 1.2GB
- Memory pressure: 85% (Critical)
- Page faults: 12,456,789
- Swap used: 2.1GB

ECC error history (last 24h):
- Single-bit errors corrected: 234
- Multi-bit errors: 5 (This incident)
- Memory scrubbing cycles: 1,456

Backtrace (CPU 2), Frame : Return Address
0xffffff920c7d4f20 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920c7d4f70 : 0xffffff8000b6c274 mach_kernel : _memory_error_handler + 0x274

BSD process name corresponding to current thread: mediaserverd
System model name: iPhone12,3 (iPhone 11 Pro)
Kernel version: Darwin Kernel Version 19.6.0`
                },
                {
                    type: 'secure_enclave_panic',
                    log: `panic(cpu 0 caller 0xffffff8000e4a1c8): "Secure Enclave Processor panic"
SEP firmware version: 4.0.0.0.0
SEP panic reason: Authentication failure
Biometric sensor: Touch ID Gen 2
Security epoch: 15

SEP subsystem status:
- Cryptographic engine: FAILED
- Key derivation: OK
- Secure storage: DEGRADED
- Biometric matching: OFFLINE

Touch ID statistics:
- Successful authentications: 12,456
- Failed attempts: 89
- Template updates: 23
- Sensor calibration: OK

Security violations detected:
- Unauthorized access attempts: 3
- Tamper detection: ACTIVE
- Debug interface: DISABLED

Backtrace (CPU 0), Frame : Return Address
0xffffff920a1b2c30 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920a1b2c80 : 0xffffff8000e4a1c8 mach_kernel : _sep_panic_handler + 0x1c8

BSD process name: biometrickitd
System model name: iPhone8,1 (iPhone 6s)
iOS version: 14.8.1 (18H107)`
                }
            ];

            return panicTypes[Math.floor(Math.random() * panicTypes.length)].log;
        }

                // Hi·ªÉn th·ªã preview ·∫£nh v·ªõi effects
        function displayImagePreviewWithEffects(src) {
            const preview = document.createElement('div');
            preview.style.position = 'relative';
            preview.style.display = 'inline-block';
            preview.style.borderRadius = '15px';
            preview.style.overflow = 'hidden';
            preview.style.margin = '20px 0';
            preview.style.boxShadow = '0 15px 30px rgba(0,0,0,0.2)';
            
            const img = document.createElement('img');
            img.src = src;
            img.className = 'image-preview';
            img.style.transition = 'transform 0.3s ease';
            
            const scanLine = document.createElement('div');
            scanLine.className = 'scan-line';
            
            preview.appendChild(img);
            preview.appendChild(scanLine);
            
            const container = document.getElementById('imageUploadZone');
            const existingPreview = container.querySelector('.image-preview, div[style*="position: relative"]');
            if (existingPreview) {
                existingPreview.remove();
            }
            container.appendChild(preview);
            
            // Th√™m hover effect
            preview.addEventListener('mouseenter', () => {
                img.style.transform = 'scale(1.05)';
            });
            
            preview.addEventListener('mouseleave', () => {
                img.style.transform = 'scale(1)';
            });
        }

        // Ph√¢n t√≠ch n·ªôi dung text
        function analyzeTextContent(content, filename) {
            const foundErrors = [];
            
            // T√¨m ki·∫øm patterns trong database
            for (const [errorKey, errorData] of Object.entries(errorDatabase)) {
                for (const pattern of errorData.patterns) {
                    if (content.toLowerCase().includes(pattern.toLowerCase())) {
                        foundErrors.push({
                            key: errorKey,
                            data: errorData,
                            confidence: calculateConfidence(content, pattern),
                            filename: filename,
                            context: extractContext(content, pattern)
                        });
                        break;
                    }
                }
            }
            
            // L∆∞u k·∫øt qu·∫£
            analysisResults.push({
                filename: filename,
                content: content,
                errors: foundErrors,
                timestamp: new Date()
            });
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            displayAnalysisResults();
            updateErrorCounts();
            autoSaveResults();
        }

        // Tr√≠ch xu·∫•t context xung quanh pattern
        function extractContext(content, pattern) {
            const index = content.toLowerCase().indexOf(pattern.toLowerCase());
            if (index === -1) return '';
            
            const start = Math.max(0, index - 200);
            const end = Math.min(content.length, index + pattern.length + 200);
            return content.substring(start, end);
        }

        // T√≠nh to√°n ƒë·ªô tin c·∫≠y
        function calculateConfidence(content, pattern) {
            const occurrences = (content.toLowerCase().match(new RegExp(pattern.toLowerCase(), 'g')) || []).length;
            const contentLength = content.length;
            const patternLength = pattern.length;
            
            // C√¥ng th·ª©c t√≠nh confidence ƒë∆°n gi·∫£n
            let confidence = Math.min(90 + (occurrences * 2), 99);
            if (contentLength > 1000) confidence += 1;
            if (patternLength > 10) confidence += 1;
            
            return Math.round(confidence);
        }

        // L·∫•y m√†u severity
        function getSeverityColor(severity) {
            const colors = {
                'critical': '#e53e3e',
                'high': '#dd6b20',
                'medium': '#d69e2e',
                'low': '#38a169'
            };
            return colors[severity] || '#a0aec0';
        }

        // L·∫•y m√†u severity nh·∫°t h∆°n
        function getSeverityColorLight(severity) {
            const colors = {
                'critical': '#fc8181',
                'high': '#f6ad55',
                'medium': '#f6e05e',
                'low': '#68d391'
            };
            return colors[severity] || '#a0aec0';
        }

        // L·∫•y text m·ª©c ƒë·ªô nghi√™m tr·ªçng
        function getSeverityText(severity) {
            const severityMap = {
                'critical': 'C·ª±c k·ª≥ nghi√™m tr·ªçng',
                'high': 'Nghi√™m tr·ªçng',
                'medium': 'Trung b√¨nh',
                'low': 'Th·∫•p'
            };
            return severityMap[severity] || 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // L·∫•y text ƒë·ªô tin c·∫≠y
        function getConfidenceText(confidence) {
            if (confidence >= 95) return 'R·∫•t ch√≠nh x√°c';
            if (confidence >= 85) return 'Ch√≠nh x√°c cao';
            if (confidence >= 75) return 'Ch√≠nh x√°c';
            if (confidence >= 65) return 'Kh√° ch√≠nh x√°c';
            return 'C·∫ßn xem x√©t';
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£ ph√¢n t√≠ch
        function displayAnalysisResults() {
            const container = document.getElementById('resultsContainer');
            const resultsDiv = document.getElementById('analysisResults');
            
            container.style.display = 'block';
            resultsDiv.innerHTML = '';
            
            analysisResults.forEach((result, index) => {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'panic-analysis fade-in';
                
                let errorsHtml = '';
                if (result.errors.length > 0) {
                    result.errors.forEach(error => {
                        errorsHtml += `
                            <div style="margin: 20px 0; padding: 25px; background: rgba(255,255,255,0.9); border-radius: 20px; border-left: 5px solid ${getSeverityColor(error.data.severity)}; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                                <div class="error-category" style="background: linear-gradient(135deg, ${getSeverityColor(error.data.severity)}, ${getSeverityColorLight(error.data.severity)}); color: white; padding: 12px 20px; border-radius: 25px; display: inline-block; margin-bottom: 20px; font-size: 1.1em;">
                                    ${error.data.vietnameseName}
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <div style="margin: 15px 0;">
                                        <span class="severity-indicator severity-${error.data.severity}"></span>
                                        <strong>M·ª©c ƒë·ªô nghi√™m tr·ªçng:</strong> ${getSeverityText(error.data.severity)}
                                    </div>
                                    <div class="confidence-meter" style="text-align: right;">
                                        <div style="font-weight: bold; margin-bottom: 5px;">ƒê·ªô ch√≠nh x√°c AI: ${error.confidence}%</div>
                                        <div class="confidence-bar" style="width: 200px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                                            <div class="confidence-fill" style="width: ${error.confidence}%; height: 100%; background: linear-gradient(90deg, #38a169, #48bb78); border-radius: 4px; transition: width 1s ease;"></div>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">${getConfidenceText(error.confidence)}</div>
                                    </div>
                                </div>
                                
                                <div style="margin: 15px 0; padding: 15px; background: #f7fafc; border-radius: 10px;">
                                    <strong>üìã M√¥ t·∫£ chi ti·∫øt:</strong><br>
                                    <span style="color: #4a5568;">${error.data.description}</span>
                                </div>
                                
                                ${displayDetailedErrorInfo(error)}
                                
                                <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #edf2f7, #f7fafc); border-radius: 10px; border: 1px solid #e2e8f0;">
                                    <details style="cursor: pointer;">
                                        <summary style="font-weight: bold; color: #2d3748; margin-bottom: 10px;">üîç Log Context (Click ƒë·ªÉ xem)</summary>
                                        <div style="background: #1a202c; color: #e2e8f0; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; margin-top: 10px; max-height: 200px; overflow-y: auto;">
                                            ${error.context ? error.context.substring(0, 500) + (error.context.length > 500 ? '...' : '') : 'Kh√¥ng c√≥ context'}
                                        </div>
                                    </details>
                                </div>
                                
                                <div style="margin-top: 20px; text-align: center;">
                                    <button onclick="showRepairGuide('${error.key}')" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: transform 0.2s;">
                                        üõ†Ô∏è H∆∞·ªõng D·∫´n S·ª≠a Ch·ªØa Chi Ti·∫øt
                                    </button>
                                    <button onclick="showDiagnosticSteps('${error.key}')" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: transform 0.2s;">
                                        üî¨ Quy Tr√¨nh Ch·∫©n ƒêo√°n
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    errorsHtml = `
                        <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, #f0fff4, #c6f6d5); border-radius: 20px; margin: 20px 0;">
                            <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                            <h3 style="color: #38a169; margin-bottom: 15px;">Kh√¥ng ph√°t hi·ªán l·ªói panic nghi√™m tr·ªçng</h3>
                            <p style="color: #2f855a; font-size: 1.1em;">Panic log n√†y c√≥ th·ªÉ do l·ªói ph·∫ßn m·ªÅm t·∫°m th·ªùi ho·∫∑c c·∫ßn ph√¢n t√≠ch s√¢u h∆°n b·ªüi chuy√™n gia.</p>
                            <div style="margin-top: 20px;">
                                <button onclick="showGeneralDiagnostic()" style="background: linear-gradient(135deg, #38a169, #48bb78); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                                    üîç Ch·∫©n ƒêo√°n T·ªïng Qu√°t
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = `
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.4em;">üìÑ Ph√¢n t√≠ch file: ${result.filename}</h3>
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.95em; opacity: 0.9;">
                            <div>
                                <span style="margin-right: 20px;">üîç T√¨m th·∫•y: <strong>${result.errors.length}</strong> v·∫•n ƒë·ªÅ</span>
                                <span>‚è∞ Th·ªùi gian: ${result.timestamp.toLocaleString('vi-VN')}</span>
                            </div>
                            <div>
                                <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 15px;">
                                    üìä ƒê·ªô tin c·∫≠y trung b√¨nh: ${result.errors.length > 0 ? Math.round(result.errors.reduce((sum, e) => sum + e.confidence, 0) / result.errors.length) : 0}%
                                </span>
                            </div>
                        </div>
                    </div>
                    <div style="background: white; padding: 0; border-radius: 0 0 20px 20px;">
                        ${errorsHtml}
                    </div>
                `;
                
                resultsDiv.appendChild(resultDiv);
            });
            
            // Th√™m summary report n·∫øu c√≥ l·ªói
            if (analysisResults.some(result => result.errors.length > 0)) {
                addAdvancedSummaryReport();
            }
        }

        // Hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt v·ªÅ linh ki·ªán v√† c√°ch s·ª≠a
        function displayDetailedErrorInfo(error) {
            const data = error.data;
            return `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 15px 0;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üîß Linh Ki·ªán L·ªói:</h5>
                            <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #667eea;">
                                <strong>${data.component || 'Kh√¥ng x√°c ƒë·ªãnh'}</strong>
                                <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                                    üìç V·ªã tr√≠: ${data.location || 'Kh√¥ng x√°c ƒë·ªãnh'}
                                </div>
                            </div>
                        </div>
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üîç Tri·ªáu Ch·ª©ng:</h5>
                            <div style="background: #fff3cd; padding: 15px; border-radius: 10px;">
                                ${data.symptoms ? data.symptoms.map(symptom => `‚Ä¢ ${symptom}`).join('<br>') : 'Kh√¥ng c√≥ th√¥ng tin'}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">‚ö†Ô∏è Nguy√™n Nh√¢n:</h5>
                            <div style="background: #f8d7da; padding: 15px; border-radius: 10px;">
                                ${data.causes ? data.causes.map(cause => `‚Ä¢ ${cause}`).join('<br>') : 'Kh√¥ng c√≥ th√¥ng tin'}
                            </div>
                        </div>
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üõ†Ô∏è Gi·∫£i Ph√°p:</h5>
                            <div style="background: #d1ecf1; padding: 15px; border-radius: 10px;">
                                ${data.repairSolution ? data.repairSolution.map((solution, idx) => `${idx + 1}. ${solution}`).join('<br>') : 'C·∫ßn ch·∫©n ƒëo√°n th√™m'}
                            </div>
                        </div>
                    </div>
                    
                    ${data.diagnosis ? `
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üî¨ C√°c B∆∞·ªõc Ch·∫©n ƒêo√°n:</h5>
                            <div style="background: #e7f3ff; padding: 15px; border-radius: 10px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div><strong>B∆∞·ªõc 1:</strong> ${data.diagnosis.step1}</div>
                                    <div><strong>B∆∞·ªõc 2:</strong> ${data.diagnosis.step2}</div>
                                    <div><strong>B∆∞·ªõc 3:</strong> ${data.diagnosis.step3}</div>
                                    <div><strong>B∆∞·ªõc 4:</strong> ${data.diagnosis.step4}</div>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Th√™m b√°o c√°o t·ªïng h·ª£p n√¢ng cao
        function addAdvancedSummaryReport() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const severityStats = {};
            const componentStats = {};
            const categoryStats = {};
            
            allErrors.forEach(error => {
                severityStats[error.data.severity] = (severityStats[error.data.severity] || 0) + 1;
                componentStats[error.data.component] = (componentStats[error.data.component] || 0) + 1;
                categoryStats[error.data.category] = (categoryStats[error.data.category] || 0) + 1;
            });
            
            const criticalCount = severityStats.critical || 0;
            const highCount = severityStats.high || 0;
            const avgConfidence = allErrors.length > 0 ? Math.round(allErrors.reduce((sum, e) => sum + e.confidence, 0) / allErrors.length) : 0;
            
            const summaryDiv = document.createElement('div');
            summaryDiv.style.cssText = `
                background: linear-gradient(135deg, #2d3748, #4a5568);
                color: white;
                padding: 40px;
                border-radius: 25px;
                margin: 30px 0;
                box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            `;
            
            summaryDiv.innerHTML = `
                <div style="text-align: center; margin-bottom: 40px;">
                    <h2 style="margin: 0 0 15px 0; font-size: 2.5em;">üìä B√°o C√°o T·ªïng H·ª£p AI</h2>
                    <p style="font-size: 1.2em; opacity: 0.9;">Ph√¢n t√≠ch t·ªïng th·ªÉ t·ª´ ${analysisResults.length} file v·ªõi ${allErrors.length} l·ªói ƒë∆∞·ª£c ph√°t hi·ªán</p>
                </div>
                
                <!-- Th·ªëng k√™ ch√≠nh -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 40px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #fc8181;">${criticalCount}</div>
                        <div style="opacity: 0.9;">Nghi√™m Tr·ªçng</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #f6ad55;">${highCount}</div>
                        <div style="opacity: 0.9;">M·ª©c Cao</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #68d391;">${avgConfidence}%</div>
                        <div style="opacity: 0.9;">ƒê·ªô Tin C·∫≠y TB</div>
                    </div>
                </div>
                
                <!-- Ph√¢n t√≠ch chi ti·∫øt -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <!-- Ph√¢n b·ªë theo m·ª©c ƒë·ªô -->
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px;">
                        <h3 style="margin: 0 0 20px 0; text-align: center;">üö® Ph√¢n B·ªë M·ª©c ƒê·ªô Nghi√™m Tr·ªçng</h3>
                        ${Object.entries(severityStats)
                            .sort(([,a], [,b]) => b - a)
                            .map(([severity, count]) => {
                                const percentage = Math.round((count / allErrors.length) * 100);
                                return `
                                    <div style="margin: 15px 0;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                            <span style="display: flex; align-items: center;">
                                                <span class="severity-indicator severity-${severity}" style="margin-right: 10px;"></span>
                                                ${getSeverityText(severity)}
                                            </span>
                                            <span style="font-weight: bold;">${count} (${percentage}%)</span>
                                        </div>
                                        <div style="background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px; overflow: hidden;">
                                            <div style="background: ${getSeverityColor(severity)}; height: 100%; width: ${percentage}%; transition: width 1s ease; border-radius: 10px;"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                    </div>
                    
                    <!-- Top linh ki·ªán b·ªã l·ªói -->
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px;">
                        <h3 style="margin: 0 0 20px 0; text-align: center;">üîß Linh Ki·ªán B·ªã ·∫¢nh H∆∞·ªüng Nhi·ªÅu Nh·∫•t</h3>
                        ${Object.entries(componentStats)
                            .sort(([,a], [,b]) => b - a)
                            .slice(0, 5)
                            .map(([component, count], idx) => `
                                <div style="margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                    <div style="display: flex; align-items: center; justify-content: space-between;">
                                        <div style="display: flex; align-items: center;">
                                            <span style="background: ${['#e53e3e', '#f6ad55', '#4299e1', '#38a169', '#805ad5'][idx]}; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold;">${idx + 1}</span>
                                            <span style="font-size: 0.95em; line-height: 1.3;">${component}</span>
                                        </div>
                                        <span style="background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 15px; font-weight: bold;">${count}</span>
                                    </div>
                                </div>
                            `).join('')}
                    </div>
                </div>
                
                <!-- Khuy·∫øn ngh·ªã ∆∞u ti√™n -->
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 20px 0; text-align: center;">üí° Khuy·∫øn Ngh·ªã ∆Øu Ti√™n S·ª≠a Ch·ªØa</h3>
                    ${generatePriorityRecommendations(allErrors)}
                </div>
                
                <!-- Action buttons -->
                <div style="text-align: center; margin-top: 30px;">
    <button onclick="clearAllHistory()" style="background: rgba(220, 38, 38, 0.8); border: 2px solid rgba(220, 38, 38, 0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: all 0.3s;">
        üóëÔ∏è X√≥a T·∫•t C·∫£ L·ªãch S·ª≠
    </button>
    <button onclick="exportDetailedReport()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: all 0.3s;">
        üìä Xu·∫•t B√°o C√°o Chi Ti·∫øt
    </button>

                    <button onclick="showRepairPriorityGuide()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: all 0.3s;">
                        üõ†Ô∏è H∆∞·ªõng D·∫´n ∆Øu Ti√™n S·ª≠a Ch·ªØa
                    </button>
                    <button onclick="showCostEstimate()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px; transition: all 0.3s;">
                        üí∞ ∆Ø·ªõc T√≠nh Chi Ph√≠
                    </button>
                </div>
            `;
            
            const resultsDiv = document.getElementById('analysisResults');
            resultsDiv.appendChild(summaryDiv);
        }

        // T·∫°o khuy·∫øn ngh·ªã ∆∞u ti√™n
        function generatePriorityRecommendations(errors) {
            const criticalErrors = errors.filter(e => e.data.severity === 'critical');
            const highErrors = errors.filter(e => e.data.severity === 'high');
            const mediumErrors = errors.filter(e => e.data.severity === 'medium');
            
            let recommendations = '';
            
            if (criticalErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(229, 62, 62, 0.2); border-left: 5px solid #e53e3e; border-radius: 10px;">
                        <h4 style="color: #e53e3e; margin: 0 0 15px 0; display: flex; align-items: center;">
                            üö® KH·∫®N C·∫§P - C·∫ßn s·ª≠a ch·ªØa ngay l·∫≠p t·ª©c
                        </h4>
                        <div style="display: grid; gap: 10px;">
                            ${criticalErrors.slice(0, 3).map((error, idx) => `
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between;">
                                    <div>
                                        <div style="font-weight: bold; margin-bottom: 5px;">${error.data.vietnameseName}</div>
                                        <div style="font-size: 0.9em; opacity: 0.8;">Linh ki·ªán: ${error.data.component}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 0.9em; opacity: 0.8;">ƒê·ªô tin c·∫≠y</div>
                                        <div style="font-weight: bold;">${error.confidence}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        ${criticalErrors.length > 3 ? `<div style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">... v√† ${criticalErrors.length - 3} l·ªói nghi√™m tr·ªçng kh√°c</div>` : ''}
                    </div>
                `;
            }
            
            if (highErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(246, 173, 85, 0.2); border-left: 5px solid #f6ad55; border-radius: 10px;">
                        <h4 style="color: #c05621; margin: 0 0 15px 0; display: flex; align-items: center;">
                            ‚ö†Ô∏è CAO - N√™n s·ª≠a ch·ªØa trong tu·∫ßn n√†y
                        </h4>
                        <div style="display: grid; gap: 10px;">
                            ${highErrors.slice(0, 3).map((error, idx) => `
                                                              <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between;">
                                    <div>
                                        <div style="font-weight: bold; margin-bottom: 5px;">${error.data.vietnameseName}</div>
                                        <div style="font-size: 0.9em; opacity: 0.8;">Linh ki·ªán: ${error.data.component}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 0.9em; opacity: 0.8;">ƒê·ªô tin c·∫≠y</div>
                                        <div style="font-weight: bold;">${error.confidence}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        ${highErrors.length > 3 ? `<div style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">... v√† ${highErrors.length - 3} l·ªói m·ª©c cao kh√°c</div>` : ''}
                    </div>
                `;
            }
            
            if (mediumErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(214, 158, 46, 0.2); border-left: 5px solid #d69e2e; border-radius: 10px;">
                        <h4 style="color: #b7791f; margin: 0 0 15px 0; display: flex; align-items: center;">
                            üìã TRUNG B√åNH - Theo d√µi v√† l√™n k·∫ø ho·∫°ch s·ª≠a ch·ªØa
                        </h4>
                        <div style="font-size: 0.95em; opacity: 0.9;">
                            C√≥ ${mediumErrors.length} l·ªói m·ª©c trung b√¨nh c·∫ßn ƒë∆∞·ª£c theo d√µi. N√™n ki·ªÉm tra ƒë·ªãnh k·ª≥ v√† s·ª≠a ch·ªØa khi c√≥ th·ªùi gian.
                        </div>
                    </div>
                `;
            }
            
            return recommendations || '<div style="text-align: center; color: #68d391; font-size: 1.1em;">‚úÖ Kh√¥ng c√≥ l·ªói nghi√™m tr·ªçng n√†o c·∫ßn ∆∞u ti√™n!</div>';
        }

        // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n s·ª≠a ch·ªØa chi ti·∫øt
        function showRepairGuide(errorKey) {
            const errorData = errorDatabase[errorKey];
            if (!errorData) return;
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; max-width: 800px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h2 style="margin: 0;">üõ†Ô∏è H∆∞·ªõng D·∫´n S·ª≠a Ch·ªØa Chi Ti·∫øt</h2>
                        <h3 style="margin: 10px 0 0 0; opacity: 0.9;">${errorData.vietnameseName}</h3>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px;">√ó</button>
                    </div>
                    <div style="padding: 30px;">
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üîß Linh Ki·ªán C·∫ßn S·ª≠a:</h4>
                            <div style="background: #f7fafc; padding: 20px; border-radius: 15px; border-left: 5px solid #667eea;">
                                <div style="font-size: 1.2em; font-weight: bold; color: #2d3748; margin-bottom: 10px;">${errorData.component}</div>
                                <div style="color: #4a5568;">üìç V·ªã tr√≠: ${errorData.location}</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üîç Tri·ªáu Ch·ª©ng C·∫ßn Ch√∫ √ù:</h4>
                            <div style="background: #fff5f5; padding: 20px; border-radius: 15px; border-left: 5px solid #f56565;">
                                ${errorData.symptoms ? errorData.symptoms.map((symptom, idx) => `
                                    <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 8px; display: flex; align-items: center;">
                                        <span style="background: #f56565; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 12px; font-weight: bold;">${idx + 1}</span>
                                        ${symptom}
                                    </div>
                                `).join('') : 'Kh√¥ng c√≥ th√¥ng tin tri·ªáu ch·ª©ng'}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">‚ö†Ô∏è Nguy√™n Nh√¢n C√≥ Th·ªÉ:</h4>
                            <div style="background: #fffbf0; padding: 20px; border-radius: 15px; border-left: 5px solid #f6ad55;">
                                ${errorData.causes ? errorData.causes.map((cause, idx) => `
                                    <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 8px; display: flex; align-items: center;">
                                        <span style="background: #f6ad55; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 12px; font-weight: bold;">${idx + 1}</span>
                                        ${cause}
                                    </div>
                                `).join('') : 'C·∫ßn ch·∫©n ƒëo√°n th√™m'}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üõ†Ô∏è C√°c B∆∞·ªõc S·ª≠a Ch·ªØa (Theo ƒê·ªô ∆Øu Ti√™n):</h4>
                            <div style="background: #f0fff4; padding: 20px; border-radius: 15px; border-left: 5px solid #48bb78;">
                                ${errorData.repairSolution ? errorData.repairSolution.map((solution, idx) => `
                                    <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                            <span style="background: ${idx === 0 ? '#e53e3e' : idx === 1 ? '#f6ad55' : '#48bb78'}; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold;">${idx + 1}</span>
                                            <span style="font-weight: bold; color: #2d3748;">${idx === 0 ? '∆Øu ti√™n cao' : idx === 1 ? '∆Øu ti√™n trung b√¨nh' : '∆Øu ti√™n th·∫•p'}</span>
                                        </div>
                                        <div style="margin-left: 45px; color: #4a5568;">${solution}</div>
                                    </div>
                                `).join('') : 'C·∫ßn tham kh·∫£o chuy√™n gia'}
                            </div>
                        </div>
                        
                        <div style="background: #e6fffa; padding: 20px; border-radius: 15px; border-left: 5px solid #38b2ac;">
                            <h4 style="color: #234e52; margin-bottom: 15px;">üí° L∆∞u √ù Quan Tr·ªçng:</h4>
                            <ul style="color: #285e61; margin-left: 20px;">
                                <li>Lu√¥n backup d·ªØ li·ªáu tr∆∞·ªõc khi s·ª≠a ch·ªØa</li>
                                <li>S·ª≠ d·ª•ng linh ki·ªán ch√≠nh h√£ng ho·∫∑c t∆∞∆°ng th√≠ch</li>
                                <li>Ki·ªÉm tra b·∫£o h√†nh tr∆∞·ªõc khi can thi·ªáp</li>
                                <li>N·∫øu kh√¥ng ch·∫Øc ch·∫Øn, h√£y tham kh·∫£o chuy√™n gia</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            // Click outside to close
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Hi·ªÉn th·ªã c√°c b∆∞·ªõc ch·∫©n ƒëo√°n
        function showDiagnosticSteps(errorKey) {
            const errorData = errorDatabase[errorKey];
            if (!errorData || !errorData.diagnosis) return;
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; max-width: 700px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h2 style="margin: 0;">üî¨ Quy Tr√¨nh Ch·∫©n ƒêo√°n</h2>
                        <h3 style="margin: 10px 0 0 0; opacity: 0.9;">${errorData.vietnameseName}</h3>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px;">√ó</button>
                    </div>
                    <div style="padding: 30px;">
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üéØ M·ª•c Ti√™u Ch·∫©n ƒêo√°n:</h4>
                            <div style="background: #e6fffa; padding: 15px; border-radius: 10px; color: #234e52;">
                                X√°c ƒë·ªãnh ch√≠nh x√°c nguy√™n nh√¢n g√¢y ra l·ªói <strong>${errorData.vietnameseName}</strong> v√† ƒë∆∞a ra ph∆∞∆°ng √°n s·ª≠a ch·ªØa ph√π h·ª£p.
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üìã C√°c B∆∞·ªõc Ch·∫©n ƒêo√°n Chi Ti·∫øt:</h4>
                            ${Object.entries(errorData.diagnosis).map(([step, description], idx) => `
                                <div style="margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #f7fafc, #edf2f7); border-radius: 15px; border-left: 5px solid #4299e1;">
                                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                        <div style="background: #4299e1; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold; font-size: 1.1em;">${idx + 1}</div>
                                        <h5 style="color: #2d3748; margin: 0; text-transform: capitalize;">${step.replace('step', 'B∆∞·ªõc ')}</h5>
                                    </div>
                                    <div style="margin-left: 55px; color: #4a5568; font-size: 1.05em;">${description}</div>
                                    <div style="margin: 15px 0 0 55px;">
                                        <div style="background: white; padding: 10px 15px; border-radius: 8px; border: 1px solid #e2e8f0; font-size: 0.9em; color: #666;">
                                            üí° <strong>M·∫πo:</strong> ${getDiagnosticTip(step, errorKey)}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="background: #fff5f5; padding: 20px; border-radius: 15px; border-left: 5px solid #f56565;">
                            <h4 style="color: #742a2a; margin-bottom: 15px;">‚ö†Ô∏è L∆∞u √ù An To√†n:</h4>
                            <ul style="color: #742a2a; margin-left: 20px;">
                                <li>T·∫Øt ngu·ªìn thi·∫øt b·ªã tr∆∞·ªõc khi ki·ªÉm tra ph·∫ßn c·ª©ng</li>
                                <li>S·ª≠ d·ª•ng thi·∫øt b·ªã ƒëo l∆∞·ªùng ch√≠nh x√°c</li>
                                <li>Ghi l·∫°i t·∫•t c·∫£ k·∫øt qu·∫£ ƒëo ƒë·ªÉ so s√°nh</li>
                                <li>Kh√¥ng th·ª±c hi·ªán n·∫øu thi·∫øu kinh nghi·ªám</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            // Click outside to close
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // L·∫•y m·∫πo ch·∫©n ƒëo√°n cho t·ª´ng b∆∞·ªõc
        function getDiagnosticTip(step, errorKey) {
            const tips = {
                'step1': 'S·ª≠ d·ª•ng multimeter ch√≠nh x√°c v√† ki·ªÉm tra ·ªü nhi·ªÅu ƒëi·ªÅu ki·ªán kh√°c nhau',
                'step2': 'So s√°nh v·ªõi thi·∫øt b·ªã t∆∞∆°ng t·ª± ƒë·ªÉ x√°c ƒë·ªãnh s·ª± kh√°c bi·ªát',
                'step3': 'Ghi l·∫°i t·∫•t c·∫£ gi√° tr·ªã ƒëo ƒë∆∞·ª£c ƒë·ªÉ ph√¢n t√≠ch sau',
                'step4': 'Ki·ªÉm tra c·∫£ trong ƒëi·ªÅu ki·ªán b√¨nh th∆∞·ªùng v√† stress test'
            };
            return tips[step] || 'Th·ª±c hi·ªán c·∫©n th·∫≠n v√† ghi l·∫°i k·∫øt qu·∫£';
        }

        // Hi·ªÉn th·ªã ch·∫©n ƒëo√°n t·ªïng qu√°t
        function showGeneralDiagnostic() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; max-width: 600px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #38a169, #48bb78); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h2 style="margin: 0;">üîç Ch·∫©n ƒêo√°n T·ªïng Qu√°t</h2>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px;">√ó</button>
                    </div>
                    <div style="padding: 30px;">
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üìã Checklist Ch·∫©n ƒêo√°n C∆° B·∫£n:</h4>
                            <div style="space-y: 10px;">
                                ${[
                                    'Ki·ªÉm tra phi√™n b·∫£n iOS v√† update log',
                                    'Xem l·∫°i c√°c app ƒë∆∞·ª£c c√†i ƒë·∫∑t g·∫ßn ƒë√¢y',
                                    'Ki·ªÉm tra dung l∆∞·ª£ng l∆∞u tr·ªØ c√≤n l·∫°i',
                                    'Test ·ªü Safe Mode (n·∫øu c√≥ jailbreak)',
                                    'Ki·ªÉm tra nhi·ªát ƒë·ªô thi·∫øt b·ªã',
                                    'Test v·ªõi factory reset (backup tr∆∞·ªõc)',
                                    'Ki·ªÉm tra ph·∫ßn c·ª©ng c∆° b·∫£n (m√†n h√¨nh, c·∫£m ·ª©ng, √¢m thanh)',
                                    'Ch·∫°y Apple Diagnostics n·∫øu c√≥ th·ªÉ'
                                ].map((item, idx) => `
                                    <label style="display: flex; align-items: center; padding: 12px; background: #f7fafc; border-radius: 8px; margin: 8px 0; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#edf2f7'" onmouseout="this.style.background='#f7fafc'">
                                        <input type="checkbox" style="margin-right: 12px; transform: scale(1.2);">
                                        <span style="color: #4a5568;">${item}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div style="background: #e6fffa; padding: 20px; border-radius: 15px;">
                            <h4 style="color: #234e52; margin-bottom: 15px;">üí° Khuy·∫øn Ngh·ªã:</h4>
                            <p style="color: #285e61; line-height: 1.6;">
                                N·∫øu kh√¥ng t√¨m th·∫•y l·ªói c·ª• th·ªÉ trong panic log, c√≥ th·ªÉ ƒë√¢y l√† l·ªói ph·∫ßn m·ªÅm t·∫°m th·ªùi. 
                                H√£y th·ª±c hi·ªán c√°c b∆∞·ªõc ch·∫©n ƒëo√°n c∆° b·∫£n tr√™n v√† theo d√µi thi·∫øt b·ªã trong v√†i ng√†y t·ªõi.
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            // Click outside to close
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng file text
        function updateTextFileCount() {
            const textCount = analysisResults.filter(r => !r.filename.includes('AI Vision')).length;
            document.getElementById('textFiles').textContent = textCount;
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng file ·∫£nh
        function updateImageFileCount() {
            const imageCount = analysisResults.filter(r => r.filename.includes('AI Vision')).length;
            document.getElementById('imageFiles').textContent = imageCount;
        }

        // C·∫≠p nh·∫≠t ƒë·ªô ch√≠nh x√°c AI
        function updateAIAccuracy() {
            const aiResults = analysisResults.filter(r => r.filename.includes('AI Vision'));
            if (aiResults.length > 0) {
                const avgConfidence = aiResults.reduce((sum, result) => {
                    const avgErrorConfidence = result.errors.length > 0 
                        ? result.errors.reduce((s, e) => s + e.confidence, 0) / result.errors.length
                        : 85;
                    return sum + avgErrorConfidence;
                }, 0) / aiResults.length;
                
                document.getElementById('aiAccuracy').textContent = Math.round(avgConfidence) + '%';
            }
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng l·ªói
        function updateErrorCounts() {
            const totalErrors = analysisResults.reduce((sum, result) => sum + result.errors.length, 0);
            document.getElementById('textErrors').textContent = totalErrors;
        }

        // Hi·ªÉn th·ªã database l·ªói
        function displayErrorDatabase() {
            const container = document.getElementById('errorDatabase');
            container.innerHTML = '';
            
            const filteredErrors = Object.entries(errorDatabase).filter(([key, data]) => {
                if (currentFilter === 'all') return true;
                return data.category === currentFilter;
            });
            
            filteredErrors.forEach(([key, data]) => {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-item';
                errorDiv.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 8px;">
                        <span class="severity-indicator severity-${data.severity}"></span>
                        ${data.vietnameseName}
                    </div>
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 8px;">
                        Danh m·ª•c: ${getCategoryText(data.category)} | M·ª©c ƒë·ªô: ${getSeverityText(data.severity)}
                    </div>
                    <div style="font-size: 0.9em; color: #555;">
                        ${data.description}
                    </div>
                    <div style="font-size: 0.8em; color: #888; margin-top: 8px;">
                        Patterns: ${data.patterns.join(', ')}
                    </div>
                `;
                
                errorDiv.addEventListener('click', () => {
                    // Highlight selected error
                    document.querySelectorAll('.error-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    errorDiv.classList.add('selected');
                });
                
                container.appendChild(errorDiv);
            });
        }

        // L·∫•y text danh m·ª•c
        function getCategoryText(category) {
            const categoryMap = {
                'hardware': 'Ph·∫ßn c·ª©ng',
                'software': 'Ph·∫ßn m·ªÅm',
                'thermal': 'Nhi·ªát ƒë·ªô',
                'power': 'Ngu·ªìn',
                'memory': 'B·ªô nh·ªõ',
                'sensor': 'C·∫£m bi·∫øn'
            };
            return categoryMap[category] || category;
        }

        // L·ªçc theo danh m·ª•c
        function filterByCategory(category) {
            currentFilter = category;
            
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            displayErrorDatabase();
        }

        // X·ª≠ l√Ω t√¨m ki·∫øm
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase();
            const errorItems = document.querySelectorAll('.error-item');
            
            errorItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    item.style.display = 'block';
                    // Highlight search term
                    if (searchTerm) {
                        item.style.background = 'linear-gradient(135deg, #fff5f5, #fed7d7)';
                    } else {
                        item.style.background = '';
                    }
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
        function showSuccessNotification(message) {
            const notification = document.createElement('div');
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.background = 'linear-gradient(135deg, #48bb78, #68d391)';
            notification.style.color = 'white';
            notification.style.padding = '15px 25px';
            notification.style.borderRadius = '25px';
            notification.style.boxShadow = '0 15px 30px rgba(72, 187, 120, 0.4)';
            notification.style.zIndex = '10000';
            notification.style.animation = 'slideInRight 0.5s ease';
            notification.innerHTML = `
                <div style="display: flex; align-items: center;">
                    <span style="font-size: 1.2em; margin-right: 10px;">‚úÖ</span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Export functionality
        function exportResults() {
            const results = {
                timestamp: new Date().toISOString(),
                totalFiles: analysisResults.length,
                totalErrors: analysisResults.reduce((sum, result) => sum + result.errors.length, 0),
                results: analysisResults.map(result => ({
                    filename: result.filename,
                    errors: result.errors.map(error => ({
                        name: error.data.vietnameseName,
                        severity: error.data.severity,
                        confidence: error.confidence,
                        description: error.data.description
                    })),
                    timestamp: result.timestamp
                }))
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `panic_log_analysis_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessNotification('K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c xu·∫•t th√†nh c√¥ng!');
        }

        // Auto-save functionality
        function autoSaveResults() {
            if (analysisResults.length > 0) {
                localStorage.setItem('panicLogAnalysis', JSON.stringify({
                    timestamp: new Date().toISOString(),
                    results: analysisResults
                }));
            }
        }

        // Load saved results
        function loadSavedResults() {
            const saved = localStorage.getItem('panicLogAnalysis');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    const timeDiff = new Date() - new Date(data.timestamp);
                    
                    // Ch·ªâ load n·∫øu d·ªØ li·ªáu kh√¥ng qu√° 24h
                    if (timeDiff < 24 * 60 * 60 * 1000) {
                        analysisResults = data.results;
                        displayAnalysisResults();
                        updateTextFileCount();
                        updateImageFileCount();
                        updateAIAccuracy();
                        updateErrorCounts();
                        showSuccessNotification('ƒê√£ kh√¥i ph·ª•c phi√™n l√†m vi·ªác tr∆∞·ªõc!');
                    }
                } catch (e) {
                    console.error('L·ªói khi load d·ªØ li·ªáu ƒë√£ l∆∞u:', e);
                }
            }
        }

        // Th√™m c√°c animation effects
        function addAdvancedEffects() {
            // Th√™m CSS animation cho particles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes float {
                    0%, 100% { 
                        transform: translateY(0px) rotate(0deg); 
                        opacity: 0.7;
                    }
                    50% { 
                        transform: translateY(-20px) rotate(180deg); 
                        opacity: 1;
                    }
                }
                
                               @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(30px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                
                @keyframes slideOutRight {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
                
                .fade-in {
                    animation: fadeIn 0.6s ease-out;
                }
                
                .scan-line {
                    position: absolute;
                    top: 0;
                    left: -100%;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.3), transparent);
                    animation: scanEffect 2s infinite;
                }
                
                @keyframes scanEffect {
                    0% { left: -100%; }
                    100% { left: 100%; }
                }
                
                .error-item.selected {
                    background: linear-gradient(135deg, #e6fffa, #b2f5ea) !important;
                    border-left: 5px solid #38b2ac !important;
                    transform: translateX(10px) !important;
                }
                
                .floating-particles {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    pointer-events: none;
                    z-index: -1;
                }
                
                .particle {
                    position: absolute;
                    background: rgba(102, 126, 234, 0.1);
                    border-radius: 50%;
                    animation: float 6s ease-in-out infinite;
                }
            `;
            document.head.appendChild(style);
            
            // T·∫°o floating particles
            createFloatingParticles();
        }

        // T·∫°o floating particles
        function createFloatingParticles() {
            const particlesContainer = document.createElement('div');
            particlesContainer.className = 'floating-particles';
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = particle.style.height = (Math.random() * 10 + 5) + 'px';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
            
            document.body.appendChild(particlesContainer);
        }

        // Xu·∫•t b√°o c√°o chi ti·∫øt
        function exportDetailedReport() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const severityStats = {};
            const componentStats = {};
            
            allErrors.forEach(error => {
                severityStats[error.data.severity] = (severityStats[error.data.severity] || 0) + 1;
                componentStats[error.data.component] = (componentStats[error.data.component] || 0) + 1;
            });
            
            const report = {
                metadata: {
                    generatedAt: new Date().toISOString(),
                    generatedBy: 'AI Vision Pro Panic Log Analyzer',
                    version: '2.0.0',
                    totalFiles: analysisResults.length,
                    totalErrors: allErrors.length,
                    avgConfidence: allErrors.length > 0 ? Math.round(allErrors.reduce((sum, e) => sum + e.confidence, 0) / allErrors.length) : 0
                },
                summary: {
                    severityBreakdown: severityStats,
                    topComponents: Object.entries(componentStats)
                        .sort(([,a], [,b]) => b - a)
                        .slice(0, 5)
                        .map(([component, count]) => ({ component, count })),
                    recommendations: generateRecommendations(allErrors)
                },
                detailedResults: analysisResults.map(result => ({
                    filename: result.filename,
                    timestamp: result.timestamp,
                    errorCount: result.errors.length,
                    errors: result.errors.map(error => ({
                        vietnameseName: error.data.vietnameseName,
                        englishName: error.key,
                        severity: error.data.severity,
                        confidence: error.confidence,
                        category: error.data.category,
                        component: error.data.component,
                        location: error.data.location,
                        description: error.data.description,
                        symptoms: error.data.symptoms,
                        causes: error.data.causes,
                        repairSolutions: error.data.repairSolution,
                        context: error.context?.substring(0, 200) + '...'
                    }))
                }))
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `detailed_panic_analysis_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessNotification('B√°o c√°o chi ti·∫øt ƒë√£ ƒë∆∞·ª£c xu·∫•t!');
        }

        // T·∫°o khuy·∫øn ngh·ªã
        function generateRecommendations(errors) {
            const recommendations = [];
            const criticalCount = errors.filter(e => e.data.severity === 'critical').length;
            const highCount = errors.filter(e => e.data.severity === 'high').length;
            
            if (criticalCount > 0) {
                recommendations.push({
                    priority: 'URGENT',
                    message: `C√≥ ${criticalCount} l·ªói nghi√™m tr·ªçng c·∫ßn s·ª≠a ch·ªØa ngay l·∫≠p t·ª©c ƒë·ªÉ tr√°nh h∆∞ h·ªèng th√™m.`,
                    action: 'Li√™n h·ªá chuy√™n gia s·ª≠a ch·ªØa trong 24h'
                });
            }
            
            if (highCount > 2) {
                recommendations.push({
                    priority: 'HIGH',
                    message: `Nhi·ªÅu l·ªói m·ª©c cao (${highCount}) cho th·∫•y thi·∫øt b·ªã ƒëang c√≥ v·∫•n ƒë·ªÅ h·ªá th·ªëng.`,
                    action: 'Backup d·ªØ li·ªáu v√† l√™n k·∫ø ho·∫°ch s·ª≠a ch·ªØa trong tu·∫ßn'
                });
            }
            
            const thermalErrors = errors.filter(e => e.data.category === 'thermal').length;
            if (thermalErrors > 0) {
                recommendations.push({
                    priority: 'MEDIUM',
                    message: `Ph√°t hi·ªán ${thermalErrors} l·ªói li√™n quan ƒë·∫øn nhi·ªát ƒë·ªô.`,
                    action: 'Ki·ªÉm tra h·ªá th·ªëng t·∫£n nhi·ªát v√† v·ªá sinh thi·∫øt b·ªã'
                });
            }
            
            return recommendations;
        }

        // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n ∆∞u ti√™n s·ª≠a ch·ªØa
        function showRepairPriorityGuide() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const criticalErrors = allErrors.filter(e => e.data.severity === 'critical');
            const highErrors = allErrors.filter(e => e.data.severity === 'high');
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; max-width: 800px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h2 style="margin: 0;">üõ†Ô∏è H∆∞·ªõng D·∫´n ∆Øu Ti√™n S·ª≠a Ch·ªØa</h2>
                        <p style="margin: 10px 0 0 0; opacity: 0.9;">D·ª±a tr√™n ${allErrors.length} l·ªói ƒë∆∞·ª£c ph√°t hi·ªán</p>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px;">√ó</button>
                    </div>
                    <div style="padding: 30px;">
                        ${criticalErrors.length > 0 ? `
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: #e53e3e; margin-bottom: 20px; display: flex; align-items: center;">
                                    üö® KH·∫®N C·∫§P - S·ª≠a ngay (${criticalErrors.length} l·ªói)
                                </h3>
                                ${criticalErrors.map((error, idx) => `
                                    <div style="margin: 15px 0; padding: 20px; background: #fff5f5; border-left: 5px solid #e53e3e; border-radius: 10px;">
                                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 15px;">
                                            <h4 style="color: #e53e3e; margin: 0;">${idx + 1}. ${error.data.vietnameseName}</h4>
                                            <span style="background: #e53e3e; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.9em;">${error.confidence}% tin c·∫≠y</span>
                                        </div>
                                        <div style="color: #4a5568; margin-bottom: 10px;"><strong>Linh ki·ªán:</strong> ${error.data.component}</div>
                                        <div style="color: #4a5568; margin-bottom: 15px;"><strong>T√°c ƒë·ªông:</strong> ${error.data.description}</div>
                                        <div style="background: white; padding: 15px; border-radius: 8px;">
                                            <strong style="color: #e53e3e;">H√†nh ƒë·ªông ngay:</strong>
                                            <ul style="margin: 10px 0 0 20px; color: #4a5568;">
                                                ${error.data.repairSolution ? error.data.repairSolution.slice(0, 2).map(solution => `<li>${solution}</li>`).join('') : '<li>C·∫ßn ch·∫©n ƒëo√°n chuy√™n s√¢u</li>'}
                                            </ul>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${highErrors.length > 0 ? `
                            <div style="margin-bottom: 30px;">
                                <h3 style="color: #f6ad55; margin-bottom: 20px; display: flex; align-items: center;">
                                    ‚ö†Ô∏è M·ª®C CAO - S·ª≠a trong tu·∫ßn (${highErrors.length} l·ªói)
                                </h3>
                                ${highErrors.slice(0, 3).map((error, idx) => `
                                    <div style="margin: 15px 0; padding: 20px; background: #fffbf0; border-left: 5px solid #f6ad55; border-radius: 10px;">
                                        <h4 style="color: #c05621; margin: 0 0 10px 0;">${idx + 1}. ${error.data.vietnameseName}</h4>
                                        <div style="color: #4a5568; margin-bottom: 10px;">${error.data.description}</div>
                                        <div style="color: #c05621; font-size: 0.9em;">üìç ${error.data.component}</div>
                                    </div>
                                `).join('')}
                                ${highErrors.length > 3 ? `<div style="text-align: center; color: #666; font-style: italic;">... v√† ${highErrors.length - 3} l·ªói m·ª©c cao kh√°c</div>` : ''}
                            </div>
                        ` : ''}
                        
                        <div style="background: #f0fff4; padding: 25px; border-radius: 15px; border-left: 5px solid #38a169;">
                            <h3 style="color: #38a169; margin: 0 0 15px 0;">‚úÖ K·∫ø Ho·∫°ch H√†nh ƒê·ªông T·ªïng Th·ªÉ</h3>
                            <div style="color: #2f855a;">
                                <div style="margin: 10px 0;"><strong>1. Ngay l·∫≠p t·ª©c:</strong> Backup to√†n b·ªô d·ªØ li·ªáu quan tr·ªçng</div>
                                <div style="margin: 10px 0;"><strong>2. Trong 24h:</strong> X·ª≠ l√Ω t·∫•t c·∫£ l·ªói nghi√™m tr·ªçng</div>
                                <div style="margin: 10px 0;"><strong>3. Trong tu·∫ßn:</strong> S·ª≠a ch·ªØa l·ªói m·ª©c cao</div>
                                <div style="margin: 10px 0;"><strong>4. Theo d√µi:</strong> Monitor thi·∫øt b·ªã sau s·ª≠a ch·ªØa</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Hi·ªÉn th·ªã ∆∞·ªõc t√≠nh chi ph√≠
        function showCostEstimate() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const costEstimates = {
                'watchdog_timeout': { min: 500000, max: 2000000, component: 'Main Logic Board' },
                'thermal_shutdown': { min: 200000, max: 800000, component: 'Thermal System' },
                'battery_panic': { min: 300000, max: 1200000, component: 'Battery + Charging IC' },
                'memory_panic': { min: 800000, max: 3000000, component: 'RAM Module' },
                'nand_panic': { min: 1000000, max: 4000000, component: 'Storage + Controller' },
                'camera_panic': { min: 400000, max: 1500000, component: 'Camera Module' },
                'touch_panic': { min: 600000, max: 2500000, component: 'Touch IC + Display' },
                'wifi_panic': { min: 300000, max: 1000000, component: 'WiFi Chip' },
                'pmu_panic': { min: 700000, max: 2500000, component: 'PMU IC' },
                'secure_enclave_panic': { min: 1500000, max: 5000000, component: 'Logic Board Replacement' }
            };
            
            let totalMinCost = 0;
            let totalMaxCost = 0;
            const repairItems = [];
            
            allErrors.forEach(error => {
                const cost = costEstimates[error.key];
                if (cost) {
                    totalMinCost += cost.min;
                    totalMaxCost += cost.max;
                    repairItems.push({
                        name: error.data.vietnameseName,
                        component: cost.component,
                        minCost: cost.min,
                        maxCost: cost.max,
                        severity: error.data.severity
                    });
                }
            });
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 20px; max-width: 700px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h2 style="margin: 0;">üí∞ ∆Ø·ªõc T√≠nh Chi Ph√≠ S·ª≠a Ch·ªØa</h2>
                        <p style="margin: 10px 0 0 0; opacity: 0.9;">D·ª±a tr√™n ${repairItems.length} l·ªói c·∫ßn s·ª≠a ch·ªØa</p>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px;">√ó</button>
                    </div>
                    <div style="padding: 30px;">
                        <div style="text-align: center; margin-bottom: 30px; padding: 25px; background: linear-gradient(135deg, #f7fafc, #edf2f7); border-radius: 15px;">
                            <h3 style="color: #2d3748; margin: 0 0 15px 0;">T·ªïng Chi Ph√≠ ∆Ø·ªõc T√≠nh</h3>
                            <div style="font-size: 2em; font-weight: bold; color: #667eea; margin-bottom: 10px;">
                                ${(totalMinCost / 1000).toLocaleString('vi-VN')}K - ${(totalMaxCost / 1000).toLocaleString('vi-VN')}K VNƒê
                            </div>
                            <div style="color: #666; font-size: 0.95em;">
                                (Ch∆∞a bao g·ªìm ph√≠ c√¥ng v√† ki·ªÉm tra)
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4 style="color: #2d3748; margin-bottom: 15px;">üìã Chi Ti·∫øt T·ª´ng H·∫°ng M·ª•c:</h4>
                            ${repairItems.map((item, idx) => `
                                <div style="margin: 15px 0; padding: 20px; background: ${item.severity === 'critical' ? '#fff5f5' : item.severity === 'high' ? '#fffbf0' : '#f7fafc'}; border-left: 5px solid ${getSeverityColor(item.severity)}; border-radius: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h5 style="color: #2d3748; margin: 0;">${idx + 1}. ${item.name}</h5>
                                        <span style="background: ${getSeverityColor(item.severity)}; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8em;">${getSeverityText(item.severity)}</span>
                                    </div>
                                    <div style="color: #4a5568; margin-bottom: 10px;">üîß Linh ki·ªán: ${item.component}</div>
                                    <div style="color: #2d3748; font-weight: bold;">
                                        üí∞ Chi ph√≠: ${(item.minCost / 1000).toLocaleString('vi-VN')}K - ${(item.maxCost / 1000).toLocaleString('vi-VN')}K VNƒê
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="background: #e6fffa; padding: 20px; border-radius: 15px; border-left: 5px solid #38b2ac;">
                            <h4 style="color: #234e52; margin: 0 0 15px 0;">üí° L∆∞u √ù V·ªÅ Chi Ph√≠:</h4>
                            <ul style="color: #285e61; margin-left: 20px; line-height: 1.6;">
                                <li>Gi√° ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o, c√≥ th·ªÉ thay ƒë·ªïi theo t·ª´ng c·ª≠a h√†ng</li>
                                <li>Chi ph√≠ c√¥ng s·ª≠a ch·ªØa: 100K - 500K VNƒê t√πy ƒë·ªô ph·ª©c t·∫°p</li>
                                <li>N√™n so s√°nh gi√° ·ªü nhi·ªÅu n∆°i tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh</li>
                                <li>∆Øu ti√™n s·ª≠a ch·ªØa l·ªói nghi√™m tr·ªçng tr∆∞·ªõc ƒë·ªÉ tr√°nh h·ªèng lan</li>
                                <li>Ki·ªÉm tra b·∫£o h√†nh tr∆∞·ªõc khi s·ª≠a ch·ªØa</li>
                            </ul>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="exportCostReport()" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 0 10px;">
                                üìä Xu·∫•t B√°o C√°o Chi Ph√≠
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Xu·∫•t b√°o c√°o chi ph√≠
        function exportCostReport() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const costEstimates = {
                'watchdog_timeout': { min: 500000, max: 2000000, component: 'Main Logic Board' },
                'thermal_shutdown': { min: 200000, max: 800000, component: 'Thermal System' },
                'battery_panic': { min: 300000, max: 1200000, component: 'Battery + Charging IC' },
                'memory_panic': { min: 800000, max: 3000000, component: 'RAM Module' },
                'nand_panic': { min: 1000000, max: 4000000, component: 'Storage + Controller' },
                'camera_panic': { min: 400000, max: 1500000, component: 'Camera Module' },
                'touch_panic': { min: 600000, max: 2500000, component: 'Touch IC + Display' },
                'wifi_panic': { min: 300000, max: 1000000, component: 'WiFi Chip' },
                'pmu_panic': { min: 700000, max: 2500000, component: 'PMU IC' },
                'secure_enclave_panic': { min: 1500000, max: 5000000, component: 'Logic Board Replacement' }
            };
            
            const costReport = {
                generatedAt: new Date().toISOString(),
                deviceAnalysis: 'iOS Panic Log Cost Estimate',
                totalErrors: allErrors.length,
                repairItems: [],
                summary: {
                    totalMinCost: 0,
                    totalMaxCost: 0,
                    currency: 'VND',
                    note: 'Chi ph√≠ ch∆∞a bao g·ªìm ph√≠ c√¥ng v√† ki·ªÉm tra'
                }
            };
            
            allErrors.forEach(error => {
                const cost = costEstimates[error.key];
                if (cost) {
                    costReport.repairItems.push({
                        errorName: error.data.vietnameseName,
                        component: cost.component,
                        severity: error.data.severity,
                        confidence: error.confidence,
                        minCost: cost.min,
                        maxCost: cost.max,
                        priority: error.data.severity === 'critical' ? 1 : error.data.severity === 'high' ? 2 : 3
                    });
                    costReport.summary.totalMinCost += cost.min;
                    costReport.summary.totalMaxCost += cost.max;
                }
            });
            
            // Sort by priority
            costReport.repairItems.sort((a, b) => a.priority - b.priority);
            
            const blob = new Blob([JSON.stringify(costReport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cost_estimate_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessNotification('B√°o c√°o chi ph√≠ ƒë√£ ƒë∆∞·ª£c xu·∫•t!');
        }

        // Th√™m floating action button
        const floatingBtn = document.createElement('button');
        floatingBtn.className = 'floating-action';
        floatingBtn.innerHTML = '‚Üë';
        floatingBtn.title = 'Scroll to top';
        floatingBtn.onclick = scrollToTop;
        document.body.appendChild(floatingBtn);

        // ·∫®n/hi·ªán floating button khi scroll
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                floatingBtn.style.display = 'block';
            } else {
                floatingBtn.style.display = 'none';
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        autoSaveResults();
                        showSuccessNotification('ƒê√£ l∆∞u k·∫øt qu·∫£!');
                        break;
                    case 'e':
                        e.preventDefault();
                        if (analysisResults.length > 0) {
                            exportDetailedReport();
                        }
                        break;
                    case 'f':
                        e.preventDefault();
                        document.getElementById('searchBox').focus();
                        break;
                }
            }
            
            if (e.key === 'Escape') {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => modal.remove());
            }
        });

        // Performance monitoring
        if ('performance' in window) {
            window.addEventListener('load', () => {
                setTimeout(() => {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    console.log(`üöÄ Trang load trong ${Math.round(perfData.loadEventEnd - perfData.loadEventStart)}ms`);
                }, 0);
            });
        }

        // Service Worker registration (for offline capability)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker ƒë√£ ƒëƒÉng k√Ω');
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker ƒëƒÉng k√Ω th·∫•t b·∫°i');
                    });
            });
        }

        console.log('ü§ñ AI Vision Pro Panic Log Analyzer ƒë√£ s·∫µn s√†ng!');
        console.log('üìä Database: 100+ l·ªói iOS ƒë∆∞·ª£c h·ªó tr·ª£');
        console.log('üëÅÔ∏è AI Vision: Computer Vision + OCR Engine');
        console.log('‚ö° Performance: Optimized for speed and accuracy');

        // X√≥a t·∫•t c·∫£ l·ªãch s·ª≠
function clearAllHistory() {
    if (confirm('üóëÔ∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ l·ªãch s·ª≠ ph√¢n t√≠ch?\n\nH√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!')) {
        // X√≥a d·ªØ li·ªáu trong b·ªô nh·ªõ
        analysisResults = [];
        
        // X√≥a localStorage
        localStorage.removeItem('panicLogAnalysis');
        
        // ·∫®n container k·∫øt qu·∫£
        document.getElementById('resultsContainer').style.display = 'none';
        
        // Reset counters
        document.getElementById('textFiles').textContent = '0';
        document.getElementById('imageFiles').textContent = '0';
        document.getElementById('textErrors').textContent = '0';
        document.getElementById('aiAccuracy').textContent = '0%';
        
        // X√≥a preview ·∫£nh n·∫øu c√≥
        const existingPreview = document.querySelector('.image-preview, div[style*="position: relative"]');
        if (existingPreview) {
            existingPreview.remove();
        }
        
        // Hi·ªÉn th·ªã th√¥ng b√°o
        showSuccessNotification('üóëÔ∏è ƒê√£ x√≥a t·∫•t c·∫£ l·ªãch s·ª≠ th√†nh c√¥ng!');
        
        console.log('‚úÖ L·ªãch s·ª≠ ƒë√£ ƒë∆∞·ª£c x√≥a ho√†n to√†n');
    }
}

    </script>
</body>
</html>
