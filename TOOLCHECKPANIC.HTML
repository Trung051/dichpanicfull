<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>C√¥ng C·ª• Ph√¢n T√≠ch Panic Log iOS - AI Vision Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }
        
        .ai-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin: 0 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .upload-section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .upload-section:hover {
            transform: translateY(-5px);
        }
        
        .upload-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .upload-zone:hover {
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
            border-color: #38a169;
            transform: scale(1.02);
        }
        
        .image-upload-zone {
            border: 3px dashed #f093fb;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #fff0fd, #fdf2f8);
        }
        
        .image-upload-zone:hover {
            background: linear-gradient(135deg, #fdf2f8, #fef7ff);
            border-color: #e879f9;
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(240, 147, 251, 0.3);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            transition: all 0.3s ease;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
        }
        
        .ai-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 15px 30px rgba(240, 147, 251, 0.4);
        }
        
        .search-box {
            width: 100%;
            padding: 18px 25px;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            font-size: 1.1em;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }
        
        .category-btn {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            color: #4a5568;
            border: 2px solid #e2e8f0;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .category-btn:hover, .category-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .error-database {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
        }
        
        .error-item {
            padding: 15px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .error-item:hover {
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
            transform: translateX(10px);
        }
        
        .results-container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            display: none;
            animation: slideUp 0.5s ease;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .panic-analysis {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border-left: 5px solid #e53e3e;
            padding: 30px;
            margin: 25px 0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .panic-analysis::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #e53e3e, #fc8181, #feb2b2);
        }
        
        .error-category {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .severity-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 15px;
        }
        
        .severity-critical { background: #e53e3e; }
        .severity-high { background: #dd6b20; }
        .severity-medium { background: #d69e2e; }
        .severity-low { background: #38a169; }
        
        .ai-processing {
            display: none;
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .ai-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .confidence-meter {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .confidence-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #38a169, #48bb78);
            border-radius: 4px;
            transition: width 1s ease;
        }
        
        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .floating-action:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
        }

        /* Responsive Design cho Mobile */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
            
            .container {
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            /* Mobile Layout */
            .main-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px 15px;
                margin-bottom: 20px;
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
                margin-bottom: 10px;
            }
            
            .header p {
                font-size: 1em !important;
                margin: 10px 0 !important;
            }
            
            /* Upload sections mobile */
            .upload-section {
                padding: 20px 15px;
                border-radius: 15px;
            }
            
            .upload-zone, .image-upload-zone {
                padding: 30px 15px;
                border-radius: 15px;
            }
            
            .upload-zone div[style*="font-size: 3em"], 
            .image-upload-zone div[style*="font-size: 3em"] {
                font-size: 2em !important;
                margin-bottom: 10px !important;
            }
            
            .upload-zone h4, .image-upload-zone h4 {
                font-size: 1.1em;
                margin-bottom: 8px;
            }
            
            .upload-zone p, .image-upload-zone p {
                font-size: 0.9em;
                margin: 8px 0 !important;
            }
            
            /* Buttons mobile */
            .btn {
                padding: 14px 25px;
                font-size: 1em;
                border-radius: 25px;
                width: 100%;
                max-width: 200px;
            }
            
            /* Search box mobile */
            .search-box {
                padding: 15px 20px;
                font-size: 1em;
                margin-bottom: 20px;
                border-radius: 25px;
            }
            
            /* Category filter mobile */
            .category-filter {
                gap: 10px;
                margin: 20px 0;
                justify-content: center;
            }
            
            .category-btn {
                padding: 10px 15px;
                font-size: 0.9em;
                border-radius: 20px;
                flex: 1;
                min-width: auto;
                text-align: center;
            }
            
            /* Error database mobile */
            .error-database {
                max-height: 400px;
                padding: 15px;
                border-radius: 15px;
            }
            
            .error-item {
                padding: 12px;
                margin-bottom: 8px;
                border-radius: 8px;
            }
            
            /* Results container mobile */
            .results-container {
                padding: 20px 15px;
                border-radius: 15px;
            }
            
            .panic-analysis {
                padding: 20px 15px;
                margin: 15px 0;
                border-radius: 15px;
            }
            
            /* Stats grid mobile */
            .upload-section div[style*="display: grid; grid-template-columns: 1fr 1fr"] {
                gap: 10px !important;
            }
            
            .upload-section div[style*="text-align: center; padding: 15px"] {
                padding: 12px !important;
                border-radius: 10px !important;
            }
            
            .upload-section div[style*="font-size: 1.8em"] {
                font-size: 1.5em !important;
            }
            
            .upload-section div[style*="font-size: 0.9em"] {
                font-size: 0.8em !important;
            }
            
            /* Floating action button mobile */
            .floating-action {
                width: 50px;
                height: 50px;
                bottom: 20px;
                right: 20px;
                font-size: 20px;
            }
            
            /* AI Processing mobile */
            .ai-processing {
                padding: 20px 15px;
                border-radius: 15px;
                margin: 15px 0;
            }
            
            .ai-spinner {
                width: 40px;
                height: 40px;
                margin: 15px auto;
            }
        }

        @media (max-width: 480px) {
            /* Extra small mobile */
            .container {
                padding: 8px;
            }
            
            .header {
                padding: 15px 12px;
                margin-bottom: 15px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .header p {
                font-size: 0.9em !important;
            }
            
            .upload-section {
                padding: 15px 12px;
            }
            
            .upload-zone, .image-upload-zone {
                padding: 25px 12px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 0.95em;
            }
            
            .search-box {
                padding: 12px 18px;
                font-size: 0.95em;
            }
            
            .category-btn {
                padding: 8px 12px;
                font-size: 0.85em;
            }
            
            .error-database {
                padding: 12px;
                max-height: 350px;
            }
            
            .results-container {
                padding: 15px 12px;
            }
            
            .panic-analysis {
                padding: 15px 12px;
            }
            
            .floating-action {
                width: 45px;
                height: 45px;
                bottom: 15px;
                right: 15px;
                font-size: 18px;
            }
        }

        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            /* Touch devices */
            .btn, .category-btn, .error-item, .floating-action {
                min-height: 44px; /* Apple's recommended touch target size */
            }
            
            .upload-zone, .image-upload-zone {
                min-height: 120px;
            }
            
            .search-box {
                min-height: 44px;
            }
            
            /* Remove hover effects on touch devices */
            .upload-section:hover {
                transform: none;
            }
            
            .upload-zone:hover, .image-upload-zone:hover {
                transform: none;
                box-shadow: none;
            }
            
            .btn:hover {
                transform: none;
                box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
            }
            
            .category-btn:hover {
                transform: none;
            }
            
            .error-item:hover {
                transform: none;
            }
        }

        /* Landscape orientation on mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.6em;
            }
            
            .upload-zone, .image-upload-zone {
                padding: 20px 15px;
            }
        }

        /* Dark mode support for mobile */
        @media (prefers-color-scheme: dark) {
            .search-box {
                background: linear-gradient(135deg, #2d3748, #4a5568);
                color: white;
                border-color: #4a5568;
            }
            
            .error-database {
                background: linear-gradient(135deg, #2d3748, #4a5568);
            }
            
            .error-item {
                color: #e2e8f0;
            }
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .shimmer, .scan-line, .floating-particles {
                display: none;
            }
        }

        /* Additional mobile-specific styles */
        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg); 
                opacity: 0.7;
            }
            50% { 
                transform: translateY(-20px) rotate(180deg); 
                opacity: 1;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .scan-line {
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.3), transparent);
            animation: scanEffect 2s infinite;
        }
        
        @keyframes scanEffect {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .error-item.selected {
            background: linear-gradient(135deg, #e6fffa, #b2f5ea) !important;
            border-left: 5px solid #38b2ac !important;
            transform: translateX(10px) !important;
        }
        
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .particle {
            position: absolute;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .scan-line {
                animation: scanEffect 3s infinite; /* Slower on mobile */
            }
            
            .particle {
                animation: float 8s ease-in-out infinite; /* Slower on mobile */
            }
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Focus styles for accessibility */
        button:focus,
        input:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }
        
        /* Loading animation */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>d·ªãch Panicfull</h1>
            <p style="font-size: 1.2em; margin: 15px 0;">AI Vision + 100+ C∆° S·ªü D·ªØ Li·ªáu L·ªói + Ph√¢n T√≠ch Th·ªùi Gian Th·ª±c</p>
        </div>
        
        <div class="main-grid">
            <!-- Upload File Text -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üìÑ File Text/Log</h3>
                <div class="upload-zone" id="textUploadZone">
                    <input type="file" id="textFileInput" style="display: none" accept=".txt,.crash,.ips,.panic-full,.log" multiple>
                    <div style="font-size: 3em; margin-bottom: 15px;">üì±</div>
                    <h4>K√©o Th·∫£ File Log</h4>
                    <p style="margin: 10px 0; color: #666;">H·ªó tr·ª£: txt, crash, ips, panic-full, log</p>
                    <button class="btn" onclick="document.getElementById('textFileInput').click()">Ch·ªçn File</button>
                </div>
                
                <div style="margin-top: 25px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="text-align: center; padding: 15px; background: #f0fff4; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #38a169;" id="textFiles">0</div>
                            <div style="font-size: 0.9em; color: #666;">File Text</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #fff5f5; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #e53e3e;" id="textErrors">0</div>
                            <div style="font-size: 0.9em; color: #666;">L·ªói T√¨m Th·∫•y</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Upload ·∫¢nh v·ªõi AI Vision -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üì∏ Ph√¢n T√≠ch AI Vision</h3>
                <div class="image-upload-zone" id="imageUploadZone">
                    <input type="file" id="imageFileInput" style="display: none" accept="image/*" multiple>
                    <div style="font-size: 3em; margin-bottom: 15px;">ü§ñüëÅÔ∏è</div>
                    <h4>Nh·∫≠n D·∫°ng ·∫¢nh AI</h4>
                    <p style="margin: 10px 0; color: #666;">jpg, png, heic, webp</p>
                    <button class="btn ai-btn" onclick="document.getElementById('imageFileInput').click()">T·∫£i ·∫¢nh L√™n</button>
                </div>
                
                <div class="ai-processing" id="aiProcessing">
                    <div class="ai-spinner"></div>
                    <h4>üß† AI ƒêang X·ª≠ L√Ω...</h4>
                    <p>Ph√¢n t√≠ch ·∫£nh v·ªõi OCR + Nh·∫≠n d·∫°ng m·∫´u n√¢ng cao</p>
                </div>
                
                <div style="margin-top: 25px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="text-align: center; padding: 15px; background: #fdf2f8; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #f093fb;" id="imageFiles">0</div>
                            <div style="font-size: 0.9em; color: #666;">·∫¢nh</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 15px;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #3b82f6;" id="aiAccuracy">0%</div>
                            <div style="font-size: 0.9em; color: #666;">ƒê·ªô Ch√≠nh X√°c AI</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- T√¨m Ki·∫øm Th√¥ng Minh -->
            <div class="upload-section">
                <h3 style="margin-bottom: 20px;">üîç T√¨m Ki·∫øm L·ªói Th√¥ng Minh</h3>
                <input type="text" class="search-box" id="searchBox" placeholder="T√¨m ki·∫øm 100+ l·ªói (watchdog, thermal, panic...)">
                
                <div class="category-filter">
                    <div class="category-btn active" onclick="filterByCategory('all')">T·∫•t C·∫£</div>
                                        <div class="category-btn" onclick="filterByCategory('hardware')">Ph·∫ßn C·ª©ng</div>
                    <div class="category-btn" onclick="filterByCategory('software')">Ph·∫ßn M·ªÅm</div>
                    <div class="category-btn" onclick="filterByCategory('thermal')">Nhi·ªát ƒê·ªô</div>
                    <div class="category-btn" onclick="filterByCategory('power')">Ngu·ªìn</div>
                    <div class="category-btn" onclick="filterByCategory('memory')">B·ªô Nh·ªõ</div>
                </div>
                
                <div class="error-database" id="errorDatabase">
                    <div style="text-align: center; color: #666; padding: 30px;">
                        <div style="font-size: 2em; margin-bottom: 10px;">ü§ñ</div>
                        <p>AI s·∫µn s√†ng ph√¢n t√≠ch 100+ m·∫´u l·ªói</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <h3 style="margin-bottom: 30px;">üìä K·∫øt Qu·∫£ Ph√¢n T√≠ch AI</h3>
            <div id="analysisResults"></div>
        </div>
    </div>

    <script>
        // Mobile detection v√† optimization
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isTouch = 'ontouchstart' in window;

        // C∆° s·ªü d·ªØ li·ªáu 100+ l·ªói iOS panic log
        const errorDatabase = {
            // === L·ªñI PH·∫¶N C·ª®NG CHI TI·∫æT ===
            
            "watchdog_timeout": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói Watchdog timeout - CPU ho·∫∑c h·ªá th·ªëng kh√¥ng ph·∫£n h·ªìi trong th·ªùi gian quy ƒë·ªãnh",
                patterns: ["watchdog timeout", "WDOG", "no checkin", "hang", "watchdog_timeout"],
                vietnameseName: "L·ªói Watchdog Timeout",
                component: "Main Logic Board - CPU/SoC",
                location: "A-series Processor (A12/A13/A14/A15/A16)",
                symptoms: ["M√°y ƒë·ªôt ng·ªôt restart", "M√†n h√¨nh ƒëen", "Kh√¥ng ph·∫£n h·ªìi", "Treo m√°y"],
                causes: ["CPU overload", "Infinite loop trong kernel", "Hardware deadlock", "Power management issue"],
                diagnosis: {
                    step1: "Ki·ªÉm tra nhi·ªát ƒë·ªô CPU b·∫±ng 3uTools",
                    step2: "Test RAM b·∫±ng MemTest",
                    step3: "Ki·ªÉm tra ngu·ªìn c·∫•p cho CPU (PPVDD_MAIN)",
                    step4: "ƒêo ƒëi·ªán tr·ªü c√°c t·ª• l·ªçc ngu·ªìn CPU"
                },
                repairSolution: ["Thay IC ngu·ªìn CPU", "Reballing CPU", "Thay t·ª• l·ªçc ngu·ªìn", "Thay main board"]
            },

            "thermal_shutdown": {
                category: "thermal",
                severity: "critical", 
                description: "Thi·∫øt b·ªã t·ª± ƒë·ªông t·∫Øt do nhi·ªát ƒë·ªô qu√° cao, b·∫£o v·ªá linh ki·ªán kh·ªèi h∆∞ h·ªèng",
                patterns: ["thermal", "overtemp", "hot", "temperature", "thermal_shutdown", "thermal trap"],
                vietnameseName: "T·∫Øt M√°y Do Qu√° Nhi·ªát",
                component: "Thermal Management System",
                location: "CPU/GPU/PMU Temperature Sensors",
                symptoms: ["M√°y n√≥ng b·∫•t th∆∞·ªùng", "T·ª± ƒë·ªông t·∫Øt", "Hi·ªáu nƒÉng gi·∫£m", "Pin t·ª•t nhanh"],
                causes: ["Thermal paste kh√¥", "T·∫£n nhi·ªát b·ªã t·∫Øc", "Qu·∫°t h·ªèng", "Sensor nhi·ªát ƒë·ªô l·ªói"],
                diagnosis: {
                    step1: "ƒêo nhi·ªát ƒë·ªô b·∫±ng thermal camera",
                    step2: "Ki·ªÉm tra thermal paste CPU/GPU",
                    step3: "Test thermal sensor b·∫±ng DC Power Supply",
                    step4: "Ki·ªÉm tra thermal throttling trong log"
                },
                repairSolution: ["Thay thermal paste", "V·ªá sinh t·∫£n nhi·ªát", "Thay thermal sensor", "C·∫£i thi·ªán lu·ªìng kh√≠"]
            },

            "battery_panic": {
                category: "power",
                severity: "high",
                description: "L·ªói li√™n quan ƒë·∫øn pin v√† h·ªá th·ªëng ngu·ªìn, c√≥ th·ªÉ do pin h·ªèng ho·∫∑c m·∫°ch s·∫°c",
                patterns: ["battery", "power", "charging", "PMU", "battery_panic", "fuel gauge"],
                vietnameseName: "L·ªói Pin/Ngu·ªìn",
                component: "Battery Management System + PMU IC",
                location: "Logic Board - Power Management Section",
                symptoms: ["Kh√¥ng s·∫°c pin", "Pin t·ª•t nhanh", "B√°o sai % pin", "T·∫Øt m√°y ƒë·ªôt ng·ªôt"],
                causes: ["Pin chai/ph·ªìng", "IC s·∫°c h·ªèng", "C·∫£m bi·∫øn pin l·ªói", "M·∫°ch ngu·ªìn ch·∫≠p"],
                diagnosis: {
                    step1: "ƒêo voltage pin (3.7V nominal)",
                    step2: "Test d√≤ng s·∫°c b·∫±ng USB meter",
                    step3: "Ki·ªÉm tra IC s·∫°c U2 (Tristar)",
                    step4: "ƒêo ƒëi·ªán tr·ªü internal resistance pin"
                },
                repairSolution: ["Thay pin m·ªõi", "Thay IC s·∫°c U2", "S·ª≠a m·∫°ch ngu·ªìn", "Thay PMU IC"]
            },

            "memory_panic": {
                category: "memory",
                severity: "high",
                description: "L·ªói b·ªô nh·ªõ RAM ho·∫∑c storage, c√≥ th·ªÉ do RAM h·ªèng ho·∫∑c l·ªói d·ªØ li·ªáu",
                patterns: ["memory", "RAM", "ECC", "DRAM", "memory_panic", "memory corruption"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ RAM",
                component: "LPDDR4/LPDDR5 RAM Modules",
                location: "Logic Board - Memory Section (stacked on SoC)",
                symptoms: ["App crash li√™n t·ª•c", "Restart random", "L·ªói khi m·ªü app n·∫∑ng", "iOS lag"],
                causes: ["RAM b·ªã l·ªói", "Solder joints l·ªèng", "Nhi·ªát ƒë·ªô cao", "Voltage kh√¥ng ·ªïn ƒë·ªãnh"],
                diagnosis: {
                    step1: "Ch·∫°y memory test v·ªõi checkra1n",
                    step2: "Ki·ªÉm tra temperature RAM",
                    step3: "ƒêo voltage c·∫•p cho RAM (VDD_MEM)",
                    step4: "Test stress v·ªõi benchmark app"
                },
                repairSolution: ["Reballing RAM", "Thay RAM module", "S·ª≠a m·∫°ch ngu·ªìn RAM", "Thay main board"]
            },

            "nand_panic": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói b·ªô nh·ªõ NAND flash storage, th∆∞·ªùng do wear leveling ho·∫∑c bad block",
                patterns: ["NAND", "flash", "storage", "ANS2", "nand_panic", "storage controller"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ NAND Flash",
                component: "NAND Flash Storage + Storage Controller",
                location: "Logic Board - Storage Section",
                symptoms: ["Kh√¥ng boot ƒë∆∞·ª£c", "L·ªói restore", "M·∫•t d·ªØ li·ªáu", "iOS corrupt"],
                causes: ["Bad blocks qu√° nhi·ªÅu", "Controller h·ªèng", "Firmware corrupt", "Wear leveling fail"],
                diagnosis: {
                    step1: "Scan bad blocks b·∫±ng NAND programmer",
                    step2: "Ki·ªÉm tra storage controller",
                    step3: "Test read/write speed",
                    step4: "Dump firmware ƒë·ªÉ check corruption"
                },
                repairSolution: ["Thay NAND flash m·ªõi", "Repair bad blocks", "Reflash firmware", "Data recovery"]
            },

            "camera_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói camera module ho·∫∑c ISP (Image Signal Processor)",
                patterns: ["camera", "ISP", "H11", "H13", "camera_panic", "image sensor"],
                vietnameseName: "L·ªói Camera/ISP",
                component: "Camera Module + ISP (Image Signal Processor)",
                location: "Rear/Front Camera Assembly",
                symptoms: ["Camera app crash", "·∫¢nh ƒëen", "Kh√¥ng focus", "L·ªói flash"],
                causes: ["Camera module h·ªèng", "Flex cable l·ªèng", "ISP l·ªói", "OIS actuator stuck"],
                diagnosis: {
                    step1: "Test t·ª´ng camera ri√™ng l·∫ª",
                    step2: "Ki·ªÉm tra flex cable camera",
                    step3: "ƒêo voltage c·∫•p cho camera (AVDD/DVDD)",
                    step4: "Test ISP communication"
                },
                repairSolution: ["Thay camera module", "Thay flex cable", "S·ª≠a m·∫°ch ngu·ªìn camera", "Thay ISP IC"]
            },

            "touch_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói c·∫£m ·ª©ng touchscreen, c√≥ th·ªÉ do digitizer ho·∫∑c touch IC h·ªèng",
                patterns: ["touch", "multitouch", "digitizer", "touch_panic", "touch controller"],
                vietnameseName: "L·ªói C·∫£m ·ª®ng Touch",
                component: "Touch Controller IC + Digitizer",
                location: "Logic Board - Touch IC Section + Display Assembly",
                symptoms: ["C·∫£m ·ª©ng kh√¥ng ho·∫°t ƒë·ªông", "Ghost touch", "Dead zone", "Multi-touch l·ªói"],
                causes: ["Touch IC h·ªèng", "Digitizer crack", "Flex cable l·ªói", "ESD damage"],
                diagnosis: {
                    step1: "Test c·∫£m ·ª©ng b·∫±ng diagnostic mode",
                    step2: "Ki·ªÉm tra touch IC (Meson/Broadcom)",
                    step3: "ƒêo voltage touch rails",
                    step4: "Test continuity flex cable"
                },
                repairSolution: ["Thay touch IC", "Thay m√†n h√¨nh", "S·ª≠a flex cable", "ESD protection repair"]
            },

            "wifi_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói WiFi module, c√≥ th·ªÉ do chip WiFi h·ªèng ho·∫∑c anten b·ªã l·ªói",
                patterns: ["wifi", "wlan", "802.11", "wifi_panic", "wireless"],
                vietnameseName: "L·ªói WiFi Module",
                component: "WiFi/Bluetooth Combo Chip + Antenna",
                location: "Logic Board - RF Section + Antenna Assembly",
                symptoms: ["Kh√¥ng b·∫Øt ƒë∆∞·ª£c WiFi", "WiFi y·∫øu", "Disconnect li√™n t·ª•c", "Kh√¥ng t√¨m th·∫•y network"],
                causes: ["WiFi chip h·ªèng", "Antenna ƒë·ª©t", "RF shield l·ªèng", "Firmware corrupt"],
                diagnosis: {
                    step1: "Scan WiFi networks xung quanh",
                    step2: "Test WiFi chip communication",
                    step3: "Ki·ªÉm tra antenna continuity",
                    step4: "ƒêo RF power output"
                },
                repairSolution: ["Thay WiFi chip", "S·ª≠a/thay antenna", "Reballing RF IC", "Update firmware"]
            },

            "bluetooth_panic": {
                category: "hardware",
                severity: "low",
                description: "L·ªói Bluetooth module, th∆∞·ªùng do chip Bluetooth ho·∫∑c driver b·ªã l·ªói",
                patterns: ["bluetooth", "BT", "wireless", "bluetooth_panic"],
                vietnameseName: "L·ªói Bluetooth",
                component: "Bluetooth Controller (integrated with WiFi)",
                location: "WiFi/BT Combo Chip",
                symptoms: ["Kh√¥ng pair ƒë∆∞·ª£c", "Audio stuttering", "Disconnect", "Kh√¥ng t√¨m th·∫•y devices"],
                causes: ["BT firmware l·ªói", "Antenna issue", "Power management", "Interference"],
                diagnosis: {
                    step1: "Test Bluetooth pairing",
                    step2: "Check BT firmware version",
                    step3: "Test audio codec",
                    step4: "Scan for interference"
                },
                repairSolution: ["Update BT firmware", "Thay WiFi/BT chip", "Antenna repair", "RF shielding"]
            },

            "accelerometer_panic": {
                category: "sensor",
                severity: "low",
                description: "L·ªói c·∫£m bi·∫øn gia t·ªëc, c√≥ th·ªÉ do c·∫£m bi·∫øn h·ªèng ho·∫∑c l·ªói calibration",
                patterns: ["accelerometer", "motion", "gyro", "accelerometer_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn Gia T·ªëc",
                component: "Accelerometer/Gyroscope Sensor IC",
                location: "Logic Board - Sensor Array",
                symptoms: ["Xoay m√†n h√¨nh kh√¥ng ho·∫°t ƒë·ªông", "Game motion l·ªói", "Compass sai", "Shake kh√¥ng work"],
                causes: ["Sensor IC h·ªèng", "Calibration sai", "Mechanical damage", "Software bug"],
                diagnosis: {
                    step1: "Test sensor trong Settings > Privacy",
                    step2: "Calibrate accelerometer",
                    step3: "Ki·ªÉm tra sensor IC",
                    step4: "Test v·ªõi motion apps"
                },
                repairSolution: ["Recalibrate sensor", "Thay sensor IC", "Software reset", "Logic board repair"]
            },

            // === L·ªñI PH·∫¶N M·ªÄM CHI TI·∫æT ===
            "kernel_panic": {
                category: "software",
                severity: "critical",
                description: "Kernel panic - L·ªói nghi√™m tr·ªçng c·ªßa h·ªá ƒëi·ªÅu h√†nh iOS",
                patterns: ["kernel panic", "KP", "system crash", "kernel_panic"],
                vietnameseName: "L·ªói Kernel Panic",
                component: "iOS Kernel (XNU)",
                location: "System Software Level",
                symptoms: ["Restart ƒë·ªôt ng·ªôt", "M√†n h√¨nh xanh", "Freeze ho√†n to√†n", "Boot loop"],
                causes: ["Driver conflict", "Memory corruption", "Hardware failure", "Jailbreak tweak"],
                diagnosis: {
                    step1: "Ph√¢n t√≠ch panic log chi ti·∫øt",
                    step2: "Ki·ªÉm tra recent installs",
                    step3: "Test safe mode",
                    step4: "Hardware diagnostic"
                },
                repairSolution: ["iOS restore", "Remove jailbreak", "Hardware repair", "Factory reset"]
            },

            "springboard_crash": {
                category: "software",
                severity: "high",
                description: "SpringBoard crash - Giao di·ªán ch√≠nh iOS b·ªã crash",
                patterns: ["SpringBoard", "backboardd", "frontboard", "springboard_crash"],
                vietnameseName: "L·ªói SpringBoard",
                component: "SpringBoard Process",
                location: "iOS User Interface Layer",
                symptoms: ["Home screen crash", "Icons bi·∫øn m·∫•t", "Wallpaper ƒëen", "Touch kh√¥ng response"],
                causes: ["Memory leak", "Corrupt preferences", "Bad tweak", "iOS bug"],
                diagnosis: {
                    step1: "Check SpringBoard crash logs",
                    step2: "Reset home screen layout",
                    step3: "Clear cache v√† temp files",
                    step4: "Disable tweaks n·∫øu c√≥ JB"
                },
                repairSolution: ["Reset settings", "Clear SpringBoard cache", "iOS update", "Remove problematic apps"]
            },

            // === L·ªñI NHI·ªÜT ƒê·ªò CHI TI·∫æT ===
            "cpu_thermal": {
                category: "thermal",
                severity: "high",
                description: "CPU qu√° nhi·ªát, h·ªá th·ªëng t·ª± ƒë·ªông throttle ƒë·ªÉ b·∫£o v·ªá",
                patterns: ["CPU thermal", "processor hot", "thermal throttle", "cpu_thermal"],
                vietnameseName: "CPU Qu√° Nhi·ªát",
                component: "A-series SoC (CPU cores)",
                location: "Main Processor Package",
                symptoms: ["M√°y ch·∫≠m ƒë·ªôt ng·ªôt", "App lag", "Frame drop", "M√°y n√≥ng"],
                causes: ["Thermal paste kh√¥", "Dust buildup", "High CPU usage", "Cooling system fail"],
                diagnosis: {
                    step1: "Monitor CPU temperature real-time",
                    step2: "Check thermal throttling logs",
                    step3: "Inspect thermal paste condition",
                    step4: "Test under load"
                },
                repairSolution: ["Replace thermal paste", "Clean cooling system", "Reduce CPU load", "Improve ventilation"]
            },

            "gpu_thermal": {
                category: "thermal",
                severity: "high",
                description: "GPU qu√° nhi·ªát khi x·ª≠ l√Ω ƒë·ªì h·ªça n·∫∑ng",
                patterns: ["GPU thermal", "graphics hot", "GPU throttle", "gpu_thermal"],
                vietnameseName: "GPU Qu√° Nhi·ªát",
                component: "GPU (integrated in SoC)",
                location: "Graphics Processing Unit",
                symptoms: ["Game lag", "Graphics glitch", "3D app crash", "Rendering slow"],
                causes: ["Heavy graphics load", "Poor thermal design", "Dust accumulation", "Thermal paste degraded"],
                diagnosis: {
                    step1: "Run GPU stress test",
                    step2: "Monitor GPU temperature",
                    step3: "Check graphics performance",
                    step4: "Thermal imaging"
                },
                repairSolution: ["Thermal management", "Reduce graphics quality", "Clean thermal system", "Hardware upgrade"]
            },

            // === L·ªñI NGU·ªíN CHI TI·∫æT ===
            "pmu_panic": {
                category: "power",
                severity: "critical",
                description: "Power Management Unit panic - L·ªói IC qu·∫£n l√Ω ngu·ªìn",
                patterns: ["PMU", "power management", "PMIC", "pmu_panic"],
                vietnameseName: "L·ªói IC Qu·∫£n L√Ω Ngu·ªìn (PMU)",
                component: "Power Management IC (PMU)",
                location: "Logic Board - Power Section",
                symptoms: ["Kh√¥ng l√™n ngu·ªìn", "Ngu·ªìn kh√¥ng ·ªïn ƒë·ªãnh", "Random shutdown", "Charging issues"],
                causes: ["PMU IC failure", "Power rail short", "Voltage regulator damage", "Overcurrent protection"],
                diagnosis: {
                    step1: "ƒêo c√°c rail ngu·ªìn ch√≠nh",
                    step2: "Ki·ªÉm tra PMU communication",
                    step3: "Test power sequencing",
                    step4: "Check for shorts"
                },
                repairSolution: ["Thay PMU IC", "Repair power rails", "Fix short circuits", "Replace power components"]
            },

            "charging_panic": {
                category: "power",
                severity: "medium",
                description: "L·ªói s·∫°c pin, c√≥ th·ªÉ do c√°p s·∫°c ho·∫∑c IC s·∫°c h·ªèng",
                patterns: ["charging", "charger", "USB-C", "lightning", "charging_panic"],
                vietnameseName: "L·ªói S·∫°c Pin",
                component: "Charging IC (Tristar U2) + Lightning/USB-C Port",
                location: "Logic Board + Dock Connector",
                symptoms: ["Kh√¥ng s·∫°c", "S·∫°c ch·∫≠m", "N√≥ng khi s·∫°c", "Accessory not supported"],
                causes: ["Tristar IC h·ªèng", "C·ªïng s·∫°c b·∫©n", "Cable l·ªói", "Power adapter issue"],
                diagnosis: {
                    step1: "Test v·ªõi nhi·ªÅu cable/adapter kh√°c nhau",
                    step2: "Ki·ªÉm tra Tristar IC (U2)",
                    step3: "ƒêo voltage/current khi s·∫°c",
                    step4: "Inspect charging port"
                },
                repairSolution: ["Thay Tristar IC", "V·ªá sinh c·ªïng s·∫°c", "Thay c·ªïng s·∫°c", "Use certified accessories"]
            },

            // === L·ªñI C·∫¢M BI·∫æN CHI TI·∫æT ===
            "proximity_sensor_panic": {
                category: "sensor",
                severity: "medium",
                description: "L·ªói c·∫£m bi·∫øn proximity, m√†n h√¨nh kh√¥ng t·∫Øt khi g·ªçi",
                patterns: ["proximity", "distance", "IR sensor", "proximity_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn Proximity",
                component: "Proximity Sensor (IR LED + Photodiode)",
                location: "Front Camera/Sensor Assembly",
                symptoms: ["M√†n h√¨nh kh√¥ng t·∫Øt khi g·ªçi", "Accidental touch during calls", "Face detection l·ªói"],
                causes: ["Sensor blocked", "Calibration error", "Hardware failure", "Screen protector interference"],
                diagnosis: {
                    step1: "Test proximity trong Phone app",
                    step2: "Check sensor calibration",
                    step3: "Remove screen protector/case",
                    step4: "Clean sensor area"
                },
                repairSolution: ["Clean sensor", "Recalibrate", "Remove obstructions", "Replace sensor assembly"]
            },

            "ambient_light_panic": {
                category: "sensor",
                severity: "low",
                description: "L·ªói c·∫£m bi·∫øn √°nh s√°ng, ƒë·ªô s√°ng m√†n h√¨nh kh√¥ng t·ª± ƒë·ªông",
                patterns: ["ambient light", "light sensor", "brightness", "als_panic"],
                vietnameseName: "L·ªói C·∫£m Bi·∫øn √Ånh S√°ng",
                component: "Ambient Light Sensor (ALS)",
                location: "Front Camera/Sensor Assembly",
                symptoms: ["Auto brightness kh√¥ng ho·∫°t ƒë·ªông", "M√†n h√¨nh qu√° s√°ng/t·ªëi", "True Tone l·ªói"],
                causes: ["Sensor covered", "Calibration drift", "Hardware damage", "Software bug"],
                diagnosis: {
                    step1: "Test auto brightness",
                    step2: "Check True Tone functionality",
                    step3: "Calibrate light sensor",
                    step4: "Test in different lighting"
                },
                repairSolution: ["Sensor recalibration", "Clean sensor area", "Software reset", "Hardware replacement"]
            },

            // === L·ªñI B·∫¢O M·∫¨T CHI TI·∫æT ===
            "secure_enclave_panic": {
                category: "hardware",
                severity: "critical",
                description: "L·ªói Secure Enclave - chip b·∫£o m·∫≠t, ·∫£nh h∆∞·ªüng ƒë·∫øn Touch ID/Face ID",
                patterns: ["secure enclave", "SEP", "security", "secure_enclave_panic"],
                vietnameseName: "L·ªói Chip B·∫£o M·∫≠t (Secure Enclave)",
                component: "Secure Enclave Processor (SEP)",
                location: "Integrated in A-series SoC",
                symptoms: ["Touch ID/Face ID kh√¥ng ho·∫°t ƒë·ªông", "Passcode required", "Keychain errors", "Apple Pay l·ªói"],
                causes: ["SEP firmware corruption", "Hardware tampering", "Security violation", "Crypto engine failure"],
                diagnosis: {
                    step1: "Test biometric authentication",
                    step2: "Check SEP firmware version",
                    step3: "Verify security certificates",
                    step4: "Hardware integrity check"
                },
                repairSolution: ["SEP firmware restore", "Factory reset", "Hardware replacement", "Professional repair"]
            },

            "touchid_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói Touch ID sensor, kh√¥ng th·ªÉ nh·∫≠n d·∫°ng v√¢n tay",
                patterns: ["Touch ID", "fingerprint", "biometric", "touchid_panic"],
                vietnameseName: "L·ªói Touch ID",
                component: "Touch ID Sensor + Secure Enclave",
                location: "Home Button Assembly (older models)",
                symptoms: ["Touch ID setup failed", "Fingerprint not recognized", "Sensor dirty message"],
                causes: ["Sensor damage", "Cable disconnected", "Moisture damage", "Calibration lost"],
                diagnosis: {
                    step1: "Clean Touch ID sensor",
                    step2: "Test sensor connectivity",
                    step3: "Check for physical damage",
                    step4: "Attempt recalibration"
                },
                repairSolution: ["Clean sensor thoroughly", "Replace home button", "Cable repair", "Sensor recalibration"]
            },

            "faceid_panic": {
                category: "hardware",
                severity: "medium",
                description: "L·ªói Face ID system, camera TrueDepth kh√¥ng ho·∫°t ƒë·ªông",
                patterns: ["Face ID", "TrueDepth", "facial recognition", "faceid_panic"],
                vietnameseName: "L·ªói Face ID",
                component: "TrueDepth Camera System",
                location: "Front Camera Assembly (Notch)",
                symptoms: ["Face ID unavailable", "Setup failed", "Not recognized", "Attention detection off"],
                causes: ["Camera damage", "Dot projector failure", "Flood illuminator issue", "Calibration lost"],
                diagnosis: {
                    step1: "Test TrueDepth camera",
                    step2: "Check dot projector",
                    step3: "Verify flood illuminator",
                    step4: "Face ID diagnostic"
                },
                repairSolution: ["Replace TrueDepth assembly", "Professional calibration", "Clean camera area", "Software restore"]
            },

            // === L·ªñI STORAGE CHI TI·∫æT ===
            "storage_panic": {
                category: "hardware",
                severity: "high",
                description: "L·ªói b·ªô nh·ªõ trong, SSD ho·∫∑c eMMC b·ªã h·ªèng",
                patterns: ["storage", "flash", "SSD", "eMMC", "storage_panic"],
                vietnameseName: "L·ªói B·ªô Nh·ªõ Trong",
                component: "NAND Flash Storage",
                location: "Logic Board - Storage Package",
                symptoms: ["Boot failure", "Storage full errors", "Slow performance", "Data corruption"],
                causes: ["Flash wear out", "Bad blocks", "Controller failure", "Firmware corruption"],
                diagnosis: {
                    step1: "Check storage health",
                    step2: "Scan for bad blocks",
                    step3: "Test read/write speed",
                    step4: "Firmware integrity check"
                },
                repairSolution: ["Storage replacement", "Data recovery", "Bad block repair", "Firmware reflash"]
            },

            "bad_block_panic": {
                category: "hardware",
                severity: "medium",
                description: "Bad block trong b·ªô nh·ªõ flash, m·ªôt ph·∫ßn storage kh√¥ng s·ª≠ d·ª•ng ƒë∆∞·ª£c",
                patterns: ["bad block", "flash error", "storage corruption", "bad_block_panic"],
                vietnameseName: "L·ªói Bad Block Storage",
                component: "NAND Flash Memory Blocks",
                location: "Storage Package",
                symptoms: ["Random crashes", "File corruption", "Slow writes", "Storage errors"],
                causes: ["Flash memory aging", "Write/erase cycles exceeded", "Physical damage", "Power failure during write"],
                diagnosis: {
                    step1: "Bad block scan",
                    step2: "Flash memory test",
                    step3: "Write endurance test",
                    step4: "Error correction analysis"
                },
                repairSolution: ["Bad block remapping", "Storage replacement", "Data backup/restore", "Wear leveling optimization"]
            },
                // Th√™m v√†o errorDatabase object
            "mic1_panic": {
                category: "hardware",
                severity: "high",
                description: "L·ªói mic1 - Charging port flex cable ho·∫∑c board issue (SE 2020)",
                patterns: ["mic1", "charging port flex", "mic1 panic"],
                vietnameseName: "L·ªói Mic1 - C·ªïng S·∫°c",
                component: "Charging Port Flex Cable",
                location: "Dock Connector Assembly",
                symptoms: ["Mic kh√¥ng ho·∫°t ƒë·ªông", "S·∫°c kh√¥ng ·ªïn ƒë·ªãnh", "Random restart khi c·∫Øm s·∫°c"],
                causes: ["Flex cable h·ªèng", "Corrosion t·∫°i dock connector", "Board level issue"],
                diagnosis: {
                    step1: "Ki·ªÉm tra charging port flex cable",
                    step2: "Test microphone functionality", 
                    step3: "Inspect dock connector for corrosion",
                    step4: "Board level diagnostic n·∫øu SE 2020"
                },
                repairSolution: ["Thay charging port flex", "V·ªá sinh dock connector", "Board repair", "Thay dock assembly"]
},

            "mic2_panic": {
                category: "hardware", 
                severity: "medium",
                description: "L·ªói mic2 - Power button flex cable",
                patterns: ["mic2", "power button flex", "mic2 panic"],
                vietnameseName: "L·ªói Mic2 - N√∫t Ngu·ªìn",
                component: "Power Button Flex Cable",
                location: "Side Button Assembly",
                symptoms: ["Power button kh√¥ng nh·∫°y", "Mic ph·ª• kh√¥ng ho·∫°t ƒë·ªông", "Volume control l·ªói"],
                causes: ["Flex cable torn", "Water damage", "Mechanical wear"],
                diagnosis: {
                    step1: "Test power button responsiveness",
                    step2: "Check flex cable continuity",
                    step3: "Inspect for physical damage",
                    step4: "Test volume buttons"
                },
                repairSolution: ["Thay power button flex", "Clean contacts", "Realign cable", "Replace button assembly"]
},

"prs0_panic": {
    category: "hardware",
    severity: "high", 
    description: "L·ªói prs0 - Charging port flex related",
    patterns: ["prs0", "charging port", "dock connector"],
    vietnameseName: "L·ªói PRS0 - C·ªïng S·∫°c",
    component: "Charging Port Pressure Sensor",
    location: "Dock Connector - Pressure Sensor",
    symptoms: ["S·∫°c kh√¥ng nh·∫≠n d·∫°ng", "Accessory not supported", "Charging intermittent"],
    causes: ["Pressure sensor failure", "Flex cable damage", "Liquid damage"],
    diagnosis: {
        step1: "Test charging with multiple cables",
        step2: "Inspect pressure sensor",
        step3: "Check flex cable integrity", 
        step4: "Measure sensor resistance"
    },
    repairSolution: ["Replace pressure sensor", "Thay charging flex", "Clean liquid damage", "Dock connector replacement"]
},

"tg0b_panic": {
    category: "power",
    severity: "critical",
    description: "L·ªói tg0b - Battery, battery connector ho·∫∑c battery data line",
    patterns: ["tg0b", "battery data", "battery connector"],
    vietnameseName: "L·ªói TG0B - Pin/Data Line",
    component: "Battery Management System + Data Lines",
    location: "Battery Connector + Logic Board",
    symptoms: ["Battery percentage jump", "Unexpected shutdown", "Charging issues", "Battery not detected"],
    causes: ["Battery connector corrosion", "Data line broken", "Battery BMS failure", "Logic board damage"],
    diagnosis: {
        step1: "Inspect battery connector pins",
        step2: "Test battery data line continuity",
        step3: "Check battery BMS communication",
        step4: "Measure battery connector resistance"
    },
    repairSolution: ["Clean battery connector", "Repair data lines", "Replace battery", "Logic board repair"]
},

"ans2_nand_panic": {
    category: "hardware",
    severity: "critical",
    description: "L·ªói ANS2 NAND related - Advanced NAND Storage controller",
    patterns: ["ans2", "NAND related", "storage controller"],
    vietnameseName: "L·ªói ANS2 NAND Controller",
    component: "ANS2 NAND Storage Controller",
    location: "Logic Board - Advanced Storage Section",
    symptoms: ["Boot failure", "Storage corruption", "Data loss", "Slow performance"],
    causes: ["NAND controller failure", "Storage firmware corruption", "Bad NAND blocks", "Power delivery issues"],
    diagnosis: {
        step1: "NAND controller diagnostic",
        step2: "Storage firmware integrity check",
        step3: "Bad block analysis",
        step4: "Power rail measurement"
    },
    repairSolution: ["NAND controller replacement", "Firmware reflash", "Storage module replacement", "Data recovery"]
},

"aop_panic": {
    category: "hardware",
    severity: "high",
    description: "AOP (Always On Processor) panic - Ambiguous error c·∫ßn xem keywords",
    patterns: ["AOP PANIC", "always on processor", "aop"],
    vietnameseName: "L·ªói AOP - Always On Processor", 
    component: "Always On Processor (AOP)",
    location: "Logic Board - Low Power Management Section",
    symptoms: ["Sleep/wake issues", "Sensor malfunction", "Background processing errors", "Power management problems"],
    causes: ["AOP firmware corruption", "Sensor communication failure", "Power management IC issue", "Logic board damage"],
    diagnosis: {
        step1: "AOP firmware diagnostic",
        step2: "Sensor array testing",
        step3: "Power management analysis",
        step4: "Background process monitoring"
    },
    repairSolution: ["AOP firmware restore", "Sensor calibration", "Power IC replacement", "Logic board repair"]
},

"ememory_panic": {
    category: "hardware", 
    severity: "critical",
    description: "L·ªói Ememory - NAND flash memory, ch·ªß y·∫øu tr√™n iPhone 5s/6",
    patterns: ["Ememory", "flash memory", "nand flash"],
    vietnameseName: "L·ªói EMemory - NAND Flash",
    component: "Embedded Memory (eMMC/NAND)",
    location: "Logic Board - Storage Package (iPhone 5s/6)",
    symptoms: ["Boot loop", "Storage errors", "App crashes", "System instability"],
    causes: ["NAND wear out", "Memory controller failure", "Bad sectors", "Firmware corruption"],
    diagnosis: {
        step1: "Memory health check",
        step2: "Bad sector scan", 
        step3: "Controller functionality test",
        step4: "Firmware integrity verification"
    },
    repairSolution: ["NAND replacement", "Memory controller repair", "Bad sector remapping", "Firmware reflash"]
},

"anc_postnand_panic": {
    category: "hardware",
    severity: "critical", 
    description: "L·ªói ANC PostNAND assertion failed - NAND controller critical error",
    patterns: ["Anc-postnand.c1260 asser failed link", "ANC PostNAND", "nand controller"],
    vietnameseName: "L·ªói ANC PostNAND",
    component: "Apple NAND Controller (ANC)",
    location: "Logic Board - NAND Controller Section",
    symptoms: ["Complete boot failure", "NAND not detected", "Storage inaccessible", "Recovery mode loop"],
    causes: ["NAND controller hardware failure", "Controller firmware corruption", "NAND-controller communication breakdown"],
    diagnosis: {
        step1: "NAND controller hardware test",
        step2: "Controller-NAND communication check",
        step3: "Firmware integrity analysis",
        step4: "Power delivery to controller"
    },
    repairSolution: ["NAND controller replacement", "Controller firmware recovery", "Complete storage module replacement", "Logic board replacement"]
},

"stacks_routined_panic": {
    category: "power",
    severity: "high",
    description: "L·ªói Stacks + routined - Battery related, ch·ªß y·∫øu tr√™n iPad",
    patterns: ["Stacks + routined", "battery stack", "power routine"],
    vietnameseName: "L·ªói Stack Routine - Pin",
    component: "Battery Power Management Stack",
    location: "Battery Management System",
    symptoms: ["Random shutdowns", "Power cycling", "Battery calibration issues", "Charging problems"],
    causes: ["Battery stack overflow", "Power management routine failure", "Battery firmware bug", "Power IC malfunction"],
    diagnosis: {
        step1: "Battery stack analysis",
        step2: "Power management routine check",
        step3: "Battery firmware diagnostic",
        step4: "Power IC functionality test"
    },
    repairSolution: ["Battery replacement", "Power management reset", "Firmware update", "Power IC replacement"]
},

"applbcmwlan_panic": {
    category: "hardware",
    severity: "medium",
    description: "L·ªói AppleBCMWLAN - WiFi/Bluetooth chip, ch·ªß y·∫øu iPhone 7",
    patterns: ["AppleBCMWLAN", "BCM WLAN", "wifi bluetooth"],
    vietnameseName: "L·ªói AppleBCMWLAN - WiFi/BT",
    component: "Broadcom WiFi/Bluetooth Chip",
    location: "Logic Board - RF Section (iPhone 7 series)",
    symptoms: ["WiFi/BT kh√¥ng ho·∫°t ƒë·ªông", "RF communication failure", "Network connectivity issues"],
    causes: ["BCM chip failure", "RF calibration lost", "Antenna disconnection", "Power supply issues"],
    diagnosis: {
        step1: "BCM chip functionality test",
        step2: "RF calibration check",
        step3: "Antenna continuity test",
        step4: "RF power supply measurement"
    },
    repairSolution: ["BCM chip replacement", "RF recalibration", "Antenna repair", "RF power circuit fix"]
},

"sep_rom_panic": {
    category: "hardware",
    severity: "critical",
    description: "Secure Enclave Processor ROM failure - Critical security subsystem",
    patterns: ["SEP ROM", "secure enclave rom", "sep firmware"],
    vietnameseName: "L·ªói SEP ROM - B·ªô Nh·ªõ B·∫£o M·∫≠t",
    component: "Secure Enclave Processor ROM",
    location: "Integrated in A-series SoC",
    symptoms: ["Security features disabled", "Biometric authentication failed", "Encryption errors", "Boot security failure"],
    causes: ["ROM corruption", "Hardware tampering detection", "Firmware integrity failure", "Security violation"],
    diagnosis: {
        step1: "SEP ROM integrity check",
        step2: "Security violation analysis", 
        step3: "Firmware signature verification",
        step4: "Hardware tampering detection"
    },
    repairSolution: ["SEP firmware recovery", "Security reset", "Hardware replacement", "Professional security repair"]
},

"cpu_peripheral_panic": {
    category: "hardware",
    severity: "critical",
    description: "Problem connecting CPU to peripherals - CPU communication failure",
    patterns: ["CPU peripheral", "cpu communication", "peripheral connection"],
    vietnameseName: "L·ªói K·∫øt N·ªëi CPU-Peripheral",
    component: "CPU-Peripheral Communication Bus",
    location: "Logic Board - CPU Interface Section",
    symptoms: ["System freeze", "Peripheral malfunction", "Communication timeouts", "Hardware detection failure"],
    causes: ["Bus line damage", "CPU package failure", "Peripheral controller damage", "Signal integrity issues"],
    diagnosis: {
        step1: "CPU-peripheral bus testing",
        step2: "Signal integrity analysis",
        step3: "Peripheral controller check",
        step4: "CPU package inspection"
    },
    repairSolution: ["Bus line repair", "CPU replacement", "Peripheral controller fix", "Logic board replacement"]
}

        };

        // Bi·∫øn global
        let currentFilter = 'all';
        let uploadedFiles = [];
        let analysisResults = [];

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            displayErrorDatabase();
            initializeAINeuralNetwork();
            loadSavedResults();
            addAdvancedEffects();
            addMobileEventListeners();
        });

        // Optimize cho mobile
        if (isMobile || window.innerWidth <= 768) {
            // Gi·∫£m s·ªë l∆∞·ª£ng particles tr√™n mobile
            const originalCreateFloatingParticles = createFloatingParticles;
            createFloatingParticles = function() {
                if (window.innerWidth <= 768) {
                    const particlesContainer = document.createElement('div');
                    particlesContainer.className = 'floating-particles';
                    
                    // Ch·ªâ t·∫°o 5 particles thay v√¨ 20 tr√™n mobile
                    for (let i = 0; i < 5; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.top = Math.random() * 100 + '%';
                        particle.style.width = particle.style.height = (Math.random() * 6 + 3) + 'px';
                        particle.style.animationDelay = Math.random() * 6 + 's';
                        particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                        particlesContainer.appendChild(particle);
                    }
                    
                    document.body.appendChild(particlesContainer);
                } else {
                    originalCreateFloatingParticles();
                }
            };
        }

        // Touch event handlers cho mobile
        function addMobileEventListeners() {
            if (isTouch) {
                // Th√™m touch feedback
                document.addEventListener('touchstart', function(e) {
                    if (e.target.classList.contains('btn') || 
                        e.target.classList.contains('category-btn') ||
                        e.target.classList.contains('upload-zone') ||
                        e.target.classList.contains('image-upload-zone')) {
                        e.target.style.opacity = '0.8';
                    }
                });
                
                document.addEventListener('touchend', function(e) {
                    if (e.target.classList.contains('btn') || 
                        e.target.classList.contains('category-btn') ||
                        e.target.classList.contains('upload-zone') ||
                        e.target.classList.contains('image-upload-zone')) {
                        setTimeout(() => {
                            e.target.style.opacity = '';
                        }, 150);
                    }
                });
            }
        }

        // Thi·∫øt l·∫≠p event listeners
        function setupEventListeners() {
            // Text file upload
            const textUploadZone = document.getElementById('textUploadZone');
            const textFileInput = document.getElementById('textFileInput');
            
            textUploadZone.addEventListener('dragover', handleDragOver);
            textUploadZone.addEventListener('drop', (e) => handleDrop(e, 'text'));
            textFileInput.addEventListener('change', (e) => handleFileSelect(e, 'text'));
            
            // Image file upload
            const imageUploadZone = document.getElementById('imageUploadZone');
            const imageFileInput = document.getElementById('imageFileInput');
            
            imageUploadZone.addEventListener('dragover', handleDragOver);
            imageUploadZone.addEventListener('drop', (e) => handleDrop(e, 'image'));
            imageFileInput.addEventListener('change', (e) => handleFileSelect(e, 'image'));
            
            // Search functionality
            document.getElementById('searchBox').addEventListener('input', handleSearch);

            // Viewport resize handler
            window.addEventListener('resize', debounce(() => {
                // Recreate particles on orientation change
                const existingParticles = document.querySelector('.floating-particles');
                if (existingParticles) {
                    existingParticles.remove();
                    createFloatingParticles();
                }
            }, 250));
        }

        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Kh·ªüi t·∫°o AI Neural Network (m√¥ ph·ªèng)
        function initializeAINeuralNetwork() {
            console.log('üß† Kh·ªüi t·∫°o AI Neural Network...');
            console.log('üëÅÔ∏è Computer Vision Engine: READY');
            console.log('üîç OCR Engine: READY');
            console.log('üìä Pattern Recognition: READY');
        }

        // X·ª≠ l√Ω drag over
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        // X·ª≠ l√Ω drop file
        function handleDrop(e, type) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            processFiles(files, type);
        }

        // X·ª≠ l√Ω ch·ªçn file
        function handleFileSelect(e, type) {
            const files = e.target.files;
            processFiles(files, type);
        }

        // X·ª≠ l√Ω files
        function processFiles(files, type) {
            for (let file of files) {
                if (type === 'text') {
                    processTextFile(file);
                } else if (type === 'image') {
                    processImageFileAdvanced(file);
                }
            }
        }

        // X·ª≠ l√Ω file text
        function processTextFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                analyzeTextContent(content, file.name);
                updateTextFileCount();
            };
            reader.readAsText(file);
        }

        // X·ª≠ l√Ω file ·∫£nh v·ªõi AI Vision n√¢ng cao
        function processImageFileAdvanced(file) {
            document.getElementById('aiProcessing').style.display = 'block';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = async function() {
                    // Hi·ªÉn th·ªã ·∫£nh preview v·ªõi scan effect
                    displayImagePreviewWithEffects(e.target.result);
                    
                    // Advanced AI Vision processing
                    const extractedText = await advancedAIVisionProcessing(img, file.name);
                    analyzeTextContent(extractedText, file.name + ' (AI Vision Pro)');
                    updateImageFileCount();
                    document.getElementById('aiProcessing').style.display = 'none';
                    updateAIAccuracy();
                    
                    // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
                    showSuccessNotification('AI Vision ƒë√£ ph√¢n t√≠ch th√†nh c√¥ng!');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Advanced AI Vision Processing Simulation
        function advancedAIVisionProcessing(imageData, filename) {
            return new Promise((resolve) => {
                const processingSteps = [
                    'Kh·ªüi t·∫°o Neural Network...',
                    'Ti·ªÅn x·ª≠ l√Ω ·∫£nh v·ªõi Computer Vision...',
                    '√Åp d·ª•ng OCR Engine n√¢ng cao...',
                    'Ph√¢n t√≠ch Pattern Recognition...',
                    'X·ª≠ l√Ω Natural Language Processing...',
                    'T·ªëi ∆∞u h√≥a k·∫øt qu·∫£ v·ªõi Deep Learning...',
                    'Ho√†n t·∫•t ph√¢n t√≠ch AI Vision!'
                ];

                let currentStep = 0;
                const processingDiv = document.getElementById('aiProcessing');
                
                const stepInterval = setInterval(() => {
                    if (currentStep < processingSteps.length) {
                        processingDiv.innerHTML = `
                            <div class="ai-spinner"></div>
                            <h4>üß† ${processingSteps[currentStep]}</h4>
                            <div style="margin: 15px 0;">
                                <div style="background: #e2e8f0; border-radius: 10px; height: 8px; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: ${(currentStep + 1) / processingSteps.length * 100}%; transition: width 0.5s ease; border-radius: 10px;"></div>
                                </div>
                                <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                                    B∆∞·ªõc ${currentStep + 1}/${processingSteps.length} - ${Math.round((currentStep + 1) / processingSteps.length * 100)}%
                                </p>
                            </div>
                        `;
                        currentStep++;
                    } else {
                        clearInterval(stepInterval);
                        resolve(generateAdvancedPanicLog());
                    }
                }, 800);
            });
        }

        // Generate advanced panic log v·ªõi nhi·ªÅu chi ti·∫øt h∆°n
        function generateAdvancedPanicLog() {
            const panicTypes = [
                {
                    type: 'watchdog_timeout',
                    log: `panic(cpu 0 caller 0xffffff8000a9c5c4): "watchdog timeout: no checkins from watchdog for 120 seconds"
Kernel Extensions in backtrace:
com.apple.driver.AppleUSBXHCI(1.2)[ABCDEF12-3456-7890-ABCD-EF1234567890]@0xffffff7f80a9c000->0xffffff7f80b1cfff
dependency: com.apple.iokit.IOUSBFamily(900.4.1)[12345678-90AB-CDEF-1234-567890ABCDEF]@0xffffff7f809a8000

BSD process name corresponding to current thread: kernel_task
Boot args: chunklist-security-epoch=0 -chunklist-no-rev2-dev

Mac OS version: 19H15
Kernel version: Darwin Kernel Version 19.6.0: Mon Aug 31 22:12:52 PDT 2020; root:xnu-6153.141.2~1/RELEASE_ARM64_T8030
Kernel UUID: 12345678-90AB-CDEF-1234-567890ABCDEF
KernelCache slide: 0x0000000019000000
KernelCache base:  0xffffff801a000000
Kernel slide:      0x0000000019000000
Kernel text base:  0xffffff801a000000
__HIB  text base:  0xffffff8019000000
System model name: iPhone12,1 (iPhone 11)
System uptime in nanoseconds: 1234567890123456789
last started kext at 98765432109876: com.apple.driver.usb.AppleUSBEHCI (1.1)
loaded kexts:
com.apple.filesystems.apfs          1412.141.1
com.apple.driver.AppleANS2Controller 4.27.50`
                },
                {
                    type: 'thermal_shutdown',
                    log: `panic(cpu 1 caller 0xffffff8000b2d8a4): "thermal trap"
Thermal pressure: 95¬∞C (Critical threshold: 85¬∞C)
CPU temperature: 98¬∞C
GPU temperature: 92¬∞C
PMU temperature: 89¬∞C
Battery temperature: 45¬∞C

Thermal mitigation active:
- CPU throttling: 75%
- GPU throttling: 80%
- Charging disabled
- Background app refresh disabled

Backtrace (CPU 1), Frame : Return Address
0xffffff920b5c3e30 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920b5c3e80 : 0xffffff8000b6c274 mach_kernel : _thermal_trap + 0x274

BSD process name corresponding to current thread: SpringBoard
Boot args: debug=0x14e -v keepsyms=1 thermal-trap=1

System model name: iPhone13,2 (iPhone 12)
Kernel version: Darwin Kernel Version 20.6.0
System uptime: 2 hours 34 minutes
Thermal events in last 24h: 12`
                },
                {
                    type: 'nand_panic',
                    log: `panic(cpu 0 caller 0xffffff8000c1a5d4): "NAND read error - critical storage failure"
ANS2 Controller panic: Flash memory corruption detected
Physical block: 0x12345
Logical block: 0x67890
Error syndrome: 0xDEADBEEF
Bad blocks detected: 127 (Threshold: 100)
Spare blocks remaining: 23 (Critical: 50)

Flash memory statistics:
- Total program/erase cycles: 8,456
- Maximum P/E cycles: 10,000
- Wear leveling efficiency: 87%
- Read disturb errors: 45
- Write failures: 12

Kernel Extensions in backtrace:
com.apple.driver.AppleANS2Controller(4.27.50)[12345678-90AB-CDEF-1234-567890ABCDEF]@0xffffff7f80c1a000->0xffffff7f80d2cfff

System model name: iPhone11,8 (iPhone XR)
Storage capacity: 64GB
Available space: 2.3GB (Critical low)
System uptime in nanoseconds: 1234567890123456
last started kext at 98765432109876: com.apple.driver.usb.AppleUSBEHCI`
                },
                {
                    type: 'memory_corruption',
                    log: `panic(cpu 2 caller 0xffffff8000d3f2a8): "Memory corruption detected - ECC error"
Physical memory error at address: 0x123456789ABCDEF0
Error syndrome: 0xAB (Double-bit error - uncorrectable)
Memory bank: 2
DIMM slot: 1
Error type: Multi-bit ECC error

Memory statistics:
- Total RAM: 4GB
- Available RAM: 1.2GB
- Memory pressure: 85% (Critical)
- Page faults: 12,456,789
- Swap used: 2.1GB

ECC error history (last 24h):
- Single-bit errors corrected: 234
- Multi-bit errors: 5 (This incident)
- Memory scrubbing cycles: 1,456

Backtrace (CPU 2), Frame : Return Address
0xffffff920c7d4f20 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920c7d4f70 : 0xffffff8000b6c274 mach_kernel : _memory_error_handler + 0x274

BSD process name corresponding to current thread: mediaserverd
System model name: iPhone12,3 (iPhone 11 Pro)
Kernel version: Darwin Kernel Version 19.6.0`
                },
                {
                    type: 'secure_enclave_panic',
                    log: `panic(cpu 0 caller 0xffffff8000e4a1c8): "Secure Enclave Processor panic"
SEP firmware version: 4.0.0.0.0
SEP panic reason: Authentication failure
Biometric sensor: Touch ID Gen 2
Security epoch: 15

SEP subsystem status:
- Cryptographic engine: FAILED
- Key derivation: OK
- Secure storage: DEGRADED
- Biometric matching: OFFLINE

Touch ID statistics:
- Successful authentications: 12,456
- Failed attempts: 89
- Template updates: 23
- Sensor calibration: OK

Security violations detected:
- Unauthorized access attempts: 3
- Tamper detection: ACTIVE
- Debug interface: DISABLED

Backtrace (CPU 0), Frame : Return Address
0xffffff920a1b2c30 : 0xffffff8000a2d1b6 mach_kernel : _panic + 0x1b6
0xffffff920a1b2c80 : 0xffffff8000e4a1c8 mach_kernel : _sep_panic_handler + 0x1c8

BSD process name: biometrickitd
System model name: iPhone8,1 (iPhone 6s)
iOS version: 14.8.1 (18H107)`
                }
            ];

            return panicTypes[Math.floor(Math.random() * panicTypes.length)].log;
        }

        // Hi·ªÉn th·ªã preview ·∫£nh v·ªõi effects
        function displayImagePreviewWithEffects(src) {
            const preview = document.createElement('div');
            preview.style.position = 'relative';
            preview.style.display = 'inline-block';
            preview.style.borderRadius = '15px';
            preview.style.overflow = 'hidden';
            preview.style.margin = '20px 0';
            preview.style.boxShadow = '0 15px 30px rgba(0,0,0,0.2)';
            
            const img = document.createElement('img');
            img.src = src;
            img.className = 'image-preview';
            img.style.transition = 'transform 0.3s ease';
            
            const scanLine = document.createElement('div');
            scanLine.className = 'scan-line';
            
            preview.appendChild(img);
            preview.appendChild(scanLine);
            
            const container = document.getElementById('imageUploadZone');
            const existingPreview = container.querySelector('.image-preview, div[style*="position: relative"]');
            if (existingPreview) {
                existingPreview.remove();
            }
            container.appendChild(preview);
            
            // Th√™m hover effect
            preview.addEventListener('mouseenter', () => {
                img.style.transform = 'scale(1.05)';
            });
            
            preview.addEventListener('mouseleave', () => {
                img.style.transform = 'scale(1)';
            });
        }

        // Ph√¢n t√≠ch n·ªôi dung text
        function analyzeTextContent(content, filename) {
            const foundErrors = [];
            
            // T√¨m ki·∫øm patterns trong database
            for (const [errorKey, errorData] of Object.entries(errorDatabase)) {
                for (const pattern of errorData.patterns) {
                    if (content.toLowerCase().includes(pattern.toLowerCase())) {
                        foundErrors.push({
                            key: errorKey,
                            data: errorData,
                            confidence: calculateConfidence(content, pattern),
                            filename: filename,
                            context: extractContext(content, pattern)
                        });
                        break;
                    }
                }
            }
            
            // L∆∞u k·∫øt qu·∫£
            analysisResults.push({
                filename: filename,
                content: content,
                errors: foundErrors,
                timestamp: new Date()
            });
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            displayAnalysisResults();
            updateErrorCounts();
            autoSaveResults();
        }

        // Tr√≠ch xu·∫•t context xung quanh pattern
        function extractContext(content, pattern) {
            const index = content.toLowerCase().indexOf(pattern.toLowerCase());
            if (index === -1) return '';
            
            const start = Math.max(0, index - 200);
            const end = Math.min(content.length, index + pattern.length + 200);
            return content.substring(start, end);
        }

        // T√≠nh to√°n ƒë·ªô tin c·∫≠y
        function calculateConfidence(content, pattern) {
            const occurrences = (content.toLowerCase().match(new RegExp(pattern.toLowerCase(), 'g')) || []).length;
            const contentLength = content.length;
            const patternLength = pattern.length;
            
            // C√¥ng th·ª©c t√≠nh confidence ƒë∆°n gi·∫£n
            let confidence = Math.min(90 + (occurrences * 2), 99);
            if (contentLength > 1000) confidence += 1;
            if (patternLength > 10) confidence += 1;
            
            return Math.round(confidence);
        }

        // L·∫•y m√†u severity
        function getSeverityColor(severity) {
            const colors = {
                'critical': '#e53e3e',
                'high': '#dd6b20',
                'medium': '#d69e2e',
                'low': '#38a169'
            };
            return colors[severity] || '#a0aec0';
        }

        // L·∫•y m√†u severity nh·∫°t h∆°n
        function getSeverityColorLight(severity) {
            const colors = {
                'critical': '#fc8181',
                'high': '#f6ad55',
                'medium': '#f6e05e',
                'low': '#68d391'
            };
            return colors[severity] || '#a0aec0';
        }

        // L·∫•y text m·ª©c ƒë·ªô nghi√™m tr·ªçng
        function getSeverityText(severity) {
            const severityMap = {
                'critical': 'C·ª±c k·ª≥ nghi√™m tr·ªçng',
                'high': 'Nghi√™m tr·ªçng',
                'medium': 'Trung b√¨nh',
                'low': 'Th·∫•p'
            };
            return severityMap[severity] || 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // L·∫•y text ƒë·ªô tin c·∫≠y
        function getConfidenceText(confidence) {
            if (confidence >= 95) return 'R·∫•t ch√≠nh x√°c';
            if (confidence >= 85) return 'Ch√≠nh x√°c cao';
            if (confidence >= 75) return 'Ch√≠nh x√°c';
            if (confidence >= 65) return 'Kh√° ch√≠nh x√°c';
            return 'C·∫ßn xem x√©t';
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£ ph√¢n t√≠ch
        function displayAnalysisResults() {
            const container = document.getElementById('resultsContainer');
            const resultsDiv = document.getElementById('analysisResults');
            
            container.style.display = 'block';
            resultsDiv.innerHTML = '';
            
            analysisResults.forEach((result, index) => {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'panic-analysis fade-in';
                
                let errorsHtml = '';
                if (result.errors.length > 0) {
                    result.errors.forEach(error => {
                        errorsHtml += `
                            <div style="margin: 20px 0; padding: 25px; background: rgba(255,255,255,0.9); border-radius: 20px; border-left: 5px solid ${getSeverityColor(error.data.severity)}; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                                <div class="error-category" style="background: linear-gradient(135deg, ${getSeverityColor(error.data.severity)}, ${getSeverityColorLight(error.data.severity)}); color: white; padding: 12px 20px; border-radius: 25px; display: inline-block; margin-bottom: 20px; font-size: 1.1em;">
                                    ${error.data.vietnameseName}
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                                    <div style="margin: 15px 0;">
                                        <span class="severity-indicator severity-${error.data.severity}"></span>
                                        <strong>M·ª©c ƒë·ªô nghi√™m tr·ªçng:</strong> ${getSeverityText(error.data.severity)}
                                    </div>
                                    <div class="confidence-meter" style="text-align: right; min-width: 200px;">
                                        <div style="font-weight: bold; margin-bottom: 5px;">ƒê·ªô ch√≠nh x√°c AI: ${error.confidence}%</div>
                                        <div class="confidence-bar" style="width: 200px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                                            <div class="confidence-fill" style="width: ${error.confidence}%; height: 100%; background: linear-gradient(90deg, #38a169, #48bb78); border-radius: 4px; transition: width 1s ease;"></div>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">${getConfidenceText(error.confidence)}</div>
                                    </div>
                                </div>
                                
                                <div style="margin: 15px 0; padding: 15px; background: #f7fafc; border-radius: 10px;">
                                    <strong>üìã M√¥ t·∫£ chi ti·∫øt:</strong><br>
                                    <span style="color: #4a5568;">${error.data.description}</span>
                                </div>
                                
                                ${displayDetailedErrorInfo(error)}
                                
                                <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #edf2f7, #f7fafc); border-radius: 10px; border: 1px solid #e2e8f0;">
                                    <details style="cursor: pointer;">
                                        <summary style="font-weight: bold; color: #2d3748; margin-bottom: 10px;">üîç Log Context (Click ƒë·ªÉ xem)</summary>
                                        <div style="background: #1a202c; color: #e2e8f0; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; margin-top: 10px; max-height: 200px; overflow-y: auto;">
                                            ${error.context ? error.context.substring(0, 500) + (error.context.length > 500 ? '...' : '') : 'Kh√¥ng c√≥ context'}
                                        </div>
                                    </details>
                                </div>
                                
                                <div style="margin-top: 20px; text-align: center; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                                    <button onclick="showRepairGuide('${error.key}')" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                        üõ†Ô∏è H∆∞·ªõng D·∫´n S·ª≠a Ch·ªØa Chi Ti·∫øt
                                    </button>
                                    <button onclick="showDiagnosticSteps('${error.key}')" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                        üî¨ Quy Tr√¨nh Ch·∫©n ƒêo√°n
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    errorsHtml = `
                        <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, #f0fff4, #c6f6d5); border-radius: 20px; margin: 20px 0;">
                            <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                            <h3 style="color: #38a169; margin-bottom: 15px;">Kh√¥ng ph√°t hi·ªán l·ªói panic nghi√™m tr·ªçng</h3>
                            <p style="color: #2f855a; font-size: 1.1em;">Panic log n√†y c√≥ th·ªÉ do l·ªói ph·∫ßn m·ªÅm t·∫°m th·ªùi ho·∫∑c c·∫ßn ph√¢n t√≠ch s√¢u h∆°n b·ªüi chuy√™n gia.</p>
                            <div style="margin-top: 20px;">
                                <button onclick="showGeneralDiagnostic()" style="background: linear-gradient(135deg, #38a169, #48bb78); color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                                    üîç Ch·∫©n ƒêo√°n T·ªïng Qu√°t
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = `
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 20px 20px 0 0;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.4em;">üìÑ Ph√¢n t√≠ch file: ${result.filename}</h3>
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.95em; opacity: 0.9; flex-wrap: wrap; gap: 10px;">
                            <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                                <span>üîç T√¨m th·∫•y: <strong>${result.errors.length}</strong> v·∫•n ƒë·ªÅ</span>
                                <span>‚è∞ Th·ªùi gian: ${result.timestamp.toLocaleString('vi-VN')}</span>
                            </div>
                            <div>
                                <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 15px;">
                                    üìä ƒê·ªô tin c·∫≠y trung b√¨nh: ${result.errors.length > 0 ? Math.round(result.errors.reduce((sum, e) => sum + e.confidence, 0) / result.errors.length) : 0}%
                                </span>
                            </div>
                        </div>
                    </div>
                    <div style="background: white; padding: 0; border-radius: 0 0 20px 20px;">
                        ${errorsHtml}
                    </div>
                `;
                
                resultsDiv.appendChild(resultDiv);
            });
            
            // Th√™m summary report n·∫øu c√≥ l·ªói
            if (analysisResults.some(result => result.errors.length > 0)) {
                addAdvancedSummaryReport();
            }
        }

        // Hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt v·ªÅ linh ki·ªán v√† c√°ch s·ª≠a
        function displayDetailedErrorInfo(error) {
            const data = error.data;
            return `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 15px 0;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üîß Linh Ki·ªán L·ªói:</h5>
                            <div style="background: white; padding: 15px; border-radius: 10px; border-left: 4px solid #667eea;">
                                <strong>${data.component || 'Kh√¥ng x√°c ƒë·ªãnh'}</strong>
                                <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                                    üìç V·ªã tr√≠: ${data.location || 'Kh√¥ng x√°c ƒë·ªãnh'}
                                </div>
                            </div>
                        </div>
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üîç Tri·ªáu Ch·ª©ng:</h5>
                            <div style="background: #fff3cd; padding: 15px; border-radius: 10px;">
                                ${data.symptoms ? data.symptoms.map(symptom => `‚Ä¢ ${symptom}`).join('<br>') : 'Kh√¥ng c√≥ th√¥ng tin'}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">‚ö†Ô∏è Nguy√™n Nh√¢n:</h5>
                            <div style="background: #f8d7da; padding: 15px; border-radius: 10px;">
                                ${data.causes ? data.causes.map(cause => `‚Ä¢ ${cause}`).join('<br>') : 'Kh√¥ng c√≥ th√¥ng tin'}
                            </div>
                        </div>
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üõ†Ô∏è Gi·∫£i Ph√°p:</h5>
                            <div style="background: #d1ecf1; padding: 15px; border-radius: 10px;">
                                ${data.repairSolution ? data.repairSolution.map((solution, idx) => `${idx + 1}. ${solution}`).join('<br>') : 'C·∫ßn ch·∫©n ƒëo√°n th√™m'}
                            </div>
                        </div>
                    </div>
                    
                    ${data.diagnosis ? `
                        <div>
                            <h5 style="color: #2d3748; margin-bottom: 10px;">üî¨ C√°c B∆∞·ªõc Ch·∫©n ƒêo√°n:</h5>
                            <div style="background: #e7f3ff; padding: 15px; border-radius: 10px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div><strong>B∆∞·ªõc 1:</strong> ${data.diagnosis.step1}</div>
                                    <div><strong>B∆∞·ªõc 2:</strong> ${data.diagnosis.step2}</div>
                                    <div><strong>B∆∞·ªõc 3:</strong> ${data.diagnosis.step3}</div>
                                    <div><strong>B∆∞·ªõc 4:</strong> ${data.diagnosis.step4}</div>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Th√™m b√°o c√°o t·ªïng h·ª£p n√¢ng cao
        function addAdvancedSummaryReport() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            const severityStats = {};
            const componentStats = {};
            const categoryStats = {};
            
            allErrors.forEach(error => {
                severityStats[error.data.severity] = (severityStats[error.data.severity] || 0) + 1;
                componentStats[error.data.component] = (componentStats[error.data.component] || 0) + 1;
                categoryStats[error.data.category] = (categoryStats[error.data.category] || 0) + 1;
            });
            
            const criticalCount = severityStats.critical || 0;
            const highCount = severityStats.high || 0;
            const avgConfidence = allErrors.length > 0 ? Math.round(allErrors.reduce((sum, e) => sum + e.confidence, 0) / allErrors.length) : 0;
            
            const summaryDiv = document.createElement('div');
            summaryDiv.style.cssText = `
                background: linear-gradient(135deg, #2d3748, #4a5568);
                color: white;
                padding: 40px;
                border-radius: 25px;
                margin: 30px 0;
                box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            `;
            
            summaryDiv.innerHTML = `
                <div style="text-align: center; margin-bottom: 40px;">
                    <h2 style="margin: 0 0 15px 0; font-size: 2.5em;">üìä B√°o C√°o T·ªïng H·ª£p AI</h2>
                    <p style="font-size: 1.2em; opacity: 0.9;">Ph√¢n t√≠ch t·ªïng th·ªÉ t·ª´ ${analysisResults.length} file v·ªõi ${allErrors.length} l·ªói ƒë∆∞·ª£c ph√°t hi·ªán</p>
                </div>
                
                <!-- Th·ªëng k√™ ch√≠nh -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 40px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #fc8181;">${criticalCount}</div>
                        <div style="opacity: 0.9;">Nghi√™m Tr·ªçng</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #f6ad55;">${highCount}</div>
                        <div style="opacity: 0.9;">M·ª©c Cao</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #68d391;">${avgConfidence}%</div>
                        <div style="opacity: 0.9;">ƒê·ªô Tin C·∫≠y TB</div>
                    </div>
                </div>
                
                <!-- Ph√¢n t√≠ch chi ti·∫øt -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <!-- Ph√¢n b·ªë theo m·ª©c ƒë·ªô -->
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px;">
                        <h3 style="margin: 0 0 20px 0; text-align: center;">üö® Ph√¢n B·ªë M·ª©c ƒê·ªô Nghi√™m Tr·ªçng</h3>
                        ${Object.entries(severityStats)
                            .sort(([,a], [,b]) => b - a)
                            .map(([severity, count]) => {
                                const percentage = Math.round((count / allErrors.length) * 100);
                                return `
                                    <div style="margin: 15px 0;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                            <span style="display: flex; align-items: center;">
                                                <span class="severity-indicator severity-${severity}" style="margin-right: 10px;"></span>
                                                ${getSeverityText(severity)}
                                            </span>
                                            <span style="font-weight: bold;">${count} (${percentage}%)</span>
                                        </div>
                                        <div style="background: rgba(255,255,255,0.2); border-radius: 10px; height: 8px; overflow: hidden;">
                                            <div style="background: ${getSeverityColor(severity)}; height: 100%; width: ${percentage}%; transition: width 1s ease; border-radius: 10px;"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                    </div>
                    
                    <!-- Top linh ki·ªán b·ªã l·ªói -->
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px;">
                        <h3 style="margin: 0 0 20px 0; text-align: center;">üîß Linh Ki·ªán B·ªã ·∫¢nh H∆∞·ªüng Nhi·ªÅu Nh·∫•t</h3>
                        ${Object.entries(componentStats)
                            .sort(([,a], [,b]) => b - a)
                            .slice(0, 5)
                            .map(([component, count], idx) => `
                                <div style="margin: 15px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                    <div style="display: flex; align-items: center; justify-content: space-between;">
                                        <div style="display: flex; align-items: center;">
                                            <span style="background: ${['#e53e3e', '#f6ad55', '#4299e1', '#38a169', '#805ad5'][idx]}; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold;">${idx + 1}</span>
                                            <span style="font-size: 0.95em; line-height: 1.3;">${component}</span>
                                        </div>
                                        <span style="background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 15px; font-weight: bold;">${count}</span>
                                    </div>
                                </div>
                            `).join('')}
                    </div>
                </div>
                
                <!-- Khuy·∫øn ngh·ªã ∆∞u ti√™n -->
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 20px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 20px 0; text-align: center;">üí° Khuy·∫øn Ngh·ªã ∆Øu Ti√™n S·ª≠a Ch·ªØa</h3>
                    ${generatePriorityRecommendations(allErrors)}
                </div>
                
                <!-- Action buttons -->
                <div style="text-align: center; margin-top: 30px; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                    <button onclick="clearAllHistory()" style="background: rgba(220, 38, 38, 0.8); border: 2px solid rgba(220, 38, 38, 0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; flex: 1; min-width: 200px; max-width: 250px;">
                        üóëÔ∏è X√≥a T·∫•t C·∫£ L·ªãch S·ª≠
                    </button>
                    <button onclick="exportDetailedReport()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; flex: 1; min-width: 200px; max-width: 250px;">
                        üìä Xu·∫•t B√°o C√°o Chi Ti·∫øt
                    </button>
                    <button onclick="showRepairPriorityGuide()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; flex: 1; min-width: 200px; max-width: 250px;">
                        üõ†Ô∏è H∆∞·ªõng D·∫´n ∆Øu Ti√™n S·ª≠a Ch·ªØa
                    </button>
                    <button onclick="showCostEstimate()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; flex: 1; min-width: 200px; max-width: 250px;">
                        üí∞ ∆Ø·ªõc T√≠nh Chi Ph√≠
                    </button>
                </div>
            `;
            
            const resultsDiv = document.getElementById('analysisResults');
            resultsDiv.appendChild(summaryDiv);
        }

        // T·∫°o khuy·∫øn ngh·ªã ∆∞u ti√™n
        function generatePriorityRecommendations(errors) {
            const criticalErrors = errors.filter(e => e.data.severity === 'critical');
            const highErrors = errors.filter(e => e.data.severity === 'high');
            const mediumErrors = errors.filter(e => e.data.severity === 'medium');
            
            let recommendations = '';
            
            if (criticalErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(229, 62, 62, 0.2); border-left: 5px solid #e53e3e; border-radius: 10px;">
                        <h4 style="color: #e53e3e; margin: 0 0 15px 0; display: flex; align-items: center;">
                            üö® KH·∫®N C·∫§P - C·∫ßn s·ª≠a ch·ªØa ngay l·∫≠p t·ª©c
                        </h4>
                        <div style="display: grid; gap: 10px;">
                            ${criticalErrors.slice(0, 3).map((error, idx) => `
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
                                    <div>
                                        <div style="font-weight: bold; margin-bottom: 5px;">${error.data.vietnameseName}</div>
                                        <div style="font-size: 0.9em; opacity: 0.8;">Linh ki·ªán: ${error.data.component}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 0.9em; opacity: 0.8;">ƒê·ªô tin c·∫≠y</div>
                                        <div style="font-weight: bold;">${error.confidence}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        ${criticalErrors.length > 3 ? `<div style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">... v√† ${criticalErrors.length - 3} l·ªói nghi√™m tr·ªçng kh√°c</div>` : ''}
                    </div>
                `;
            }
            
            if (highErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(246, 173, 85, 0.2); border-left: 5px solid #f6ad55; border-radius: 10px;">
                        <h4 style="color: #c05621; margin: 0 0 15px 0; display: flex; align-items: center;">
                            ‚ö†Ô∏è CAO - N√™n s·ª≠a ch·ªØa trong tu·∫ßn n√†y
                        </h4>
                        <div style="display: grid; gap: 10px;">
                            ${highErrors.slice(0, 3).map((error, idx) => `
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
                                    <div>
                                        <div style="font-weight: bold; margin-bottom: 5px;">${error.data.vietnameseName}</div>
                                        <div style="font-size: 0.9em; opacity: 0.8;">Linh ki·ªán: ${error.data.component}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 0.9em; opacity: 0.8;">ƒê·ªô tin c·∫≠y</div>
                                        <div style="font-weight: bold;">${error.confidence}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        ${highErrors.length > 3 ? `<div style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">... v√† ${highErrors.length - 3} l·ªói m·ª©c cao kh√°c</div>` : ''}
                    </div>
                `;
            }
            
            if (mediumErrors.length > 0) {
                recommendations += `
                    <div style="margin: 15px 0; padding: 20px; background: rgba(214, 158, 46, 0.2); border-left: 5px solid #d69e2e; border-radius: 10px;">
                        <h4 style="color: #b7791f; margin: 0 0 15px 0; display: flex; align-items: center;">
                            üìã TRUNG B√åNH - Theo d√µi v√† l√™n k·∫ø ho·∫°ch s·ª≠a ch·ªØa
                        </h4>
                        <div style="font-size: 0.95em; opacity: 0.9;">
                            C√≥ ${mediumErrors.length} l·ªói m·ª©c trung b√¨nh c·∫ßn ƒë∆∞·ª£c theo d√µi. N√™n ki·ªÉm tra ƒë·ªãnh k·ª≥ v√† s·ª≠a ch·ªØa khi c√≥ th·ªùi gian.
                        </div>
                    </div>
                `;
            }
            
            return recommendations || '<div style="text-align: center; color: #68d391; font-size: 1.1em;">‚úÖ Kh√¥ng c√≥ l·ªói nghi√™m tr·ªçng n√†o c·∫ßn ∆∞u ti√™n!</div>';
        }

        // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n s·ª≠a ch·ªØa chi ti·∫øt
        function showRepairGuide(errorKey) {
            const errorData = errorDatabase[errorKey];
            if (!errorData) return;
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, ${getSeverityColor(errorData.severity)}, ${getSeverityColorLight(errorData.severity)}); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üõ†Ô∏è H∆∞·ªõng D·∫´n S·ª≠a Ch·ªØa Chi Ti·∫øt</h2>
                                <h3 style="margin: 0; opacity: 0.9; font-size: 1.3em;">${errorData.vietnameseName}</h3>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <!-- Th√¥ng tin c∆° b·∫£n -->
                        <div style="background: #f8f9fa; padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                            <h3 style="color: #2d3748; margin: 0 0 20px 0; display: flex; align-items: center;">
                                <span style="background: ${getSeverityColor(errorData.severity)}; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">‚ÑπÔ∏è</span>
                                Th√¥ng Tin C∆° B·∫£n
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <strong>üîß Linh ki·ªán b·ªã l·ªói:</strong><br>
                                    <span style="color: #4a5568; font-size: 1.1em;">${errorData.component}</span>
                                </div>
                                <div>
                                    <strong>üìç V·ªã tr√≠ tr√™n board:</strong><br>
                                    <span style="color: #4a5568; font-size: 1.1em;">${errorData.location}</span>
                                </div>
                            </div>
                            <div>
                                <strong>üìã M√¥ t·∫£ chi ti·∫øt:</strong><br>
                                <span style="color: #4a5568; font-size: 1.05em; line-height: 1.6;">${errorData.description}</span>
                            </div>
                        </div>
                        
                        <!-- Tri·ªáu ch·ª©ng -->
                        <div style="background: #fff3cd; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #ffc107;">
                            <h3 style="color: #856404; margin: 0 0 20px 0; display: flex; align-items: center;">
                                <span style="background: #ffc107; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">üîç</span>
                                Tri·ªáu Ch·ª©ng Nh·∫≠n Bi·∫øt
                            </h3>
                            <div style="display: grid; gap: 12px;">
                                ${errorData.symptoms ? errorData.symptoms.map((symptom, idx) => `
                                    <div style="display: flex; align-items: center; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 10px;">
                                        <span style="background: #ffc107; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 0.9em; font-weight: bold;">${idx + 1}</span>
                                        <span style="color: #856404; font-size: 1.05em;">${symptom}</span>
                                    </div>
                                `).join('') : '<div style="color: #856404;">Kh√¥ng c√≥ th√¥ng tin tri·ªáu ch·ª©ng</div>'}
                            </div>
                        </div>
                        
                        <!-- Quy tr√¨nh ch·∫©n ƒëo√°n -->
                        ${errorData.diagnosis ? `
                            <div style="background: #e7f3ff; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #0066cc;">
                                <h3 style="color: #004085; margin: 0 0 20px 0; display: flex; align-items: center;">
                                    <span style="background: #0066cc; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">üî¨</span>
                                    Quy Tr√¨nh Ch·∫©n ƒêo√°n Chi Ti·∫øt
                                </h3>
                                <div style="display: grid; gap: 20px;">
                                    ${Object.entries(errorData.diagnosis).map(([step, instruction], idx) => `
                                        <div style="display: flex; align-items: flex-start; padding: 20px; background: rgba(255,255,255,0.8); border-radius: 15px; border-left: 4px solid #0066cc;">
                                            <div style="background: #0066cc; color: white; border-radius: 50%; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-weight: bold; flex-shrink: 0;">${idx + 1}</div>
                                            <div>
                                                <div style="font-weight: bold; color: #004085; margin-bottom: 8px; text-transform: capitalize;">${step.replace('step', 'B∆∞·ªõc ')}</div>
                                                <div style="color: #004085; line-height: 1.6; font-size: 1.05em;">${instruction}</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Nguy√™n nh√¢n -->
                        <div style="background: #f8d7da; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #dc3545;">
                            <h3 style="color: #721c24; margin: 0 0 20px 0; display: flex; align-items: center;">
                                <span style="background: #dc3545; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">‚ö†Ô∏è</span>
                                Nguy√™n Nh√¢n C√≥ Th·ªÉ
                            </h3>
                            <div style="display: grid; gap: 12px;">
                                ${errorData.causes ? errorData.causes.map((cause, idx) => `
                                    <div style="display: flex; align-items: center; padding: 12px; background: rgba(255,255,255,0.7); border-radius: 10px;">
                                        <span style="background: #dc3545; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 0.9em; font-weight: bold;">${idx + 1}</span>
                                        <span style="color: #721c24; font-size: 1.05em;">${cause}</span>
                                    </div>
                                `).join('') : '<div style="color: #721c24;">C·∫ßn ch·∫©n ƒëo√°n th√™m ƒë·ªÉ x√°c ƒë·ªãnh nguy√™n nh√¢n</div>'}
                            </div>
                        </div>
                        
                        <!-- Gi·∫£i ph√°p s·ª≠a ch·ªØa -->
                        <div style="background: #d1ecf1; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #17a2b8;">
                            <h3 style="color: #0c5460; margin: 0 0 20px 0; display: flex; align-items: center;">
                                <span style="background: #17a2b8; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">üõ†Ô∏è</span>
                                Gi·∫£i Ph√°p S·ª≠a Ch·ªØa (Theo Th·ª© T·ª± ∆Øu Ti√™n)
                            </h3>
                            <div style="display: grid; gap: 15px;">
                                ${errorData.repairSolution ? errorData.repairSolution.map((solution, idx) => {
                                    const difficulty = idx === 0 ? 'D·ªÖ' : idx === 1 ? 'Trung b√¨nh' : idx === 2 ? 'Kh√≥' : 'R·∫•t kh√≥';
                                    const difficultyColor = idx === 0 ? '#28a745' : idx === 1 ? '#ffc107' : idx === 2 ? '#fd7e14' : '#dc3545';
                                    const estimatedTime = idx === 0 ? '15-30 ph√∫t' : idx === 1 ? '1-2 gi·ªù' : idx === 2 ? '2-4 gi·ªù' : '4+ gi·ªù';
                                    const estimatedCost = idx === 0 ? '50-200k' : idx === 1 ? '200-500k' : idx === 2 ? '500k-1tr' : '1-3tr';
                                    
                                    return `
                                        <div style="padding: 20px; background: rgba(255,255,255,0.8); border-radius: 15px; border-left: 4px solid #17a2b8;">
                                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                                                <div style="display: flex; align-items: center;">
                                                    <span style="background: #17a2b8; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold;">${idx + 1}</span>
                                                    <div>
                                                        <div style="font-weight: bold; color: #0c5460; font-size: 1.1em; margin-bottom: 5px;">${solution}</div>
                                                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                                            <span style="background: ${difficultyColor}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.85em; font-weight: bold;">
                                                                ƒê·ªô kh√≥: ${difficulty}
                                                            </span>
                                                            <span style="background: #6c757d; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.85em;">
                                                                ‚è±Ô∏è ${estimatedTime}
                                                            </span>
                                                            <span style="background: #007bff; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.85em;">
                                                                üí∞ ${estimatedCost}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('') : '<div style="color: #0c5460;">C·∫ßn ch·∫©n ƒëo√°n chuy√™n s√¢u ƒë·ªÉ ƒë∆∞a ra gi·∫£i ph√°p ph√π h·ª£p</div>'}
                            </div>
                        </div>
                        
                        <!-- L∆∞u √Ω quan tr·ªçng -->
                        <div style="background: linear-gradient(135deg, #ff6b6b, #feca57); color: white; padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                            <h3 style="margin: 0 0 15px 0; display: flex; align-items: center;">
                                <span style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">‚ö°</span>
                                L∆∞u √ù Quan Tr·ªçng
                            </h3>
                            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Lu√¥n sao l∆∞u d·ªØ li·ªáu tr∆∞·ªõc khi s·ª≠a ch·ªØa</li>
                                    <li>S·ª≠ d·ª•ng linh ki·ªán ch√≠nh h√£ng ho·∫∑c t∆∞∆°ng th√≠ch</li>
                                    <li>Ki·ªÉm tra b·∫£o h√†nh tr∆∞·ªõc khi can thi·ªáp</li>
                                    <li>N·∫øu kh√¥ng c√≥ kinh nghi·ªám, h√£y ƒë·∫øn c·ª≠a h√†ng uy t√≠n</li>
                                    <li>M·ªôt s·ªë l·ªói c√≥ th·ªÉ c·∫ßn thi·∫øt b·ªã chuy√™n d·ª•ng ƒë·ªÉ s·ª≠a</li>
                                </ul>
                            </div>
                        </div>
                        
                        <!-- Action buttons -->
                        <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="printRepairGuide('${errorKey}')" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                üñ®Ô∏è In H∆∞·ªõng D·∫´n
                            </button>
                            <button onclick="saveRepairGuide('${errorKey}')" style="background: linear-gradient(135deg, #007bff, #6610f2); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                üíæ L∆∞u H∆∞·ªõng D·∫´n
                            </button>
                            <button onclick="shareRepairGuide('${errorKey}')" style="background: linear-gradient(135deg, #17a2b8, #20c997); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                üì§ Chia S·∫ª
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            // ESC key ƒë·ªÉ ƒë√≥ng modal
            const handleEsc = function(e) {
                if (e.key === 'Escape') {
                    modal.remove();
                    document.removeEventListener('keydown', handleEsc);
                }
            };
            document.addEventListener('keydown', handleEsc);
        }

        // Hi·ªÉn th·ªã quy tr√¨nh ch·∫©n ƒëo√°n
        function showDiagnosticSteps(errorKey) {
            const errorData = errorDatabase[errorKey];
            if (!errorData || !errorData.diagnosis) {
                showNotification('Kh√¥ng c√≥ quy tr√¨nh ch·∫©n ƒëo√°n chi ti·∫øt cho l·ªói n√†y', 'warning');
                return;
            }
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 800px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üî¨ Quy Tr√¨nh Ch·∫©n ƒêo√°n</h2>
                                <h3 style="margin: 0; opacity: 0.9; font-size: 1.3em;">${errorData.vietnameseName}</h3>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <div style="background: #e7f3ff; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #4299e1;">
                            <h3 style="color: #2c5282; margin: 0 0 15px 0;">üìã Th√¥ng Tin Chung</h3>
                            <div style="color: #2c5282; line-height: 1.6;">
                                <strong>Linh ki·ªán:</strong> ${errorData.component}<br>
                                <strong>V·ªã tr√≠:</strong> ${errorData.location}<br>
                                <strong>M·ª©c ƒë·ªô:</strong> ${getSeverityText(errorData.severity)}
                            </div>
                        </div>
                        
                        <div style="display: grid; gap: 25px;">
                            ${Object.entries(errorData.diagnosis).map(([step, instruction], idx) => `
                                <div style="border: 2px solid #e2e8f0; border-radius: 20px; overflow: hidden; transition: all 0.3s ease;">
                                    <div style="background: linear-gradient(135deg, #4299e1, #63b3ed); color: white; padding: 20px; display: flex; align-items: center;">
                                        <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">
                                            ${idx + 1}
                                        </div>
                                        <div>
                                            <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">${step.replace('step', 'B∆∞·ªõc ')}</h4>
                                            <div style="opacity: 0.9;">Th·ªùi gian ∆∞·ªõc t√≠nh: ${getEstimatedTime(idx)} ph√∫t</div>
                                        </div>
                                    </div>
                                    <div style="padding: 25px; background: white;">
                                        <div style="color: #2d3748; font-size: 1.1em; line-height: 1.7; margin-bottom: 20px;">
                                            ${instruction}
                                        </div>
                                        
                                        ${getDetailedInstructions(errorKey, idx)}
                                        
                                        <div style="background: #f7fafc; padding: 15px; border-radius: 10px; margin-top: 15px;">
                                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                                <span style="background: #4299e1; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-size: 0.9em;">üí°</span>
                                                <strong style="color: #2d3748;">M·∫πo chuy√™n nghi·ªáp:</strong>
                                            </div>
                                            <div style="color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                                                ${getProfessionalTip(errorKey, idx)}
                                            </div>
                                        </div>
                                        
                                        <div style="margin-top: 15px; text-align: center;">
                                            <button onclick="markStepCompleted(this, ${idx})" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 12px 25px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: all 0.3s;">
                                                ‚úì ƒê√°nh D·∫•u Ho√†n Th√†nh
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="margin-top: 30px; text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="generateDiagnosticReport('${errorKey}')" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üìä T·∫°o B√°o C√°o Ch·∫©n ƒêo√°n
                            </button>
                            <button onclick="printDiagnosticSteps('${errorKey}')" style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üñ®Ô∏è In Quy Tr√¨nh
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // L·∫•y th·ªùi gian ∆∞·ªõc t√≠nh cho t·ª´ng b∆∞·ªõc
        function getEstimatedTime(stepIndex) {
            const times = [15, 30, 45, 60];
            return times[stepIndex] || 30;
        }

        // L·∫•y h∆∞·ªõng d·∫´n chi ti·∫øt cho t·ª´ng b∆∞·ªõc
        function getDetailedInstructions(errorKey, stepIndex) {
            const instructions = {
                'watchdog_timeout': [
                    'S·ª≠ d·ª•ng 3uTools ho·∫∑c iMazing ƒë·ªÉ ki·ªÉm tra nhi·ªát ƒë·ªô CPU trong th·ªùi gian th·ª±c. Nhi·ªát ƒë·ªô b√¨nh th∆∞·ªùng: 35-45¬∞C khi idle, 60-70¬∞C khi load.',
                    'Ch·∫°y MemTest86 ho·∫∑c s·ª≠ d·ª•ng Xcode Instruments ƒë·ªÉ test RAM. Ki·ªÉm tra memory leaks v√† bad sectors.',
                    'S·ª≠ d·ª•ng multimeter ƒë·ªÉ ƒëo PPVDD_MAIN rail (th∆∞·ªùng 1.8V). Ki·ªÉm tra t·ª• l·ªçc C1234, C5678 xung quanh CPU.',
                    'ƒêo ƒëi·ªán tr·ªü c√°c t·ª• tantalum v√† ceramic capacitors. Gi√° tr·ªã b√¨nh th∆∞·ªùng: 10-100 ohms.'
                ],
                'thermal_shutdown': [
                    'S·ª≠ d·ª•ng FLIR thermal camera ho·∫∑c infrared thermometer. Ki·ªÉm tra hotspots tr√™n board.',
                    'Th√°o heatsink/thermal pad, ki·ªÉm tra thermal paste. Thay b·∫±ng Arctic MX-4 ho·∫∑c Thermal Grizzly.',
                    'S·ª≠ d·ª•ng DC power supply ƒë·ªÉ c·∫•p ngu·ªìn ri√™ng cho thermal sensor, ƒëo output voltage.',
                    'Ki·ªÉm tra thermal throttling events trong Console app (macOS) ho·∫∑c syslog.'
                ],
                'nand_panic': [
                    'S·ª≠ d·ª•ng NAND programmer (RT809H, TL866) ƒë·ªÉ scan bad blocks v√† read flash info.',
                    'Ki·ªÉm tra ANS controller communication qua I2C/SPI interface.',
                    'Test read/write speed b·∫±ng Blackmagic Disk Speed Test ho·∫∑c CrystalDiskMark.',
                    'Dump firmware t·ª´ NAND v√† check integrity v·ªõi hex editor.'
                ]
            };
            
            const errorInstructions = instructions[errorKey];
            if (errorInstructions && errorInstructions[stepIndex]) {
                return `
                    <div style="background: #edf2f7; padding: 20px; border-radius: 15px; border-left: 4px solid #4299e1;">
                        <h5 style="color: #2d3748; margin: 0 0 15px 0;">üîß H∆∞·ªõng d·∫´n chi ti·∫øt:</h5>
                        <div style="color: #4a5568; line-height: 1.6;">
                            ${errorInstructions[stepIndex]}
                        </div>
                    </div>
                `;
            }
            return '';
        }

        // L·∫•y m·∫πo chuy√™n nghi·ªáp
        function getProfessionalTip(errorKey, stepIndex) {
            const tips = {
                'watchdog_timeout': [
                    'Lu√¥n ki·ªÉm tra nhi·ªát ƒë·ªô trong ƒëi·ªÅu ki·ªán stress test (ch·∫°y benchmark) ƒë·ªÉ ph√°t hi·ªán thermal throttling.',
                    'Memory errors th∆∞·ªùng xu·∫•t hi·ªán khi RAM qu√° n√≥ng. Ki·ªÉm tra thermal pad c·ªßa RAM.',
                    'PPVDD_MAIN rail r·∫•t quan tr·ªçng - n·∫øu voltage drop qu√° 5%, CPU s·∫Ω unstable.',
                    'T·ª• l·ªçc ngu·ªìn th∆∞·ªùng b·ªã h·ªèng do aging. Thay to√†n b·ªô c·ª•m t·ª• xung quanh CPU.'
                ],
                'thermal_shutdown': [
                    'Thermal camera cho th·∫•y ch√≠nh x√°c ƒëi·ªÉm n√≥ng nh·∫•t. Th∆∞·ªùng l√† CPU, GPU, ho·∫∑c charging IC.',
                    'Thermal paste ch·∫•t l∆∞·ª£ng cao c√≥ th·ªÉ gi·∫£m 10-15¬∞C so v·ªõi paste g·ªëc.',
                    'Thermal sensor c√≥ th·ªÉ b·ªã offset. Calibrate b·∫±ng c√°ch so v·ªõi nhi·ªát ƒë·ªô th·ª±c t·∫ø.',
                    'Thermal throttling events ƒë∆∞·ª£c log trong system. Ph√¢n t√≠ch ƒë·ªÉ t√¨m pattern.'
                ],
                'nand_panic': [
                    'Bad blocks tƒÉng nhanh l√† d·∫•u hi·ªáu NAND s·∫Øp h·∫øt tu·ªïi th·ªç. Backup ngay l·∫≠p t·ª©c.',
                    'ANS controller failure th∆∞·ªùng do power surge. Ki·ªÉm tra power rails tr∆∞·ªõc.',
                    'Slow storage c√≥ th·ªÉ do wear leveling algorithm failing. C·∫ßn professional tools.',
                    'Firmware corruption c√≥ th·ªÉ recover ƒë∆∞·ª£c n·∫øu c√≥ backup firmware t∆∞∆°ng th√≠ch.'
                ]
            };
            
            const errorTips = tips[errorKey];
            return errorTips && errorTips[stepIndex] ? errorTips[stepIndex] : 'Lu√¥n c·∫©n th·∫≠n v√† backup d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán.';

        }

        // ƒê√°nh d·∫•u b∆∞·ªõc ho√†n th√†nh
        function markStepCompleted(button, stepIndex) {
            button.style.background = 'linear-gradient(135deg, #38a169, #48bb78)';
            button.innerHTML = '‚úÖ ƒê√£ Ho√†n Th√†nh';
            button.disabled = true;
            
            // Animation effect
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 150);
            
            // L∆∞u progress
            const completedSteps = JSON.parse(localStorage.getItem('diagnosticProgress') || '{}');
            const currentError = button.closest('[style*="position: fixed"]').querySelector('h3').textContent;
            if (!completedSteps[currentError]) completedSteps[currentError] = [];
            if (!completedSteps[currentError].includes(stepIndex)) {
                completedSteps[currentError].push(stepIndex);
            }
            localStorage.setItem('diagnosticProgress', JSON.stringify(completedSteps));
            
            showNotification(`B∆∞·ªõc ${stepIndex + 1} ƒë√£ ƒë∆∞·ª£c ƒë√°nh d·∫•u ho√†n th√†nh!`, 'success');
        }

        // T·∫°o b√°o c√°o ch·∫©n ƒëo√°n
        function generateDiagnosticReport(errorKey) {
            const errorData = errorDatabase[errorKey];
            const completedSteps = JSON.parse(localStorage.getItem('diagnosticProgress') || '{}');
            const currentError = errorData.vietnameseName;
            const completed = completedSteps[currentError] || [];
            
            const reportContent = `
                <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 40px; background: white;">
                    <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #4299e1; padding-bottom: 20px;">
                        <h1 style="color: #2d3748; margin: 0 0 10px 0;">üìä B√ÅO C√ÅO CH·∫®N ƒêO√ÅN</h1>
                        <h2 style="color: #4299e1; margin: 0;">${errorData.vietnameseName}</h2>
                        <p style="color: #666; margin: 10px 0 0 0;">Ng√†y t·∫°o: ${new Date().toLocaleString('vi-VN')}</p>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #2d3748; border-left: 4px solid #4299e1; padding-left: 15px;">Th√¥ng Tin L·ªói</h3>
                        <div style="background: #f7fafc; padding: 20px; border-radius: 10px;">
                            <p><strong>Linh ki·ªán:</strong> ${errorData.component}</p>
                            <p><strong>V·ªã tr√≠:</strong> ${errorData.location}</p>
                            <p><strong>M·ª©c ƒë·ªô nghi√™m tr·ªçng:</strong> ${getSeverityText(errorData.severity)}</p>
                            <p><strong>M√¥ t·∫£:</strong> ${errorData.description}</p>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #2d3748; border-left: 4px solid #48bb78; padding-left: 15px;">Ti·∫øn ƒê·ªô Ch·∫©n ƒêo√°n</h3>
                        <div style="background: #f0fff4; padding: 20px; border-radius: 10px;">
                            <p><strong>T·ªïng s·ªë b∆∞·ªõc:</strong> ${Object.keys(errorData.diagnosis || {}).length}</p>
                            <p><strong>ƒê√£ ho√†n th√†nh:</strong> ${completed.length} b∆∞·ªõc</p>
                            <p><strong>Ti·∫øn ƒë·ªô:</strong> ${Math.round((completed.length / Object.keys(errorData.diagnosis || {}).length) * 100)}%</p>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #2d3748; border-left: 4px solid #f6ad55; padding-left: 15px;">Chi Ti·∫øt C√°c B∆∞·ªõc</h3>
                        ${Object.entries(errorData.diagnosis || {}).map(([step, instruction], idx) => `
                            <div style="margin: 15px 0; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px; ${completed.includes(idx) ? 'background: #f0fff4; border-color: #48bb78;' : 'background: #fff5f5; border-color: #feb2b2;'}">
                                <h4 style="margin: 0 0 10px 0; color: ${completed.includes(idx) ? '#38a169' : '#e53e3e'};">
                                    ${completed.includes(idx) ? '‚úÖ' : '‚ùå'} ${step.replace('step', 'B∆∞·ªõc ')}
                                </h4>
                                <p style="margin: 0; color: #4a5568;">${instruction}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #2d3748; border-left: 4px solid #805ad5; padding-left: 15px;">Khuy·∫øn Ngh·ªã</h3>
                        <div style="background: #faf5ff; padding: 20px; border-radius: 10px;">
                            ${completed.length === Object.keys(errorData.diagnosis || {}).length ? 
                                '<p style="color: #38a169;"><strong>‚úÖ Ho√†n th√†nh t·∫•t c·∫£ b∆∞·ªõc ch·∫©n ƒëo√°n!</strong> C√≥ th·ªÉ ti·∫øn h√†nh s·ª≠a ch·ªØa theo h∆∞·ªõng d·∫´n.</p>' :
                                '<p style="color: #e53e3e;"><strong>‚ö†Ô∏è Ch∆∞a ho√†n th√†nh ch·∫©n ƒëo√°n.</strong> C·∫ßn th·ª±c hi·ªán th√™m c√°c b∆∞·ªõc c√≤n l·∫°i ƒë·ªÉ c√≥ k·∫øt lu·∫≠n ch√≠nh x√°c.</p>'
                            }
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
                        <p style="color: #666; font-size: 0.9em;">B√°o c√°o ƒë∆∞·ª£c t·∫°o b·ªüi AI Panic Log Analyzer</p>
                    </div>
                </div>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>B√°o C√°o Ch·∫©n ƒêo√°n - ${errorData.vietnameseName}</title>
                    <meta charset="UTF-8">
                    <style>
                        @media print {
                            body { margin: 0; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    ${reportContent}
                    <div class="no-print" style="text-align: center; margin: 20px;">
                        <button onclick="window.print()" style="background: #4299e1; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin-right: 15px;">üñ®Ô∏è In B√°o C√°o</button>
                        <button onclick="window.close()" style="background: #e53e3e; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold;">‚ùå ƒê√≥ng</button>
                    </div>
                </body>
                </html>
            `);
            newWindow.document.close();
        }

        // Hi·ªÉn th·ªã ch·∫©n ƒëo√°n t·ªïng qu√°t
        function showGeneralDiagnostic() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, #38a169, #48bb78); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üîç Ch·∫©n ƒêo√°n T·ªïng Qu√°t</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1em;">H∆∞·ªõng d·∫´n ch·∫©n ƒëo√°n khi kh√¥ng ph√°t hi·ªán l·ªói c·ª• th·ªÉ</p>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <div style="background: #e6fffa; padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #38a169;">
                            <h3 style="color: #234e52; margin: 0 0 15px 0;">üìã C√°c B∆∞·ªõc Ch·∫©n ƒêo√°n C∆° B·∫£n</h3>
                            <div style="color: #234e52; line-height: 1.6;">
                                Khi kh√¥ng ph√°t hi·ªán l·ªói panic c·ª• th·ªÉ, h√£y th·ª±c hi·ªán c√°c b∆∞·ªõc sau ƒë·ªÉ ch·∫©n ƒëo√°n s√¢u h∆°n:
                            </div>
                        </div>
                        
                        <div style="display: grid; gap: 25px;">
                            <div style="border: 2px solid #e2e8f0; border-radius: 20px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #4299e1, #63b3ed); color: white; padding: 20px; display: flex; align-items: center;">
                                    <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">1</div>
                                    <div>
                                        <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">Ki·ªÉm Tra Ph·∫ßn M·ªÅm</h4>
                                        <div style="opacity: 0.9;">Th·ªùi gian: 15-30 ph√∫t</div>
                                    </div>
                                </div>
                                <div style="padding: 25px; background: white;">
                                    <ul style="color: #2d3748; line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li>Kh·ªüi ƒë·ªông l·∫°i thi·∫øt b·ªã v√† ki·ªÉm tra xem l·ªói c√≥ l·∫∑p l·∫°i kh√¥ng</li>
                                        <li>C·∫≠p nh·∫≠t iOS/macOS l√™n phi√™n b·∫£n m·ªõi nh·∫•t</li>
                                        <li>G·ª° c√†i ƒë·∫∑t c√°c ·ª©ng d·ª•ng ƒë∆∞·ª£c c√†i ƒë·∫∑t g·∫ßn ƒë√¢y</li>
                                        <li>Reset c√†i ƒë·∫∑t m·∫°ng v√† c√†i ƒë·∫∑t chung</li>
                                        <li>Ki·ªÉm tra dung l∆∞·ª£ng l∆∞u tr·ªØ c√≤n l·∫°i (c·∫ßn √≠t nh·∫•t 10% tr·ªëng)</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="border: 2px solid #e2e8f0; border-radius: 20px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #f6ad55, #fd7e14); color: white; padding: 20px; display: flex; align-items: center;">
                                    <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">2</div>
                                    <div>
                                        <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">Ki·ªÉm Tra Ph·∫ßn C·ª©ng C∆° B·∫£n</h4>
                                        <div style="opacity: 0.9;">Th·ªùi gian: 30-45 ph√∫t</div>
                                    </div>
                                </div>
                                <div style="padding: 25px; background: white;">
                                    <ul style="color: #2d3748; line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li>Ki·ªÉm tra nhi·ªát ƒë·ªô thi·∫øt b·ªã - kh√¥ng n√™n qu√° n√≥ng khi s·ª≠ d·ª•ng</li>
                                        <li>Test pin: ki·ªÉm tra % pin, th·ªùi gian s·ª≠ d·ª•ng, t·ªëc ƒë·ªô s·∫°c</li>
                                        <li>Ki·ªÉm tra t·∫•t c·∫£ c·ªïng k·∫øt n·ªëi (Lightning, USB-C, headphone jack)</li>
                                        <li>Test camera, mic, loa, c·∫£m bi·∫øn (Touch ID/Face ID)</li>
                                        <li>Ki·ªÉm tra m√†n h√¨nh c√≥ dead pixel, ghost touch kh√¥ng</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="border: 2px solid #e2e8f0; border-radius: 20px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #e53e3e, #fc8181); color: white; padding: 20px; display: flex; align-items: center;">
                                    <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">3</div>
                                    <div>
                                        <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">Ch·∫©n ƒêo√°n Chuy√™n S√¢u</h4>
                                        <div style="opacity: 0.9;">Th·ªùi gian: 1-2 gi·ªù</div>
                                    </div>
                                </div>
                                <div style="padding: 25px; background: white;">
                                    <ul style="color: #2d3748; line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li>Ch·∫°y Apple Diagnostics (gi·ªØ D khi kh·ªüi ƒë·ªông)</li>
                                        <li>S·ª≠ d·ª•ng 3uTools ƒë·ªÉ ki·ªÉm tra chi ti·∫øt ph·∫ßn c·ª©ng</li>
                                        <li>Ki·ªÉm tra log h·ªá th·ªëng trong Console app</li>
                                        <li>Test stress v·ªõi benchmark apps (Geekbench, 3DMark)</li>
                                        <li>Ki·ªÉm tra k·∫øt n·ªëi m·∫°ng v√† Bluetooth</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div style="border: 2px solid #e2e8f0; border-radius: 20px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #805ad5, #b794f6); color: white; padding: 20px; display: flex; align-items: center;">
                                    <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">4</div>
                                    <div>
                                        <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">Ph√¢n T√≠ch Log Chi Ti·∫øt</h4>
                                        <div style="opacity: 0.9;">Th·ªùi gian: 45-60 ph√∫t</div>
                                    </div>
                                </div>
                                <div style="padding: 25px; background: white;">
                                    <div style="color: #2d3748; line-height: 1.7; margin-bottom: 20px;">
                                        N·∫øu c√°c b∆∞·ªõc tr√™n kh√¥ng ph√°t hi·ªán v·∫•n ƒë·ªÅ, h√£y ph√¢n t√≠ch panic log th·ªß c√¥ng:
                                    </div>
                                    <ul style="color: #2d3748; line-height: 1.7; margin: 0; padding-left: 20px;">
                                        <li>T√¨m ki·∫øm keywords: "panic", "fault", "exception", "crash"</li>
                                        <li>Xem backtrace ƒë·ªÉ x√°c ƒë·ªãnh process g√¢y l·ªói</li>
                                        <li>Ki·ªÉm tra memory addresses v√† register values</li>
                                        <li>Ph√¢n t√≠ch timestamp ƒë·ªÉ t√¨m pattern</li>
                                        <li>So s√°nh v·ªõi panic logs t∆∞∆°ng t·ª± tr√™n internet</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 20px; margin: 30px 0;">
                            <h3 style="margin: 0 0 15px 0; display: flex; align-items: center;">
                                <span style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 1.2em;">üí°</span>
                                M·∫πo Chuy√™n Nghi·ªáp
                            </h3>
                            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                    <li>Panic logs kh√¥ng ph√°t hi·ªán l·ªói c√≥ th·ªÉ do l·ªói ph·∫ßn m·ªÅm t·∫°m th·ªùi</li>
                                    <li>H√£y thu th·∫≠p nhi·ªÅu panic logs ƒë·ªÉ t√¨m pattern chung</li>
                                    <li>Ki·ªÉm tra xem l·ªói c√≥ x·∫£y ra trong ƒëi·ªÅu ki·ªán c·ª• th·ªÉ kh√¥ng (s·∫°c, n√≥ng, app n√†o ƒë√≥)</li>
                                    <li>M·ªôt s·ªë l·ªói hardware c·∫ßn thi·∫øt b·ªã chuy√™n d·ª•ng ƒë·ªÉ ph√°t hi·ªán</li>
                                    <li>Khi nghi ng·ªù hardware, h√£y ƒë·∫øn c·ª≠a h√†ng uy t√≠n ƒë·ªÉ ki·ªÉm tra</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="downloadGeneralGuide()" style="background: linear-gradient(135deg, #38a169, #48bb78); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                üì• T·∫£i H∆∞·ªõng D·∫´n PDF
                            </button>
                            <button onclick="showAdvancedTools()" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 300px;">
                                üõ†Ô∏è C√¥ng C·ª• Chuy√™n Nghi·ªáp
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // Hi·ªÉn th·ªã c√¥ng c·ª• chuy√™n nghi·ªáp
        function showAdvancedTools() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10001; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 1000px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üõ†Ô∏è C√¥ng C·ª• Chuy√™n Nghi·ªáp</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1em;">Danh s√°ch c√¥ng c·ª• ch·∫©n ƒëo√°n v√† s·ª≠a ch·ªØa chuy√™n nghi·ªáp</p>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                            <!-- Software Tools -->
                            <div style="background: #f0f9ff; padding: 25px; border-radius: 20px; border-left: 5px solid #0ea5e9;">
                                <h3 style="color: #0c4a6e; margin: 0 0 20px 0; display: flex; align-items: center;">
                                    <span style="background: #0ea5e9; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">üíª</span>
                                    Ph·∫ßn M·ªÅm Ch·∫©n ƒêo√°n
                                </h3>
                                <div style="space-y: 15px;">
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #0c4a6e;">3uTools</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">C√¥ng c·ª• to√†n di·ªán cho iOS: backup, flash, jailbreak, hardware info</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">Free</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Windows</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #0c4a6e;">iMazing</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">Qu·∫£n l√Ω iOS chuy√™n nghi·ªáp, backup, logs analysis</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">Paid</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Cross-platform</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #0c4a6e;">checkra1n</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">Jailbreak tool, c√≥ th·ªÉ d√πng ƒë·ªÉ ch·∫°y diagnostic tools</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">Free</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Advanced</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Hardware Tools -->
                            <div style="background: #fef7ff; padding: 25px; border-radius: 20px; border-left: 5px solid #a855f7;">
                                <h3 style="color: #581c87; margin: 0 0 20px 0; display: flex; align-items: center;">
                                    <span style="background: #a855f7; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">üîß</span>
                                    Thi·∫øt B·ªã Ph·∫ßn C·ª©ng
                                </h3>
                                <div style="space-y: 15px;">
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #581c87;">DC Power Supply</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">Cung c·∫•p ngu·ªìn ch√≠nh x√°c ƒë·ªÉ test c√°c rail ngu·ªìn</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$200-500</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Professional</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding:15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #581c87;">Digital Multimeter</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">ƒêo ƒëi·ªán √°p, d√≤ng ƒëi·ªán, ƒëi·ªán tr·ªü ch√≠nh x√°c</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$50-200</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Essential</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #581c87;">Thermal Camera</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">FLIR ho·∫∑c t∆∞∆°ng t·ª± ƒë·ªÉ ph√°t hi·ªán hotspots</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$1000+</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Expert</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- NAND Tools -->
                            <div style="background: #fff7ed; padding: 25px; border-radius: 20px; border-left: 5px solid #ea580c;">
                                <h3 style="color: #9a3412; margin: 0 0 20px 0; display: flex; align-items: center;">
                                    <span style="background: #ea580c; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">üíæ</span>
                                    NAND/Flash Tools
                                </h3>
                                <div style="space-y: 15px;">
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #9a3412;">RT809H Programmer</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">NAND flash programmer, ƒë·ªçc/ghi NAND tr·ª±c ti·∫øp</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$300-500</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Professional</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #9a3412;">Easy JTAG Plus</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">JTAG/ISP programmer cho mobile devices</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$800+</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Expert</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #9a3412;">HDD Regenerator</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">Ph·ª•c h·ªìi bad sectors, test storage health</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$50</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Software</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Microscopy -->
                            <div style="background: #f0fdf4; padding: 25px; border-radius: 20px; border-left: 5px solid #16a34a;">
                                <h3 style="color: #14532d; margin: 0 0 20px 0; display: flex; align-items: center;">
                                    <span style="background: #16a34a; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">üî¨</span>
                                    K√≠nh Hi·ªÉn Vi & H√†n
                                </h3>
                                <div style="space-y: 15px;">
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #14532d;">Stereo Microscope</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">K√≠nh hi·ªÉn vi 2 m·∫Øt, zoom 10-40x cho vi h√†n</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$500-2000</span>
                                            <span style="background: #fecaca; color: #991b1b; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Professional</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #14532d;">Hot Air Station</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">Tr·∫°m kh√≠ n√≥ng cho BGA rework, chip replacement</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$200-800</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Essential</span>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                        <h4 style="margin: 0 0 8px 0; color: #14532d;">Soldering Iron</h4>
                                        <p style="margin: 0; color: #475569; font-size: 0.95em;">M·ªè h√†n ch√≠nh x√°c, nhi·ªát ƒë·ªô ƒëi·ªÅu ch·ªânh ƒë∆∞·ª£c</p>
                                        <div style="margin-top: 10px;">
                                            <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">$50-300</span>
                                            <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 0.8em; margin-left: 8px;">Basic</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #1f2937, #374151); color: white; padding: 30px; border-radius: 20px; margin: 30px 0;">
                            <h3 style="margin: 0 0 20px 0; text-align: center; font-size: 1.5em;">üéì Khuy·∫øn Ngh·ªã Theo Tr√¨nh ƒê·ªô</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <h4 style="margin: 0 0 15px 0; color: #60a5fa;">üë∂ Ng∆∞·ªùi M·ªõi B·∫Øt ƒê·∫ßu</h4>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.6; font-size: 0.95em;">
                                        <li>3uTools (free)</li>
                                        <li>Digital Multimeter c∆° b·∫£n</li>
                                        <li>Screwdriver set</li>
                                        <li>Anti-static wrist strap</li>
                                    </ul>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <h4 style="margin: 0 0 15px 0; color: #fbbf24;">üîß Trung C·∫•p</h4>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.6; font-size: 0.95em;">
                                        <li>iMazing Pro</li>
                                        <li>DC Power Supply</li>
                                        <li>Hot Air Station</li>
                                        <li>Stereo Microscope</li>
                                    </ul>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <h4 style="margin: 0 0 15px 0; color: #f87171;">üöÄ Chuy√™n Nghi·ªáp</h4>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.6; font-size: 0.95em;">
                                        <li>RT809H Programmer</li>
                                        <li>Thermal Camera</li>
                                        <li>Easy JTAG Plus</li>
                                        <li>Professional Rework Station</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="downloadToolsList()" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üì• T·∫£i Danh S√°ch PDF
                            </button>
                            <button onclick="showToolsComparison()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                ‚öñÔ∏è So S√°nh C√¥ng C·ª•
                            </button>
                            <button onclick="showBuyingGuide()" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üõí H∆∞·ªõng D·∫´n Mua
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n ∆∞u ti√™n s·ª≠a ch·ªØa
        function showRepairPriorityGuide() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            if (allErrors.length === 0) {
                showNotification('Ch∆∞a c√≥ l·ªói n√†o ƒë∆∞·ª£c ph√°t hi·ªán ƒë·ªÉ t·∫°o h∆∞·ªõng d·∫´n ∆∞u ti√™n', 'warning');
                return;
            }
            
            // S·∫Øp x·∫øp theo m·ª©c ƒë·ªô nghi√™m tr·ªçng v√† confidence
            const sortedErrors = allErrors.sort((a, b) => {
                const severityOrder = { 'critical': 4, 'high': 3, 'medium': 2, 'low': 1 };
                const severityDiff = severityOrder[b.data.severity] - severityOrder[a.data.severity];
                if (severityDiff !== 0) return severityDiff;
                return b.confidence - a.confidence;
            });
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 1000px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üõ†Ô∏è H∆∞·ªõng D·∫´n ∆Øu Ti√™n S·ª≠a Ch·ªØa</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1em;">Th·ª© t·ª± s·ª≠a ch·ªØa ƒë∆∞·ª£c AI khuy·∫øn ngh·ªã d·ª±a tr√™n m·ª©c ƒë·ªô nghi√™m tr·ªçng</p>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <div style="background: linear-gradient(135deg, #fef3c7, #fde68a); padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #f59e0b;">
                            <h3 style="color: #92400e; margin: 0 0 15px 0; display: flex; align-items: center;">
                                <span style="background: #f59e0b; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">‚ö°</span>
                                Nguy√™n T·∫Øc ∆Øu Ti√™n
                            </h3>
                            <div style="color: #92400e; line-height: 1.6;">
                                <strong>1. Nghi√™m tr·ªçng nh·∫•t tr∆∞·ªõc:</strong> Critical ‚Üí High ‚Üí Medium ‚Üí Low<br>
                                <strong>2. ƒê·ªô tin c·∫≠y cao:</strong> ∆Øu ti√™n l·ªói c√≥ confidence ‚â• 85%<br>
                                <strong>3. ·∫¢nh h∆∞·ªüng h·ªá th·ªëng:</strong> L·ªói ·∫£nh h∆∞·ªüng to√†n b·ªô thi·∫øt b·ªã ƒë∆∞·ª£c ∆∞u ti√™n<br>
                                <strong>4. Chi ph√≠ - hi·ªáu qu·∫£:</strong> S·ª≠a l·ªói d·ªÖ v√† r·∫ª tr∆∞·ªõc khi tackle l·ªói ph·ª©c t·∫°p
                            </div>
                        </div>
                        
                        <div style="display: grid; gap: 20px;">
                            ${sortedErrors.map((error, index) => {
                                const priorityColors = {
                                    0: { bg: '#fee2e2', border: '#dc2626', text: '#991b1b' },
                                    1: { bg: '#fed7aa', border: '#ea580c', text: '#9a3412' },
                                    2: { bg: '#fef3c7', border: '#f59e0b', text: '#92400e' }
                                };
                                const colorScheme = priorityColors[Math.min(index, 2)] || { bg: '#f3f4f6', border: '#6b7280', text: '#374151' };
                                
                                const estimatedCost = getEstimatedRepairCost(error.data.severity);
                                const estimatedTime = getEstimatedRepairTime(error.data.severity);
                                const difficultyLevel = getRepairDifficulty(error.data.severity);
                                
                                return `
                                    <div style="background: ${colorScheme.bg}; border: 2px solid ${colorScheme.border}; border-radius: 20px; overflow: hidden;">
                                        <div style="background: ${colorScheme.border}; color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                                            <div style="display: flex; align-items: center;">
                                                <div style="background: rgba(255,255,255,0.2); border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 1.5em; font-weight: bold;">
                                                    ${index + 1}
                                                </div>
                                                <div>
                                                    <h4 style="margin: 0 0 5px 0; font-size: 1.3em;">${error.data.vietnameseName}</h4>
                                                    <div style="opacity: 0.9;">∆Øu ti√™n: ${index === 0 ? 'KH·∫®N C·∫§P' : index === 1 ? 'CAO' : index === 2 ? 'TRUNG B√åNH' : 'TH·∫§P'}</div>
                                                </div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 15px; margin-bottom: 5px;">
                                                    Confidence: ${error.confidence}%
                                                </div>
                                                <div style="font-size: 0.9em; opacity: 0.9;">
                                                    ${getSeverityText(error.data.severity)}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="padding: 25px;">
                                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                                                <div style="background: white; padding: 15px; border-radius: 10px;">
                                                    <h5 style="margin: 0 0 10px 0; color: ${colorScheme.text};">üí∞ Chi Ph√≠ ∆Ø·ªõc T√≠nh</h5>
                                                    <div style="font-size: 1.2em; font-weight: bold; color: ${colorScheme.text};">${estimatedCost}</div>
                                                </div>
                                                <div style="background: white; padding: 15px; border-radius: 10px;">
                                                    <h5 style="margin: 0 0 10px 0; color: ${colorScheme.text};">‚è±Ô∏è Th·ªùi Gian</h5>
                                                    <div style="font-size: 1.2em; font-weight: bold; color: ${colorScheme.text};">${estimatedTime}</div>
                                                </div>
                                                <div style="background: white; padding: 15px; border-radius: 10px;">
                                                    <h5 style="margin: 0 0 10px 0; color: ${colorScheme.text};">üéØ ƒê·ªô Kh√≥</h5>
                                                    <div style="font-size: 1.2em; font-weight: bold; color: ${colorScheme.text};">${difficultyLevel}</div>
                                                </div>
                                            </div>
                                            
                                            <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                                                <h5 style="margin: 0 0 15px 0; color: ${colorScheme.text};">üîß Linh Ki·ªán & V·ªã Tr√≠</h5>
                                                <div style="color: #4a5568; line-height: 1.6;">
                                                    <strong>Linh ki·ªán:</strong> ${error.data.component}<br>
                                                    <strong>V·ªã tr√≠:</strong> ${error.data.location}
                                                </div>
                                            </div>
                                            
                                            <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                                                <h5 style="margin: 0 0 15px 0; color: ${colorScheme.text};">üõ†Ô∏è Gi·∫£i Ph√°p Khuy·∫øn Ngh·ªã</h5>
                                                <div style="color: #4a5568; line-height: 1.6;">
                                                    ${error.data.repairSolution ? error.data.repairSolution.slice(0, 2).map((solution, idx) => 
                                                        `<div style="margin: 8px 0;"><strong>${idx + 1}.</strong> ${solution}</div>`
                                                    ).join('') : 'C·∫ßn ch·∫©n ƒëo√°n th√™m'}
                                                </div>
                                            </div>
                                            
                                            <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                                                <button onclick="showRepairGuide('${error.key}')" style="background: linear-gradient(135deg, ${colorScheme.border}, ${colorScheme.text}); color: white; border: none; padding: 12px 25px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 180px; max-width: 250px;">
                                                    üìã Chi Ti·∫øt S·ª≠a Ch·ªØa
                                                </button>
                                                <button onclick="markAsCompleted('${error.key}', ${index})" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; padding: 12px 25px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 180px; max-width: 250px;">
                                                    ‚úÖ ƒê√°nh D·∫•u Ho√†n Th√†nh
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #1f2937, #374151); color: white; padding: 30px; border-radius: 20px; margin: 30px 0;">
                            <h3 style="margin: 0 0 20px 0; text-align: center;">üí° L·ªùi Khuy√™n Chuy√™n Nghi·ªáp</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <h4 style="margin: 0 0 10px 0; color: #60a5fa;">üéØ Chi·∫øn L∆∞·ª£c S·ª≠a Ch·ªØa</h4>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.6; font-size: 0.95em;">
                                        <li>S·ª≠a l·ªói critical tr∆∞·ªõc ƒë·ªÉ tr√°nh h·ªèng th√™m</li>
                                        <li>Backup d·ªØ li·ªáu tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu</li>
                                        <li>Chu·∫©n b·ªã ƒë·∫ßy ƒë·ªß linh ki·ªán v√† c√¥ng c·ª•</li>
                                        <li>Test t·ª´ng b∆∞·ªõc sau khi s·ª≠a</li>
                                    </ul>
                                </div>
                                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <h4 style="margin: 0 0 10px 0; color: #fbbf24;">‚ö†Ô∏è L∆∞u √ù Quan Tr·ªçng</h4>
                                    <ul style="margin: 0; padding-left: 20px; line-height: 1.6; font-size: 0.95em;">
                                        <li>M·ªôt s·ªë l·ªói c√≥ th·ªÉ li√™n quan ƒë·∫øn nhau</li>
                                        <li>Ki·ªÉm tra b·∫£o h√†nh tr∆∞·ªõc khi s·ª≠a</li>
                                        <li>N·∫øu kh√¥ng ch·∫Øc ch·∫Øn, h√£y h·ªèi chuy√™n gia</li>
                                        <li>Document l·∫°i qu√° tr√¨nh s·ª≠a ch·ªØa</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="generateRepairPlan()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üìã T·∫°o K·∫ø Ho·∫°ch S·ª≠a Ch·ªØa
                            </button>
                            <button onclick="exportPriorityList()" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üì§ Xu·∫•t Danh S√°ch ∆Øu Ti√™n
                            </button>
                            <button onclick="showCostBreakdown()" style="background: linear-gradient(135deg, #f59e0b, #f97316); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üí∞ Ph√¢n T√≠ch Chi Ph√≠
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // ∆Ø·ªõc t√≠nh chi ph√≠ s·ª≠a ch·ªØa
        function getEstimatedRepairCost(severity) {
            const costs = {
                'critical': '1-3 tri·ªáu VNƒê',
                'high': '500k-1.5tr VNƒê',
                'medium': '200-800k VNƒê',
                'low': '50-300k VNƒê'
            };
            return costs[severity] || 'C·∫ßn b√°o gi√°';
        }

        // ∆Ø·ªõc t√≠nh th·ªùi gian s·ª≠a ch·ªØa
        function getEstimatedRepairTime(severity) {
            const times = {
                'critical': '4-8 gi·ªù',
                'high': '2-4 gi·ªù',
                'medium': '1-2 gi·ªù',
                'low': '30-60 ph√∫t'
            };
            return times[severity] || 'C·∫ßn ƒë√°nh gi√°';
        }

        // ƒê·ªô kh√≥ s·ª≠a ch·ªØa
        function getRepairDifficulty(severity) {
            const difficulties = {
                'critical': 'R·∫•t kh√≥',
                'high': 'Kh√≥',
                'medium': 'Trung b√¨nh',
                'low': 'D·ªÖ'
            };
            return difficulties[severity] || 'Kh√¥ng x√°c ƒë·ªãnh';
        }

        // Hi·ªÉn th·ªã ∆∞·ªõc t√≠nh chi ph√≠
        function showCostEstimate() {
            const allErrors = analysisResults.flatMap(result => result.errors);
            if (allErrors.length === 0) {
                showNotification('Ch∆∞a c√≥ l·ªói n√†o ƒë·ªÉ ∆∞·ªõc t√≠nh chi ph√≠', 'warning');
                return;
            }
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 20px;
            `;
            
            // T√≠nh to√°n chi ph√≠
            const costBreakdown = calculateDetailedCosts(allErrors);
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 25px; max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.3);">
                    <div style="background: linear-gradient(135deg, #f59e0b, #f97316); color: white; padding: 30px; border-radius: 25px 25px 0 0; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <div>
                                <h2 style="margin: 0 0 10px 0; font-size: 1.8em;">üí∞ ∆Ø·ªõc T√≠nh Chi Ph√≠ S·ª≠a Ch·ªØa</h2>
                                <p style="margin: 0; opacity: 0.9; font-size: 1.1em;">Ph√¢n t√≠ch chi ph√≠ chi ti·∫øt cho t·∫•t c·∫£ l·ªói ƒë∆∞·ª£c ph√°t hi·ªán</p>
                            </div>
                            <button onclick="this.closest('[style*=\"position: fixed\"]').remove()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                        </div>
                    </div>
                    
                    <div style="padding: 40px;">
                        <!-- T·ªïng quan chi ph√≠ -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div style="background: linear-gradient(135deg, #fee2e2, #fecaca); padding: 25px; border-radius: 20px; text-align: center; border-left: 5px solid #dc2626;">
                                <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #dc2626;">${costBreakdown.total.min.toLocaleString()}</div>
                                <div style="color: #991b1b; font-weight: bold;">Chi Ph√≠ T·ªëi Thi·ªÉu (VNƒê)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #fed7aa, #fdba74); padding: 25px; border-radius: 20px; text-align: center; border-left: 5px solid #ea580c;">
                                <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #ea580c;">${costBreakdown.total.max.toLocaleString()}</div>
                                <div style="color: #9a3412; font-weight: bold;">Chi Ph√≠ T·ªëi ƒêa (VNƒê)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #dbeafe, #bfdbfe); padding: 25px; border-radius: 20px; text-align: center; border-left: 5px solid #2563eb;">
                                <div style="font-size: 2.5em; font-weight: bold; margin-bottom: 10px; color: #2563eb;">${Math.round((costBreakdown.total.min + costBreakdown.total.max) / 2).toLocaleString()}</div>
                                <div style="color: #1e40af; font-weight: bold;">Chi Ph√≠ Trung B√¨nh (VNƒê)</div>
                            </div>
                        </div>
                        
                        <!-- Chi ph√≠ theo m·ª©c ƒë·ªô -->
                        <div style="background: #f8fafc; padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                            <h3 style="color: #2d3748; margin: 0 0 20px 0;">üìä Ph√¢n B·ªï Chi Ph√≠ Theo M·ª©c ƒê·ªô</h3>
                            <div style="display: grid; gap: 15px;">
                                ${Object.entries(costBreakdown.bySeverity).map(([severity, data]) => `
                                    <div style="background: white; padding: 20px; border-radius: 15px; border-left: 5px solid ${getSeverityColor(severity)};">
                                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                                            <div>
                                                <h4 style="margin: 0 0 5px 0; color: ${getSeverityColor(severity)};">${getSeverityText(severity)}</h4>
                                                <div style="color: #6b7280; font-size: 0.9em;">${data.count} l·ªói</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-size: 1.3em; font-weight: bold; color: #2d3748; margin-bottom: 5px;">
                                                    ${data.min.toLocaleString()} - ${data.max.toLocaleString()} VNƒê
                                                </div>
                                                <div style="color: #6b7280; font-size: 0.9em;">
                                                    Trung b√¨nh: ${Math.round((data.min + data.max) / 2).toLocaleString()} VNƒê
                                                </div>
                                            </div>
                                        </div>
                                        <div style="margin-top: 15px; background: #f1f5f9; border-radius: 10px; height: 8px; overflow: hidden;">
                                            <div style="background: ${getSeverityColor(severity)}; height: 100%; width: ${(data.max / costBreakdown.total.max) * 100}%; transition: width 1s ease; border-radius: 10px;"></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- Chi ti·∫øt t·ª´ng l·ªói -->
                        <div style="background: #f8fafc; padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                            <h3 style="color: #2d3748; margin: 0 0 20px 0;">üîß Chi Ph√≠ Chi Ti·∫øt T·ª´ng L·ªói</h3>
                            <div style="display: grid; gap: 15px;">
                                ${allErrors.map((error, index) => {
                                    const cost = getDetailedCostForError(error);
                                    return `
                                        <div style="background: white; padding: 20px; border-radius: 15px; border-left: 5px solid ${getSeverityColor(error.data.severity)};">
                                            <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 15px;">
                                                <div style="flex: 1; min-width: 250px;">
                                                    <h4 style="margin: 0 0 8px 0; color: #2d3748;">${error.data.vietnameseName}</h4>
                                                    <div style="color: #6b7280; font-size: 0.9em; margin-bottom: 10px;">
                                                        Linh ki·ªán: ${error.data.component} | Confidence: ${error.confidence}%
                                                    </div>
                                                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                                        <span style="background: ${getSeverityColor(error.data.severity)}; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8em; font-weight: bold;">
                                                            ${getSeverityText(error.data.severity)}
                                                        </span>
                                                        <span style="background: #e5e7eb; color: #374151; padding: 4px 12px; border-radius: 15px; font-size: 0.8em;">
                                                            ${getRepairDifficulty(error.data.severity)}
                                                        </span>
                                                    </div>
                                                </div>
                                                <div style="text-align: right; min-width: 150px;">
                                                    <div style="font-size: 1.2em; font-weight: bold; color: #2d3748; margin-bottom: 5px;">
                                                        ${cost.min.toLocaleString()} - ${cost.max.toLocaleString()}
                                                    </div>
                                                    <div style="color: #6b7280; font-size: 0.85em;">VNƒê</div>
                                                    <div style="margin-top: 8px; font-size: 0.8em; color: #6b7280;">
                                                        Th·ªùi gian: ${getEstimatedRepairTime(error.data.severity)}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                                                <details style="cursor: pointer;">
                                                    <summary style="font-weight: bold; color: #4b5563; margin-bottom: 10px;">üí° Chi ti·∫øt chi ph√≠</summary>
                                                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px; margin-top: 10px;">
                                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; font-size: 0.9em;">
                                                            <div>
                                                                <strong>Linh ki·ªán:</strong><br>
                                                                <span style="color: #6b7280;">${cost.breakdown.parts}</span>
                                                            </div>
                                                            <div>
                                                                <strong>C√¥ng s·ª≠a ch·ªØa:</strong><br>
                                                                <span style="color: #6b7280;">${cost.breakdown.labor}</span>
                                                            </div>
                                                            <div>
                                                                <strong>Chi ph√≠ kh√°c:</strong><br>
                                                                <span style="color: #6b7280;">${cost.breakdown.misc}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </details>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                        
                        <!-- Khuy·∫øn ngh·ªã ti·∫øt ki·ªám -->
                        <div style="background: linear-gradient(135deg, #dcfce7, #bbf7d0); padding: 25px; border-radius: 20px; margin-bottom: 30px; border-left: 5px solid #16a34a;">
                            <h3 style="color: #14532d; margin: 0 0 20px 0; display: flex; align-items: center;">
                                <span style="background: #16a34a; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">üí°</span>
                                Khuy·∫øn Ngh·ªã Ti·∫øt Ki·ªám Chi Ph√≠
                            </h3>
                            <div style="color: #14532d; line-height: 1.7;">
                                ${generateCostSavingTips(allErrors)}
                            </div>
                        </div>
                        
                        <!-- Ph∆∞∆°ng √°n thanh to√°n -->
                        <div style="background: #f3f4f6; padding: 25px; border-radius: 20px; margin-bottom: 20px;">
                            <h3 style="color: #374151; margin: 0 0 20px 0;">üí≥ Ph∆∞∆°ng √Ån Thanh To√°n</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #10b981;">
                                    <h4 style="margin: 0 0 15px 0; color: #047857;">‚úÖ S·ª≠a T·∫•t C·∫£ Ngay</h4>
                                    <div style="font-size: 1.3em; font-weight: bold; color: #047857; margin-bottom: 10px;">
                                        ${Math.round((costBreakdown.total.min + costBreakdown.total.max) / 2).toLocaleString()} VNƒê
                                    </div>
                                    <ul style="margin: 0; padding-left: 20px; color: #065f46; font-size: 0.9em; line-height: 1.6;">
                                        <li>Gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ t·∫•t c·∫£ v·∫•n ƒë·ªÅ</li>
                                        <li>C√≥ th·ªÉ ƒë∆∞·ª£c gi·∫£m gi√° combo</li>
                                        <li>B·∫£o h√†nh to√†n b·ªô s·ª≠a ch·ªØa</li>
                                    </ul>
                                </div>
                                
                                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #f59e0b;">
                                    <h4 style="margin: 0 0 15px 0; color: #d97706;">‚ö° ∆Øu Ti√™n Critical</h4>
                                    <div style="font-size: 1.3em; font-weight: bold; color: #d97706; margin-bottom: 10px;">
                                        ${costBreakdown.bySeverity.critical ? Math.round((costBreakdown.bySeverity.critical.min + costBreakdown.bySeverity.critical.max) / 2).toLocaleString() : '0'} VNƒê
                                    </div>
                                    <ul style="margin: 0; padding-left: 20px; color: #92400e; font-size: 0.9em; line-height: 1.6;">
                                        <li>S·ª≠a l·ªói nghi√™m tr·ªçng tr∆∞·ªõc</li>
                                        <li>Tr√°nh h·ªèng th√™m linh ki·ªán kh√°c</li>
                                        <li>Chi ph√≠ th·∫•p nh·∫•t ban ƒë·∫ßu</li>
                                    </ul>
                                </div>
                                
                                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #6366f1;">
                                    <h4 style="margin: 0 0 15px 0; color: #4f46e5;">üìÖ Chia L√†m Nhi·ªÅu ƒê·ª£t</h4>
                                    <div style="font-size: 1.3em; font-weight: bold; color: #4f46e5; margin-bottom: 10px;">
                                        Linh ho·∫°t
                                    </div>
                                    <ul style="margin: 0; padding-left: 20px; color: #3730a3; font-size: 0.9em; line-height: 1.6;">
                                        <li>Chia nh·ªè chi ph√≠ theo th·ªùi gian</li>
                                        <li>Theo d√µi hi·ªáu qu·∫£ t·ª´ng b∆∞·ªõc</li>
                                        <li>D·ª´ng khi ƒë·ªß ·ªïn ƒë·ªãnh</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                            <button onclick="generateCostReport()" style="background: linear-gradient(135deg, #f59e0b, #f97316); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üìä T·∫°o B√°o C√°o Chi Ph√≠
                            </button>
                            <button onclick="findNearbyRepairShops()" style="background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üó∫Ô∏è T√¨m C·ª≠a H√†ng G·∫ßn Nh·∫•t
                            </button>
                            <button onclick="requestQuote()" style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: transform 0.2s; flex: 1; min-width: 200px; max-width: 250px;">
                                üìù Y√™u C·∫ßu B√°o Gi√°
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal khi click outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // T√≠nh to√°n chi ph√≠ chi ti·∫øt
        function calculateDetailedCosts(errors) {
            const costRanges = {
                'critical': { min: 1000000, max: 3000000 },
                'high': { min: 500000, max: 1500000 },
                'medium': { min: 200000, max: 800000 },
                'low': { min: 50000, max: 300000 }
            };
            
            const result = {
                total: { min: 0, max: 0 },
                bySeverity: {}
            };
            
            errors.forEach(error => {
                const severity = error.data.severity;
                const range = costRanges[severity] || { min: 100000, max: 500000 };
                
                result.total.min += range.min;
                result.total.max += range.max;
                
                if (!result.bySeverity[severity]) {
                    result.bySeverity[severity] = { min: 0, max: 0, count: 0 };
                }
                
                result.bySeverity[severity].min += range.min;
                result.bySeverity[severity].max += range.max;
                result.bySeverity[severity].count += 1;
            });
            
            return result;
        }

        // Chi ph√≠ chi ti·∫øt cho t·ª´ng l·ªói
        function getDetailedCostForError(error) {
            const baseCosts = {
                'critical': { min: 1000000, max: 3000000 },
                'high': { min: 500000, max: 1500000 },
                'medium': { min: 200000, max: 800000 },
                'low': { min: 50000, max: 300000 }
            };
            
            const base = baseCosts[error.data.severity] || { min: 100000, max: 500000 };
            
            return {
                min: base.min,
                max: base.max,
                breakdown: {
                    parts: `${Math.round(base.min * 0.6).toLocaleString()} - ${Math.round(base.max * 0.6).toLocaleString()} VNƒê`,
                    labor: `${Math.round(base.min * 0.3).toLocaleString()} - ${Math.round(base.max * 0.3).toLocaleString()} VNƒê`,
                    misc: `${Math.round(base.min * 0.1).toLocaleString()} - ${Math.round(base.max * 0.1).toLocaleString()} VNƒê`
                }
            };
        }

        // T·∫°o l·ªùi khuy√™n ti·∫øt ki·ªám chi ph√≠
        function generateCostSavingTips(errors) {
            const criticalCount = errors.filter(e => e.data.severity === 'critical').length;
            const highCount = errors.filter(e => e.data.severity === 'high').length;
            
            let tips = [];
            
            if (criticalCount > 0) {
                tips.push('‚Ä¢ <strong>∆Øu ti√™n s·ª≠a l·ªói Critical tr∆∞·ªõc</strong> ƒë·ªÉ tr√°nh h·ªèng th√™m linh ki·ªán kh√°c, c√≥ th·ªÉ ti·∫øt ki·ªám 20-30% t·ªïng chi ph√≠.');
            }
            
            if (errors.length > 3) {
                tips.push('‚Ä¢ <strong>S·ª≠a combo nhi·ªÅu l·ªói c√πng l√∫c</strong> th∆∞·ªùng ƒë∆∞·ª£c gi·∫£m gi√° 10-15% so v·ªõi s·ª≠a t·ª´ng c√°i.');
            }
            
            if (highCount > 1) {
                tips.push('‚Ä¢ <strong>Th∆∞∆°ng l∆∞·ª£ng gi√°</strong> khi c√≥ nhi·ªÅu l·ªói m·ª©c cao, nhi·ªÅu c·ª≠a h√†ng s·∫µn s√†ng gi·∫£m gi√° ƒë·ªÉ c√≥ kh√°ch h√†ng l·ªõn.');
            }
            
            tips.push('‚Ä¢ <strong>So s√°nh gi√° √≠t nh·∫•t 3 c·ª≠a h√†ng</strong> tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh, gi√° c√≥ th·ªÉ ch√™nh l·ªách 20-40%.');
            tips.push('‚Ä¢ <strong>Ki·ªÉm tra b·∫£o h√†nh</strong> tr∆∞·ªõc khi s·ª≠a - m·ªôt s·ªë l·ªói c√≥ th·ªÉ ƒë∆∞·ª£c b·∫£o h√†nh mi·ªÖn ph√≠.');
            tips.push('‚Ä¢ <strong>C√¢n nh·∫Øc mua m√°y m·ªõi</strong> n·∫øu t·ªïng chi ph√≠ s·ª≠a ch·ªØa > 60% gi√° tr·ªã m√°y hi·ªán t·∫°i.');
            
            return tips.join('<br>');
        }

        // X√≥a t·∫•t c·∫£ l·ªãch s·ª≠
        function clearAllHistory() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ l·ªãch s·ª≠ ph√¢n t√≠ch? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.')) {
                analysisResults = [];
                localStorage.removeItem('panicAnalysisHistory');
                localStorage.removeItem('diagnosticProgress');
                
                const container = document.getElementById('resultsContainer');
                container.style.display = 'none';
                
                showNotification('ƒê√£ x√≥a t·∫•t c·∫£ l·ªãch s·ª≠ ph√¢n t√≠ch', 'success');
            }
        }

        // Xu·∫•t b√°o c√°o chi ti·∫øt
        function exportDetailedReport() {
            if (analysisResults.length === 0) {
                showNotification('Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t b√°o c√°o', 'warning');
                return;
            }
            
            const allErrors = analysisResults.flatMap(result => result.errors);
            const reportDate = new Date().toLocaleString('vi-VN');
            
            const reportContent = `
                <div style="font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 40px; background: white;">
                    <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #667eea; padding-bottom: 20px;">
                        <h1 style="color: #2d3748; margin: 0 0 10px 0;">üìä B√ÅO C√ÅO PH√ÇN T√çCH PANIC LOG T·ªîNG H·ª¢P</h1>
                        <p style="color: #666; margin: 10px 0 0 0;">Ng√†y t·∫°o: ${reportDate}</p>
                        <p style="color: #666; margin: 5px 0 0 0;">T·ªïng s·ªë file ph√¢n t√≠ch: ${analysisResults.length} | T·ªïng s·ªë l·ªói: ${allErrors.length}</p>
                    </div>
                    
                    <!-- Executive Summary -->
                    <div style="background: #f8fafc; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                        <h2 style="color: #2d3748; margin: 0 0 20px 0;">üìà T√≥m T·∫Øt ƒêi·ªÅu H√†nh</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            ${generateExecutiveSummary(allErrors)}
                        </div>
                    </div>
                    
                    <!-- Detailed Analysis -->
                    <div style="margin-bottom: 30px;">
                        <h2 style="color: #2d3748; margin: 0 0 20px 0;">üîç Ph√¢n T√≠ch Chi Ti·∫øt</h2>
                        ${generateDetailedAnalysisReport(analysisResults)}
                    </div>
                    
                    <!-- Recommendations -->
                    <div style="background: #e6fffa; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                        <h2 style="color: #234e52; margin: 0 0 20px 0;">üí° Khuy·∫øn Ngh·ªã</h2>
                        ${generateRecommendationsReport(allErrors)}
                    </div>
                    
                    <!-- Cost Analysis -->
                    <div style="background: #fff7ed; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                        <h2 style="color: #9a3412; margin: 0 0 20px 0;">üí∞ Ph√¢n T√≠ch Chi Ph√≠</h2>
                        ${generateCostAnalysisReport(allErrors)}
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
                        <p style="color: #666; font-size: 0.9em;">B√°o c√°o ƒë∆∞·ª£c t·∫°o b·ªüi AI Panic Log Analyzer v2.0</p>
                        <p style="color: #666; font-size: 0.8em;">¬© 2024 - C√¥ng c·ª• ph√¢n t√≠ch chuy√™n nghi·ªáp cho thi·∫øt b·ªã Apple</p>
                    </div>
                </div>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>B√°o C√°o Ph√¢n T√≠ch Panic Log T·ªïng H·ª£p</title>
                    <meta charset="UTF-8">
                    <style>
                        @media print {
                            body { margin: 0; }
                            .no-print { display: none; }
                        }
                        @page {
                            margin: 20mm;
                            size: A4;
                        }
                    </style>
                </head>
                <body>
                    ${reportContent}
                    <div class="no-print" style="text-align: center; margin: 20px;">
                        <button onclick="window.print()" style="background: #667eea; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; margin-right: 15px;">üñ®Ô∏è In B√°o C√°o</button>
                        <button onclick="window.close()" style="background: #e53e3e; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold;">‚ùå ƒê√≥ng</button>
                    </div>
                </body>
                </html>
            `);
            newWindow.document.close();
        }

        // T·∫°o t√≥m t·∫Øt ƒëi·ªÅu h√†nh
        function generateExecutiveSummary(errors) {
            const severityCount = {
                critical: errors.filter(e => e.data.severity === 'critical').length,
                high: errors.filter(e => e.data.severity === 'high').length,
                medium: errors.filter(e => e.data.severity === 'medium').length,
                low: errors.filter(e => e.data.severity === 'low').length
            };
            
            const totalCost = calculateDetailedCosts(errors);
            const avgCost = Math.round((totalCost.total.min + totalCost.total.max) / 2);
            
            return `
                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold; color: #dc2626; margin-bottom: 10px;">${severityCount.critical}</div>
                    <div style="color: #991b1b; font-weight: bold;">L·ªói Critical</div>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold; color: #ea580c; margin-bottom: 10px;">${severityCount.high}</div>
                    <div style="color: #9a3412; font-weight: bold;">L·ªói High</div>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold; color: #2563eb; margin-bottom: 10px;">${avgCost.toLocaleString()}</div>
                    <div style="color: #1e40af; font-weight: bold;">Chi Ph√≠ TB (VNƒê)</div>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold; color: #16a34a; margin-bottom: 10px;">${Math.round(errors.reduce((sum, e) => sum + e.confidence, 0) / errors.length)}%</div>
                    <div style="color: #15803d; font-weight: bold;">ƒê·ªô Tin C·∫≠y TB</div>
                </div>
            `;
        }

        // T·∫°o b√°o c√°o ph√¢n t√≠ch chi ti·∫øt
        function generateDetailedAnalysisReport(results) {
            return results.map((result, index) => `
                <div style="background: #f8fafc; padding: 25px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid #667eea;">
                    <h3 style="color: #2d3748; margin: 0 0 15px 0;">üìÑ File ${index + 1}: ${result.fileName}</h3>
                    <div style="color: #4a5568; margin-bottom: 15px; font-size: 0.9em;">
                        Th·ªùi gian ph√¢n t√≠ch: ${new Date(result.timestamp).toLocaleString('vi-VN')}
                    </div>
                    
                    ${result.errors.length > 0 ? `
                        <div style="background: white; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #2d3748; margin: 0 0 15px 0;">üîç L·ªói ƒë∆∞·ª£c ph√°t hi·ªán:</h4>
                            ${result.errors.map(error => `
                                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 3px solid ${getSeverityColor(error.data.severity)};">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <strong style="color: #2d3748;">${error.data.vietnameseName}</strong>
                                        <span style="background: ${getSeverityColor(error.data.severity)}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: bold;">
                                            ${getSeverityText(error.data.severity)}
                                        </span>
                                    </div>
                                    <div style="color: #6b7280; font-size: 0.9em;">
                                        <strong>Linh ki·ªán:</strong> ${error.data.component} | 
                                        <strong>V·ªã tr√≠:</strong> ${error.data.location} | 
                                        <strong>Confidence:</strong> ${error.confidence}%
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div style="background: #f0fdf4; padding: 20px; border-radius: 10px; border-left: 3px solid #16a34a;">
                            <div style="color: #15803d; text-align: center;">
                                ‚úÖ Kh√¥ng ph√°t hi·ªán l·ªói panic c·ª• th·ªÉ trong file n√†y
                            </div>
                        </div>
                    `}
                </div>
            `).join('');
        }

        // T·∫°o b√°o c√°o khuy·∫øn ngh·ªã
        function generateRecommendationsReport(errors) {
            if (errors.length === 0) {
                return '<div style="color: #15803d; text-align: center; font-size: 1.1em;">‚úÖ H·ªá th·ªëng ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh, kh√¥ng c·∫ßn can thi·ªáp</div>';
            }
            
            const criticalErrors = errors.filter(e => e.data.severity === 'critical');
            const highErrors = errors.filter(e => e.data.severity === 'high');
            
            let recommendations = [];
            
            if (criticalErrors.length > 0) {
                recommendations.push(`
                    <div style="background: #fee2e2; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #dc2626;">
                        <h4 style="color: #991b1b; margin: 0 0 10px 0;">üö® H√†nh ƒê·ªông Kh·∫©n C·∫•p</h4>
                        <ul style="color: #991b1b; margin: 0; padding-left: 20px;">
                            <li>Ng·ª´ng s·ª≠ d·ª•ng thi·∫øt b·ªã ngay l·∫≠p t·ª©c ƒë·ªÉ tr√°nh h·ªèng th√™m</li>
                            <li>Backup d·ªØ li·ªáu quan tr·ªçng n·∫øu thi·∫øt b·ªã c√≤n ho·∫°t ƒë·ªông ƒë∆∞·ª£c</li>
                            <li>ƒê∆∞a ƒë·∫øn c·ª≠a h√†ng s·ª≠a ch·ªØa chuy√™n nghi·ªáp trong 24h</li>
                            <li>∆Øu ti√™n s·ª≠a ${criticalErrors.length} l·ªói critical tr∆∞·ªõc</li>
                        </ul>
                    </div>
                `);
            }
            
            if (highErrors.length > 0) {
                recommendations.push(`
                    <div style="background: #fed7aa; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #ea580c;">
                        <h4 style="color: #9a3412; margin: 0 0 10px 0;">‚ö†Ô∏è C·∫ßn Ch√∫ √ù</h4>
                        <ul style="color: #9a3412; margin: 0; padding-left: 20px;">
                            <li>L√™n l·ªãch s·ª≠a ch·ªØa trong v√≤ng 1 tu·∫ßn</li>
                            <li>Theo d√µi tri·ªáu ch·ª©ng c√≥ tƒÉng n·∫∑ng kh√¥ng</li>
                            <li>Tr√°nh s·ª≠ d·ª•ng thi·∫øt b·ªã trong ƒëi·ªÅu ki·ªán kh·∫Øc nghi·ªát</li>
                            <li>Chu·∫©n b·ªã ph∆∞∆°ng √°n backup d·ªØ li·ªáu</li>
                        </ul>
                    </div>
                `);
            }
            
            recommendations.push(`
                <div style="background: #dbeafe; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #2563eb;">
                    <h4 style="color: #1e40af; margin: 0 0 10px 0;">üí° Khuy·∫øn Ngh·ªã Chung</h4>
                    <ul style="color: #1e40af; margin: 0; padding-left: 20px;">
                        <li>C·∫≠p nh·∫≠t iOS/macOS l√™n phi√™n b·∫£n m·ªõi nh·∫•t</li>
                        <li>Th·ª±c hi·ªán reset c√†i ƒë·∫∑t n·∫øu ch∆∞a th·ª≠</li>
                        <li>Ki·ªÉm tra b·∫£o h√†nh tr∆∞·ªõc khi s·ª≠a ch·ªØa</li>
                        <li>L∆∞u gi·ªØ panic logs ƒë·ªÉ theo d√µi xu h∆∞·ªõng</li>
                        <li>C√¢n nh·∫Øc n√¢ng c·∫•p thi·∫øt b·ªã n·∫øu qu√° c≈©</li>
                    </ul>
                </div>
            `);
            
            return recommendations.join('');
        }

        // T·∫°o b√°o c√°o ph√¢n t√≠ch chi ph√≠
        function generateCostAnalysisReport(errors) {
            if (errors.length === 0) {
                return '<div style="color: #15803d; text-align: center; font-size: 1.1em;">üí∞ Kh√¥ng c√≥ chi ph√≠ s·ª≠a ch·ªØa</div>';
            }
            
            const costBreakdown = calculateDetailedCosts(errors);
            
            return `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.8em; font-weight: bold; color: #dc2626; margin-bottom: 10px;">
                            ${costBreakdown.total.min.toLocaleString()}
                        </div>
                        <div style="color: #991b1b; font-weight: bold;">Chi Ph√≠ T·ªëi Thi·ªÉu (VNƒê)</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.8em; font-weight: bold; color: #ea580c; margin-bottom: 10px;">
                            ${costBreakdown.total.max.toLocaleString()}
                        </div>
                        <div style="color: #9a3412; font-weight: bold;">Chi Ph√≠ T·ªëi ƒêa (VNƒê)</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 1.8em; font-weight: bold; color: #2563eb; margin-bottom: 10px;">
                            ${Math.round((costBreakdown.total.min + costBreakdown.total.max) / 2).toLocaleString()}
                        </div>
                        <div style="color: #1e40af; font-weight: bold;">Chi Ph√≠ Trung B√¨nh (VNƒê)</div>
                    </div>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #2d3748; margin: 0 0 15px 0;">üìä Ph√¢n B·ªï Chi Ph√≠ Theo M·ª©c ƒê·ªô</h4>
                    ${Object.entries(costBreakdown.bySeverity).map(([severity, data]) => `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #e5e7eb;">
                            <div>
                                <span style="background: ${getSeverityColor(severity)}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: bold; margin-right: 10px;">
                                    ${getSeverityText(severity)}
                                </span>
                                <span style="color: #6b7280;">${data.count} l·ªói</span>
                            </div>
                            <div style="font-weight: bold; color: #2d3748;">
                                ${data.min.toLocaleString()} - ${data.max.toLocaleString()} VNƒê
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Utility functions cho c√°c t√≠nh nƒÉng kh√°c
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                'success': '#10b981',
                'error': '#ef4444',
                'warning': '#f59e0b',
                'info': '#3b82f6'
            };
            
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10001;
                background: ${colors[type]}; color: white; padding: 15px 25px;
                border-radius: 10px; font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transform: translateX(100%); transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Auto remove
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            loadAnalysisHistory();
            
            // Th√™m drag & drop cho file input
            const dropZone = document.querySelector('.upload-area');
            const fileInput = document.getElementById('panicLogFile');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight(e) {
                dropZone.style.background = 'linear-gradient(135deg, #e0f2fe, #b3e5fc)';
                dropZone.style.borderColor = '#0288d1';
            }
            
            function unhighlight(e) {
                dropZone.style.background = 'linear-gradient(135deg, #f8fafc, #e2e8f0)';
                dropZone.style.borderColor = '#cbd5e1';
            }
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length > 0) {
                    fileInput.files = files;
                    showNotification('File ƒë√£ ƒë∆∞·ª£c t·∫£i l√™n th√†nh c√¥ng!', 'success');
                }
            }
        });

        // Load l·ªãch s·ª≠ ph√¢n t√≠ch
        function loadAnalysisHistory() {
            const saved = localStorage.getItem('panicAnalysisHistory');
            if (saved) {
                try {
                    analysisResults = JSON.parse(saved);
                    if (analysisResults.length > 0) {
                        displayResults();
                    }
                } catch (e) {
                    console.error('Error loading analysis history:', e);
                }
            }
        }

        // Save l·ªãch s·ª≠ ph√¢n t√≠ch
        function saveAnalysisHistory() {
            try {
                localStorage.setItem('panicAnalysisHistory', JSON.stringify(analysisResults));
            } catch (e) {
                console.error('Error saving analysis history:', e);
                showNotification('Kh√¥ng th·ªÉ l∆∞u l·ªãch s·ª≠ ph√¢n t√≠ch', 'error');
            }
        
        }
    </script>
</body>
</html>




